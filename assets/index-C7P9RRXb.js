(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const n of r)if(n.type==="childList")for(const i of n.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function t(r){const n={};return r.integrity&&(n.integrity=r.integrity),r.referrerPolicy&&(n.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?n.credentials="include":r.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function s(r){if(r.ep)return;r.ep=!0;const n=t(r);fetch(r.href,n)}})();const sn="en",ye="Welcome Guide",on="FAKE_WELCOME_GUIDE_HASH",St=new Map;St.set("de","welcome-guide-de.html");St.set("en","welcome-guide-en.html");St.set("es","welcome-guide-es.html");St.set("fr","welcome-guide-fr.html");St.set("ja","welcome-guide-ja.html");St.set("zh","welcome-guide-zh-CN.html");St.set("ko","welcome-guide-ko.html");St.set("ru","welcome-guide-ru.html");const qe=/((?:\.+|。|\!+|(?:\?!*)|…)”?"?»?\)?\]?\.*)/,an=1,cn=.25,ln=.1,un=1,hn=.38,jt=Object.freeze({throttleSeconds:.3,tolerancePx:2}),_e=5,fn=.3,dn=25,pn=10,Rt="library",Tt="bookCache",mn={name:"super_simple_reader_db",version:1,stores:[{name:Tt,keyPath:"hash",autoIncrement:!1,indexes:[{name:"filename",keyPath:"filename"},{name:"type",keyPath:"type"}]},{name:Rt,keyPath:"fileHash",autoIncrement:!1,indexes:[{name:"filename",keyPath:"filename"},{name:"firstOpened",keyPath:"firstOpened"},{name:"lastAccessed",keyPath:"lastAccessed"},{name:"positionPercentage",keyPath:"positionPercentage"}]}]};async function gn(f){return new Promise((e,t)=>{const s=indexedDB.open(f.name,f.version);s.onerror=()=>{t(s.error??new Error("Failed to open IndexedDB"))},s.onupgradeneeded=r=>{console.log("Upgrading database");const n=s.result,i=new Set;Array.from(n.objectStoreNames).forEach(o=>{f.stores.some(u=>u.name===o)?i.add(o):(n.deleteObjectStore(o),console.log(`Deleted store ${o}`))}),f.stores.forEach(o=>{if(i.has(o.name))return;const u=n.createObjectStore(o.name,{keyPath:o.keyPath,autoIncrement:o.autoIncrement??!1});o.indexes&&o.indexes.forEach(_=>{u.createIndex(_.name,_.keyPath,{unique:_.unique??!1})})})},s.onsuccess=()=>{const r=s.result;r.onerror=n=>{console.error("Database error:",n.target?.error?.message)},e(r)},s.onblocked=()=>{t(new Error("Database opening blocked (possibly by another tab)"))}})}function Kt(f,e){let t;return function(...s){const r=this;clearTimeout(t),t=window.setTimeout(()=>{f.apply(r,s)},e*1e3)}}function Ot(){let f=navigator?.language;return f?Ct(f):sn}const be=/[-_]/;function Ct(f){return be.test(f)?f.split(be)[0]:f}async function vn(){const e=It.transaction(Rt,"readonly").objectStore(Rt);return new Promise((t,s)=>{const r=e.getAll();r.onsuccess=()=>{t(r.result)},r.onerror=()=>{s(r.error)}})}function yn(f){const s=It.transaction(Rt,"readwrite").objectStore(Rt).put(f);s.onsuccess=()=>{},s.onerror=()=>{console.error("Card update failed:",s.error)}}function At(f){return Object.prototype.toString.call(f)==="[object String]"}function zt(f){return At(f)&&f.trim()!==""}function Ft(f){return isNaN(f)?!1:typeof f=="number"||f instanceof Number}function _n(f){let e=f.fileHash;if(!At(e))return console.warn(`Discarded card with invalid hash: ${e}`),null;let t=f.filename;At(t)||(console.warn("Read invalid book file name value"),t="<unkown book file name>");let s=f.langMeta;At(s)||(console.warn("Read invalid langMeta value"),s="");let r=f.langOverride;r!==null&&!At(r)&&(console.warn("Read invalid langOverride value"),r=null),s=s.trim();const n=new Date;let i=f.firstOpened;i instanceof Date||(console.warn("Read invalid firstOpened value"),i=n);let o=f.lastAccessed;o instanceof Date||(console.warn("Read invalid lastAccessed value"),o=n);let u=f.positionPercentage;(!Ft(u)||u<0||u>100)&&(console.warn("Read invalid positionPercentage value"),u=0);let _=f.title;At(f.title)||(_="");let b=f.author;At(b)||(b="");let v=f.toc;return Array.isArray(v)||(v=[]),{fileHash:e,filename:t,langMeta:s,langOverride:r,firstOpened:i,lastAccessed:o,positionPercentage:u,title:_,author:b,toc:v}}class de{#t;updatePosition=Kt(this.#e,an);constructor(e){this.#t=new Map,e.forEach(t=>this.#t.set(t.fileHash,t))}static async loadFromDb(){const e=await vn(),t=[];return e.forEach(s=>{let r=_n(s);r&&t.push(r)}),new de(t)}getCard(e){return this.#t.get(e)}cardsArray(){const e=[...this.#t.values()];return e.sort((t,s)=>s.lastAccessed-t.lastAccessed),e}#e(e,t){t<0&&(t=0),t>100&&(t=100);const s=this.getCard(e);if(!s){console.error("Updating position of non-existent book card");return}Math.abs(s.positionPercentage-t)<1e-4||(s.positionPercentage=t,s.lastAccessed=new Date,this.updateCard(s))}newCard(e,t,s,r,n,i){const o=new Date;let u=null;return s||(u=Ot()),r=r.trim(),n=n.trim(),this.updateCard({fileHash:e,filename:t,langMeta:s,langOverride:u,firstOpened:o,lastAccessed:o,positionPercentage:0,title:r,author:n,toc:i})}updateCard(e){return e.lastAccessed=new Date,this.#t.set(e.fileHash,e),yn(e),e}}function Ht(f,e,t){return Math.min(Math.max(f,e),t)}const bn=["af","am","ar","arn","ary","as","az","ba","be","bg","bn","bo","br","bs","ca","ckb","co","cs","cy","da","de","dsb","dv","el","en","es","et","eu","fa","fi","fil","fo","fr","fy","ga","gd","gil","gl","gsw","gu","ha","he","hi","hr","hsb","hu","hy","id","ig","ii","is","it","iu","ja","ka","kk","kl","km","kn","ko","kok","ku","ky","lb","lo","lt","lv","mi","mk","ml","mn","moh","mr","ms","mt","my","nb","ne","nl","nn","no","oc","or","pap","pa","pl","prs","ps","pt","quc","qu","rm","ro","ru","rw","sa","sah","se","si","sk","sl","sma","smj","smn","sms","sq","sr","st","sv","sw","syc","ta","te","tg","th","tk","tn","tr","tt","tzm","ug","uk","ur","uz","vi","wo","xh","yo","zh","zu"],wn=new Set(bn),ft={speakingSpeed:{myDefault:1,min:.5,max:10,increment:.1},fontSize:{myDefault:100,min:50,max:200},lineHeight:{myDefault:1.2,min:.8,max:1.5,increment:.1},margin:{myDefault:2,min:0,max:10,increment:1}};class Sn{speakingSpeed=ft.speakingSpeed.myDefault;fonts=["serif","sans-serif"];#t=ft.margin.myDefault;#e=ft.lineHeight.myDefault;#r="serif";#n=ft.fontSize.myDefault;#s={};#i;#o;#a=null;constructor(){this.#o=Kt(this.#u,hn),this.#i=Kt(this.#g,un),this.#v()}get lineHeight(){return this.#e}get margin(){return this.#t}get currentFont(){return this.#r}set currentFont(e){this.#r=e,this.updateFont(),this.#i()}updateFont(){this.#r==="sans-serif"?ct.classList.add("sans-serif"):ct.classList.remove("sans-serif")}get fontSize(){return this.#n}set fontSize(e){this.#n=e,this.#c(),this.#i()}#c(){Ft(this.#n)||(this.#n=ft.fontSize.myDefault),this.#n=Ht(this.#n,ft.fontSize.min,ft.fontSize.max)}get currentBook(){return this.#a}set currentBook(e){this.#a=e,this.updateVoice()}updateVoice(){const e=this.currentVoice();e?mt.setVoice(e):mt.setVoice({name:"",lang:this.currentLang()})}currentVoice(){const e=this.#s[this.currentLang()]||null;if(!e)return this.#m();const t=mt.voices().find(s=>s.name===e);return t||this.#m()}setVoiceByName(e){if(e===void 0){this.updateVoice();return}const t=mt.voices().find(s=>s.name===e);if(!t){this.updateVoice();return}this.#s[Ct(t.lang)]=t.name,document.dispatchEvent(new CustomEvent("needrestartsentence")),mt.setVoice({name:e,lang:this.currentLang()}),this.#i()}currentLangVoices(){let e=mt.voices().filter(s=>Ct(this.currentLang())===Ct(s.lang));const t=Ct(this.currentLang());return e.length===0&&(e=mt.voices().filter(s=>t.startsWith(Ct(s.lang))||Ct(s.lang).startsWith(t))),e}availableLangs(){const e=mt.voices();return e.length!==0?new Set(e.map(t=>Ct(t.lang))):wn}speedPlus(){return this.speakingSpeed+=ft.speakingSpeed.increment,this.#p(),this.#o(),this.#i(),this.speakingSpeed}speedMinus(){return this.speakingSpeed-=ft.speakingSpeed.increment,this.#p(),this.#o(),this.#i(),this.speakingSpeed}#u(){try{mt.setSpeed(this.speakingSpeed),document.dispatchEvent(new CustomEvent("needrestartsentence"))}catch{}}marginPlus(){return this.#t+=ft.margin.increment,this.#h(),this.#l(),this.#i(),this.#t}marginMinus(){return this.#t-=ft.margin.increment,this.#h(),this.#l(),this.#i(),this.#t}#l(){ct.style.paddingLeft=this.#t.toString()+"vw",ct.style.paddingRight=this.#t.toString()+"vw",document.dispatchEvent(new CustomEvent("needscrolltocurrent"))}#h(){Ft(this.#t)||(this.#t=ft.margin.myDefault),this.#t=Ht(this.#t,ft.margin.min,ft.margin.max)}lineHeightPlus(){return this.#e+=ft.lineHeight.increment,this.#d(),this.#f(),this.#i(),this.#e}lineHeightMinus(){return this.#e-=ft.lineHeight.increment,this.#d(),this.#f(),this.#i(),this.#e}#f(){ct.style.lineHeight=this.#e.toString()}#d(){Ft(this.#e)||(this.#e=ft.lineHeight.myDefault),this.#e=Ht(this.#e,ft.lineHeight.min,ft.lineHeight.max)}currentLang(){return this.#a?.lang()||Ot()}#m(){const e=this.currentLangVoices()[0];return e||null}#g(){localStorage.setItem("speakingSpeed",this.speakingSpeed.toString()),localStorage.setItem("fontSize",this.#n.toString()),localStorage.setItem("font",this.#r),localStorage.setItem("lineHeight",this.#e.toString()),localStorage.setItem("margin",this.#t.toString()),localStorage.setItem("preferredLangs",JSON.stringify(this.#s))}#v(){const e=new Error("Error during options deserialization;");try{this.speakingSpeed=parseFloat(localStorage.getItem("speakingSpeed")||"1"),this.#p(),this.#o()}catch(t){console.error(e,t)}try{this.#n=parseFloat(localStorage.getItem("fontSize")||ft.fontSize.myDefault.toString()),this.#c()}catch(t){console.error(e,t)}try{const t=localStorage.getItem("preferredLangs");t&&(this.#s=JSON.parse(t||"[]"))}catch(t){console.error(e,t)}try{this.#r=localStorage.getItem("font")||this.fonts[0],this.updateFont()}catch(t){console.error(e,t)}try{this.#e=parseFloat(localStorage.getItem("lineHeight")||ft.lineHeight.myDefault.toString()),this.#d(),this.#f()}catch(t){console.error(e,t)}try{this.#t=parseFloat(localStorage.getItem("margin")||ft.margin.myDefault.toString()),this.#h(),this.#l()}catch(t){console.error(e,t)}}#p(){Ft(this.speakingSpeed)||(this.speakingSpeed=ft.speakingSpeed.myDefault),this.speakingSpeed=Ht(this.speakingSpeed,ft.speakingSpeed.min,ft.speakingSpeed.max)}}class En{#t=()=>{};#e;constructor(){this.#e=[],this.stop();const e=VERandroid.getVoices();try{this.#e=JSON.parse(e),this.setSpeed(ot.speakingSpeed)}catch{this.#e=[]}try{this.sortVoices()}catch{}}sortVoices(){this.#e.sort((e,t)=>{const s=Wt.includes(e.lang),r=Wt.includes(t.lang);if(s&&r){const n=Wt.findIndex(o=>o===e.lang),i=Wt.findIndex(o=>o===t.lang);return n!==i?n-i:e.name.localeCompare(t.name)}else return s?-1:r?1:e.name.localeCompare(t.name)})}start(e,t){this.#t=t,VERandroid.saySentence(e),document.addEventListener("nextsentence",this.#t,{once:!0})}stop(){document.removeEventListener("nextsentence",this.#t),VERandroid.stopSpeaking()}voices(){return this.#e}setVoice=e=>{e.lang!==""&&VERandroid.setLang(e.lang),e.name!==""&&VERandroid.setVoice(e.name)};setSpeed(e){VERandroid.setSpeed(e)}}const Wt=["en-US","en-GB","en-IN","en-AU"];class kn{#t=null;#e=()=>{};#r=[];constructor(){this.stop(),new Promise(t=>{const s=window.speechSynthesis;try{const r=s.getVoices();r.length!==0&&t(r)}catch{}s.addEventListener("voiceschanged",()=>t(s.getVoices()))}).then(t=>this.#r=t)}start(e,t){this.#e=t;const s=this.#n(e);s.addEventListener("end",this.#e,{once:!0}),window.speechSynthesis.speak(s)}stop(){this.#t?.removeEventListener("end",this.#e),window.speechSynthesis.cancel()}voices(){return this.#r}setVoice=()=>{};setSpeed=()=>{};#n(e){this.#t=new SpeechSynthesisUtterance(e.trim());const t=this.#t,s=ot.currentBook;s&&(t.lang=s.lang()),t.pitch=1,t.rate=ot.speakingSpeed,t.volume=1;const r=ot.currentVoice();return r&&(t.voice=r),t}}const ct=document.querySelector("#page");let It=null;async function Tn(){try{It=await gn(mn),console.log("Database opened successfully")}catch(f){const e=`Failed to open app's database: ${f}`;throw console.error(e),alert(e),f}}let bt=null;async function Cn(){bt=await de.loadFromDb()}const ot=new Sn;let mt;try{VERandroid,mt=new En}catch{mt=new kn}class Ve{hash;filename;parsedHtml;constructor({hash:e,filename:t,parsedHtml:s}){if([e,t,s].some(r=>!zt(r))){const r=new TypeError("Invalid CachedBook constructor parameter");throw console.error(r),r}this.hash=e,this.filename=t,this.parsedHtml=s}toRecord(){return{hash:this.hash,filename:this.filename,parsedHtml:this.parsedHtml}}}async function Ge(f){try{const s=It.transaction([Tt],"readwrite").objectStore(Tt).delete(f);return new Promise((r,n)=>{s.onsuccess=()=>{console.log("Book removed from cache"),r()},s.onerror=()=>{n(s.error)}})}catch(e){console.error("Error removing book from cache",e)}}async function xn(f){try{return await An(f)}catch(e){console.error("Error reading cached book:",e)}return null}async function ae(f){const s=It.transaction([Tt],"readonly").objectStore(Tt).count(f);return new Promise(r=>{s.onsuccess=()=>r(s.result>0),s.onerror=()=>{console.error("Error checking if book is cached"),r(!1)}})}async function An(f){return new Promise((e,t)=>{const n=It.transaction([Tt],"readonly").objectStore(Tt).get(f);n.onerror=()=>{const i=new Error("Cached book not found");console.error(i),t(i)},n.onsuccess=()=>{const i=n.result;if(!i){t("Cached book is null or undefined");return}try{const o=new Ve(i);e(o)}catch(o){Ge(f),t(o)}}})}async function In(f){try{const t=It.transaction([Tt],"readwrite").objectStore(Tt),s=f.toRecord(),r=t.put(s);return new Promise((n,i)=>{r.onsuccess=()=>{console.log("Book saved to cache"),Nn(),n()},r.onerror=()=>{console.log("Error saving book saved to cache"),i(r.error)}})}catch(e){console.error("Error saving book to cache",e)}}async function Nn(){const f=bt.cardsArray(),e=[];for(let s of f)await ae(s.fileHash)&&e.push(s);e.sort((s,r)=>r.lastAccessed-s.lastAccessed);const t=e.slice(pn);for(let s of t)await Ge(s.fileHash)}var qt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function pe(f){return f&&f.__esModule&&Object.prototype.hasOwnProperty.call(f,"default")?f.default:f}function On(f){if(Object.prototype.hasOwnProperty.call(f,"__esModule"))return f;var e=f.default;if(typeof e=="function"){var t=function s(){var r=!1;try{r=this instanceof s}catch{}return r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(f).forEach(function(s){var r=Object.getOwnPropertyDescriptor(f,s);Object.defineProperty(t,s,r.get?r:{enumerable:!0,get:function(){return f[s]}})}),t}var te={};var we;function Dn(){return we||(we=1,(function(f){(function(e){e(typeof DO_NOT_EXPORT_CRC>"u"?f:{})})(function(e){e.version="1.2.2";function t(){for(var N=0,m=new Array(256),P=0;P!=256;++P)N=P,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,m[P]=N;return typeof Int32Array<"u"?new Int32Array(m):m}var s=t();function r(N){var m=0,P=0,Z=0,A=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(Z=0;Z!=256;++Z)A[Z]=N[Z];for(Z=0;Z!=256;++Z)for(P=N[Z],m=256+Z;m<4096;m+=256)P=A[m]=P>>>8^N[P&255];var z=[];for(Z=1;Z!=16;++Z)z[Z-1]=typeof Int32Array<"u"?A.subarray(Z*256,Z*256+256):A.slice(Z*256,Z*256+256);return z}var n=r(s),i=n[0],o=n[1],u=n[2],_=n[3],b=n[4],v=n[5],E=n[6],p=n[7],k=n[8],d=n[9],T=n[10],l=n[11],y=n[12],I=n[13],C=n[14];function S(N,m){for(var P=m^-1,Z=0,A=N.length;Z<A;)P=P>>>8^s[(P^N.charCodeAt(Z++))&255];return~P}function L(N,m){for(var P=m^-1,Z=N.length-15,A=0;A<Z;)P=C[N[A++]^P&255]^I[N[A++]^P>>8&255]^y[N[A++]^P>>16&255]^l[N[A++]^P>>>24]^T[N[A++]]^d[N[A++]]^k[N[A++]]^p[N[A++]]^E[N[A++]]^v[N[A++]]^b[N[A++]]^_[N[A++]]^u[N[A++]]^o[N[A++]]^i[N[A++]]^s[N[A++]];for(Z+=15;A<Z;)P=P>>>8^s[(P^N[A++])&255];return~P}function D(N,m){for(var P=m^-1,Z=0,A=N.length,z=0,h=0;Z<A;)z=N.charCodeAt(Z++),z<128?P=P>>>8^s[(P^z)&255]:z<2048?(P=P>>>8^s[(P^(192|z>>6&31))&255],P=P>>>8^s[(P^(128|z&63))&255]):z>=55296&&z<57344?(z=(z&1023)+64,h=N.charCodeAt(Z++)&1023,P=P>>>8^s[(P^(240|z>>8&7))&255],P=P>>>8^s[(P^(128|z>>2&63))&255],P=P>>>8^s[(P^(128|h>>6&15|(z&3)<<4))&255],P=P>>>8^s[(P^(128|h&63))&255]):(P=P>>>8^s[(P^(224|z>>12&15))&255],P=P>>>8^s[(P^(128|z>>6&63))&255],P=P>>>8^s[(P^(128|z&63))&255]);return~P}e.table=s,e.bstr=S,e.buf=L,e.str=D})})(te)),te}var Ln=Dn();const Pn=pe(Ln);async function Fn(f){const e=await f.arrayBuffer(),t=new Uint8Array(e);return Pn.buf(t).toString()}const Ze="lastBookHash",Bn="lastBookTimestamp";function Rn(f){localStorage.setItem(Ze,f);const e=new Date;localStorage.setItem(Bn,e.toISOString())}function zn(){return localStorage.getItem(Ze)}function Bt(f){for(;f.firstChild;)f.removeChild(f.firstChild)}function Vt(f){throw new Error('Could not dynamically require "'+f+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var ee={exports:{}};var Se;function Un(){return Se||(Se=1,(function(f,e){(function(t){f.exports=t()})(function(){return(function t(s,r,n){function i(_,b){if(!r[_]){if(!s[_]){var v=typeof Vt=="function"&&Vt;if(!b&&v)return v(_,!0);if(o)return o(_,!0);var E=new Error("Cannot find module '"+_+"'");throw E.code="MODULE_NOT_FOUND",E}var p=r[_]={exports:{}};s[_][0].call(p.exports,function(k){var d=s[_][1][k];return i(d||k)},p,p.exports,t,s,r,n)}return r[_].exports}for(var o=typeof Vt=="function"&&Vt,u=0;u<n.length;u++)i(n[u]);return i})({1:[function(t,s,r){var n=t("./utils"),i=t("./support"),o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";r.encode=function(u){for(var _,b,v,E,p,k,d,T=[],l=0,y=u.length,I=y,C=n.getTypeOf(u)!=="string";l<u.length;)I=y-l,v=C?(_=u[l++],b=l<y?u[l++]:0,l<y?u[l++]:0):(_=u.charCodeAt(l++),b=l<y?u.charCodeAt(l++):0,l<y?u.charCodeAt(l++):0),E=_>>2,p=(3&_)<<4|b>>4,k=1<I?(15&b)<<2|v>>6:64,d=2<I?63&v:64,T.push(o.charAt(E)+o.charAt(p)+o.charAt(k)+o.charAt(d));return T.join("")},r.decode=function(u){var _,b,v,E,p,k,d=0,T=0,l="data:";if(u.substr(0,l.length)===l)throw new Error("Invalid base64 input, it looks like a data url.");var y,I=3*(u=u.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(u.charAt(u.length-1)===o.charAt(64)&&I--,u.charAt(u.length-2)===o.charAt(64)&&I--,I%1!=0)throw new Error("Invalid base64 input, bad content length.");for(y=i.uint8array?new Uint8Array(0|I):new Array(0|I);d<u.length;)_=o.indexOf(u.charAt(d++))<<2|(E=o.indexOf(u.charAt(d++)))>>4,b=(15&E)<<4|(p=o.indexOf(u.charAt(d++)))>>2,v=(3&p)<<6|(k=o.indexOf(u.charAt(d++))),y[T++]=_,p!==64&&(y[T++]=b),k!==64&&(y[T++]=v);return y}},{"./support":30,"./utils":32}],2:[function(t,s,r){var n=t("./external"),i=t("./stream/DataWorker"),o=t("./stream/Crc32Probe"),u=t("./stream/DataLengthProbe");function _(b,v,E,p,k){this.compressedSize=b,this.uncompressedSize=v,this.crc32=E,this.compression=p,this.compressedContent=k}_.prototype={getContentWorker:function(){var b=new i(n.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new u("data_length")),v=this;return b.on("end",function(){if(this.streamInfo.data_length!==v.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),b},getCompressedWorker:function(){return new i(n.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},_.createWorkerFrom=function(b,v,E){return b.pipe(new o).pipe(new u("uncompressedSize")).pipe(v.compressWorker(E)).pipe(new u("compressedSize")).withStreamInfo("compression",v)},s.exports=_},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(t,s,r){var n=t("./stream/GenericWorker");r.STORE={magic:"\0\0",compressWorker:function(){return new n("STORE compression")},uncompressWorker:function(){return new n("STORE decompression")}},r.DEFLATE=t("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(t,s,r){var n=t("./utils"),i=(function(){for(var o,u=[],_=0;_<256;_++){o=_;for(var b=0;b<8;b++)o=1&o?3988292384^o>>>1:o>>>1;u[_]=o}return u})();s.exports=function(o,u){return o!==void 0&&o.length?n.getTypeOf(o)!=="string"?(function(_,b,v,E){var p=i,k=E+v;_^=-1;for(var d=E;d<k;d++)_=_>>>8^p[255&(_^b[d])];return-1^_})(0|u,o,o.length,0):(function(_,b,v,E){var p=i,k=E+v;_^=-1;for(var d=E;d<k;d++)_=_>>>8^p[255&(_^b.charCodeAt(d))];return-1^_})(0|u,o,o.length,0):0}},{"./utils":32}],5:[function(t,s,r){r.base64=!1,r.binary=!1,r.dir=!1,r.createFolders=!0,r.date=null,r.compression=null,r.compressionOptions=null,r.comment=null,r.unixPermissions=null,r.dosPermissions=null},{}],6:[function(t,s,r){var n=null;n=typeof Promise<"u"?Promise:t("lie"),s.exports={Promise:n}},{lie:37}],7:[function(t,s,r){var n=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",i=t("pako"),o=t("./utils"),u=t("./stream/GenericWorker"),_=n?"uint8array":"array";function b(v,E){u.call(this,"FlateWorker/"+v),this._pako=null,this._pakoAction=v,this._pakoOptions=E,this.meta={}}r.magic="\b\0",o.inherits(b,u),b.prototype.processChunk=function(v){this.meta=v.meta,this._pako===null&&this._createPako(),this._pako.push(o.transformTo(_,v.data),!1)},b.prototype.flush=function(){u.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},b.prototype.cleanUp=function(){u.prototype.cleanUp.call(this),this._pako=null},b.prototype._createPako=function(){this._pako=new i[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var v=this;this._pako.onData=function(E){v.push({data:E,meta:v.meta})}},r.compressWorker=function(v){return new b("Deflate",v)},r.uncompressWorker=function(){return new b("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(t,s,r){function n(p,k){var d,T="";for(d=0;d<k;d++)T+=String.fromCharCode(255&p),p>>>=8;return T}function i(p,k,d,T,l,y){var I,C,S=p.file,L=p.compression,D=y!==_.utf8encode,N=o.transformTo("string",y(S.name)),m=o.transformTo("string",_.utf8encode(S.name)),P=S.comment,Z=o.transformTo("string",y(P)),A=o.transformTo("string",_.utf8encode(P)),z=m.length!==S.name.length,h=A.length!==P.length,q="",it="",W="",st=S.dir,X=S.date,rt={crc32:0,compressedSize:0,uncompressedSize:0};k&&!d||(rt.crc32=p.crc32,rt.compressedSize=p.compressedSize,rt.uncompressedSize=p.uncompressedSize);var U=0;k&&(U|=8),D||!z&&!h||(U|=2048);var R=0,tt=0;st&&(R|=16),l==="UNIX"?(tt=798,R|=(function(K,dt){var g=K;return K||(g=dt?16893:33204),(65535&g)<<16})(S.unixPermissions,st)):(tt=20,R|=(function(K){return 63&(K||0)})(S.dosPermissions)),I=X.getUTCHours(),I<<=6,I|=X.getUTCMinutes(),I<<=5,I|=X.getUTCSeconds()/2,C=X.getUTCFullYear()-1980,C<<=4,C|=X.getUTCMonth()+1,C<<=5,C|=X.getUTCDate(),z&&(it=n(1,1)+n(b(N),4)+m,q+="up"+n(it.length,2)+it),h&&(W=n(1,1)+n(b(Z),4)+A,q+="uc"+n(W.length,2)+W);var Q="";return Q+=`
\0`,Q+=n(U,2),Q+=L.magic,Q+=n(I,2),Q+=n(C,2),Q+=n(rt.crc32,4),Q+=n(rt.compressedSize,4),Q+=n(rt.uncompressedSize,4),Q+=n(N.length,2),Q+=n(q.length,2),{fileRecord:v.LOCAL_FILE_HEADER+Q+N+q,dirRecord:v.CENTRAL_FILE_HEADER+n(tt,2)+Q+n(Z.length,2)+"\0\0\0\0"+n(R,4)+n(T,4)+N+q+Z}}var o=t("../utils"),u=t("../stream/GenericWorker"),_=t("../utf8"),b=t("../crc32"),v=t("../signature");function E(p,k,d,T){u.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=k,this.zipPlatform=d,this.encodeFileName=T,this.streamFiles=p,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}o.inherits(E,u),E.prototype.push=function(p){var k=p.meta.percent||0,d=this.entriesCount,T=this._sources.length;this.accumulate?this.contentBuffer.push(p):(this.bytesWritten+=p.data.length,u.prototype.push.call(this,{data:p.data,meta:{currentFile:this.currentFile,percent:d?(k+100*(d-T-1))/d:100}}))},E.prototype.openedSource=function(p){this.currentSourceOffset=this.bytesWritten,this.currentFile=p.file.name;var k=this.streamFiles&&!p.file.dir;if(k){var d=i(p,k,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:d.fileRecord,meta:{percent:0}})}else this.accumulate=!0},E.prototype.closedSource=function(p){this.accumulate=!1;var k=this.streamFiles&&!p.file.dir,d=i(p,k,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(d.dirRecord),k)this.push({data:(function(T){return v.DATA_DESCRIPTOR+n(T.crc32,4)+n(T.compressedSize,4)+n(T.uncompressedSize,4)})(p),meta:{percent:100}});else for(this.push({data:d.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},E.prototype.flush=function(){for(var p=this.bytesWritten,k=0;k<this.dirRecords.length;k++)this.push({data:this.dirRecords[k],meta:{percent:100}});var d=this.bytesWritten-p,T=(function(l,y,I,C,S){var L=o.transformTo("string",S(C));return v.CENTRAL_DIRECTORY_END+"\0\0\0\0"+n(l,2)+n(l,2)+n(y,4)+n(I,4)+n(L.length,2)+L})(this.dirRecords.length,d,p,this.zipComment,this.encodeFileName);this.push({data:T,meta:{percent:100}})},E.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},E.prototype.registerPrevious=function(p){this._sources.push(p);var k=this;return p.on("data",function(d){k.processChunk(d)}),p.on("end",function(){k.closedSource(k.previous.streamInfo),k._sources.length?k.prepareNextSource():k.end()}),p.on("error",function(d){k.error(d)}),this},E.prototype.resume=function(){return!!u.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},E.prototype.error=function(p){var k=this._sources;if(!u.prototype.error.call(this,p))return!1;for(var d=0;d<k.length;d++)try{k[d].error(p)}catch{}return!0},E.prototype.lock=function(){u.prototype.lock.call(this);for(var p=this._sources,k=0;k<p.length;k++)p[k].lock()},s.exports=E},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(t,s,r){var n=t("../compressions"),i=t("./ZipFileWorker");r.generateWorker=function(o,u,_){var b=new i(u.streamFiles,_,u.platform,u.encodeFileName),v=0;try{o.forEach(function(E,p){v++;var k=(function(y,I){var C=y||I,S=n[C];if(!S)throw new Error(C+" is not a valid compression method !");return S})(p.options.compression,u.compression),d=p.options.compressionOptions||u.compressionOptions||{},T=p.dir,l=p.date;p._compressWorker(k,d).withStreamInfo("file",{name:E,dir:T,date:l,comment:p.comment||"",unixPermissions:p.unixPermissions,dosPermissions:p.dosPermissions}).pipe(b)}),b.entriesCount=v}catch(E){b.error(E)}return b}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(t,s,r){function n(){if(!(this instanceof n))return new n;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var i=new n;for(var o in this)typeof this[o]!="function"&&(i[o]=this[o]);return i}}(n.prototype=t("./object")).loadAsync=t("./load"),n.support=t("./support"),n.defaults=t("./defaults"),n.version="3.10.1",n.loadAsync=function(i,o){return new n().loadAsync(i,o)},n.external=t("./external"),s.exports=n},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(t,s,r){var n=t("./utils"),i=t("./external"),o=t("./utf8"),u=t("./zipEntries"),_=t("./stream/Crc32Probe"),b=t("./nodejsUtils");function v(E){return new i.Promise(function(p,k){var d=E.decompressed.getContentWorker().pipe(new _);d.on("error",function(T){k(T)}).on("end",function(){d.streamInfo.crc32!==E.decompressed.crc32?k(new Error("Corrupted zip : CRC32 mismatch")):p()}).resume()})}s.exports=function(E,p){var k=this;return p=n.extend(p||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:o.utf8decode}),b.isNode&&b.isStream(E)?i.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):n.prepareContent("the loaded zip file",E,!0,p.optimizedBinaryString,p.base64).then(function(d){var T=new u(p);return T.load(d),T}).then(function(d){var T=[i.Promise.resolve(d)],l=d.files;if(p.checkCRC32)for(var y=0;y<l.length;y++)T.push(v(l[y]));return i.Promise.all(T)}).then(function(d){for(var T=d.shift(),l=T.files,y=0;y<l.length;y++){var I=l[y],C=I.fileNameStr,S=n.resolve(I.fileNameStr);k.file(S,I.decompressed,{binary:!0,optimizedBinaryString:!0,date:I.date,dir:I.dir,comment:I.fileCommentStr.length?I.fileCommentStr:null,unixPermissions:I.unixPermissions,dosPermissions:I.dosPermissions,createFolders:p.createFolders}),I.dir||(k.file(S).unsafeOriginalName=C)}return T.zipComment.length&&(k.comment=T.zipComment),k})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(t,s,r){var n=t("../utils"),i=t("../stream/GenericWorker");function o(u,_){i.call(this,"Nodejs stream input adapter for "+u),this._upstreamEnded=!1,this._bindStream(_)}n.inherits(o,i),o.prototype._bindStream=function(u){var _=this;(this._stream=u).pause(),u.on("data",function(b){_.push({data:b,meta:{percent:0}})}).on("error",function(b){_.isPaused?this.generatedError=b:_.error(b)}).on("end",function(){_.isPaused?_._upstreamEnded=!0:_.end()})},o.prototype.pause=function(){return!!i.prototype.pause.call(this)&&(this._stream.pause(),!0)},o.prototype.resume=function(){return!!i.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},s.exports=o},{"../stream/GenericWorker":28,"../utils":32}],13:[function(t,s,r){var n=t("readable-stream").Readable;function i(o,u,_){n.call(this,u),this._helper=o;var b=this;o.on("data",function(v,E){b.push(v)||b._helper.pause(),_&&_(E)}).on("error",function(v){b.emit("error",v)}).on("end",function(){b.push(null)})}t("../utils").inherits(i,n),i.prototype._read=function(){this._helper.resume()},s.exports=i},{"../utils":32,"readable-stream":16}],14:[function(t,s,r){s.exports={isNode:typeof Buffer<"u",newBufferFrom:function(n,i){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(n,i);if(typeof n=="number")throw new Error('The "data" argument must not be a number');return new Buffer(n,i)},allocBuffer:function(n){if(Buffer.alloc)return Buffer.alloc(n);var i=new Buffer(n);return i.fill(0),i},isBuffer:function(n){return Buffer.isBuffer(n)},isStream:function(n){return n&&typeof n.on=="function"&&typeof n.pause=="function"&&typeof n.resume=="function"}}},{}],15:[function(t,s,r){function n(S,L,D){var N,m=o.getTypeOf(L),P=o.extend(D||{},b);P.date=P.date||new Date,P.compression!==null&&(P.compression=P.compression.toUpperCase()),typeof P.unixPermissions=="string"&&(P.unixPermissions=parseInt(P.unixPermissions,8)),P.unixPermissions&&16384&P.unixPermissions&&(P.dir=!0),P.dosPermissions&&16&P.dosPermissions&&(P.dir=!0),P.dir&&(S=l(S)),P.createFolders&&(N=T(S))&&y.call(this,N,!0);var Z=m==="string"&&P.binary===!1&&P.base64===!1;D&&D.binary!==void 0||(P.binary=!Z),(L instanceof v&&L.uncompressedSize===0||P.dir||!L||L.length===0)&&(P.base64=!1,P.binary=!0,L="",P.compression="STORE",m="string");var A=null;A=L instanceof v||L instanceof u?L:k.isNode&&k.isStream(L)?new d(S,L):o.prepareContent(S,L,P.binary,P.optimizedBinaryString,P.base64);var z=new E(S,A,P);this.files[S]=z}var i=t("./utf8"),o=t("./utils"),u=t("./stream/GenericWorker"),_=t("./stream/StreamHelper"),b=t("./defaults"),v=t("./compressedObject"),E=t("./zipObject"),p=t("./generate"),k=t("./nodejsUtils"),d=t("./nodejs/NodejsStreamInputAdapter"),T=function(S){S.slice(-1)==="/"&&(S=S.substring(0,S.length-1));var L=S.lastIndexOf("/");return 0<L?S.substring(0,L):""},l=function(S){return S.slice(-1)!=="/"&&(S+="/"),S},y=function(S,L){return L=L!==void 0?L:b.createFolders,S=l(S),this.files[S]||n.call(this,S,null,{dir:!0,createFolders:L}),this.files[S]};function I(S){return Object.prototype.toString.call(S)==="[object RegExp]"}var C={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(S){var L,D,N;for(L in this.files)N=this.files[L],(D=L.slice(this.root.length,L.length))&&L.slice(0,this.root.length)===this.root&&S(D,N)},filter:function(S){var L=[];return this.forEach(function(D,N){S(D,N)&&L.push(N)}),L},file:function(S,L,D){if(arguments.length!==1)return S=this.root+S,n.call(this,S,L,D),this;if(I(S)){var N=S;return this.filter(function(P,Z){return!Z.dir&&N.test(P)})}var m=this.files[this.root+S];return m&&!m.dir?m:null},folder:function(S){if(!S)return this;if(I(S))return this.filter(function(m,P){return P.dir&&S.test(m)});var L=this.root+S,D=y.call(this,L),N=this.clone();return N.root=D.name,N},remove:function(S){S=this.root+S;var L=this.files[S];if(L||(S.slice(-1)!=="/"&&(S+="/"),L=this.files[S]),L&&!L.dir)delete this.files[S];else for(var D=this.filter(function(m,P){return P.name.slice(0,S.length)===S}),N=0;N<D.length;N++)delete this.files[D[N].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(S){var L,D={};try{if((D=o.extend(S||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:i.utf8encode})).type=D.type.toLowerCase(),D.compression=D.compression.toUpperCase(),D.type==="binarystring"&&(D.type="string"),!D.type)throw new Error("No output type specified.");o.checkSupport(D.type),D.platform!=="darwin"&&D.platform!=="freebsd"&&D.platform!=="linux"&&D.platform!=="sunos"||(D.platform="UNIX"),D.platform==="win32"&&(D.platform="DOS");var N=D.comment||this.comment||"";L=p.generateWorker(this,D,N)}catch(m){(L=new u("error")).error(m)}return new _(L,D.type||"string",D.mimeType)},generateAsync:function(S,L){return this.generateInternalStream(S).accumulate(L)},generateNodeStream:function(S,L){return(S=S||{}).type||(S.type="nodebuffer"),this.generateInternalStream(S).toNodejsStream(L)}};s.exports=C},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(t,s,r){s.exports=t("stream")},{stream:void 0}],17:[function(t,s,r){var n=t("./DataReader");function i(o){n.call(this,o);for(var u=0;u<this.data.length;u++)o[u]=255&o[u]}t("../utils").inherits(i,n),i.prototype.byteAt=function(o){return this.data[this.zero+o]},i.prototype.lastIndexOfSignature=function(o){for(var u=o.charCodeAt(0),_=o.charCodeAt(1),b=o.charCodeAt(2),v=o.charCodeAt(3),E=this.length-4;0<=E;--E)if(this.data[E]===u&&this.data[E+1]===_&&this.data[E+2]===b&&this.data[E+3]===v)return E-this.zero;return-1},i.prototype.readAndCheckSignature=function(o){var u=o.charCodeAt(0),_=o.charCodeAt(1),b=o.charCodeAt(2),v=o.charCodeAt(3),E=this.readData(4);return u===E[0]&&_===E[1]&&b===E[2]&&v===E[3]},i.prototype.readData=function(o){if(this.checkOffset(o),o===0)return[];var u=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,u},s.exports=i},{"../utils":32,"./DataReader":18}],18:[function(t,s,r){var n=t("../utils");function i(o){this.data=o,this.length=o.length,this.index=0,this.zero=0}i.prototype={checkOffset:function(o){this.checkIndex(this.index+o)},checkIndex:function(o){if(this.length<this.zero+o||o<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+o+"). Corrupted zip ?")},setIndex:function(o){this.checkIndex(o),this.index=o},skip:function(o){this.setIndex(this.index+o)},byteAt:function(){},readInt:function(o){var u,_=0;for(this.checkOffset(o),u=this.index+o-1;u>=this.index;u--)_=(_<<8)+this.byteAt(u);return this.index+=o,_},readString:function(o){return n.transformTo("string",this.readData(o))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var o=this.readInt(4);return new Date(Date.UTC(1980+(o>>25&127),(o>>21&15)-1,o>>16&31,o>>11&31,o>>5&63,(31&o)<<1))}},s.exports=i},{"../utils":32}],19:[function(t,s,r){var n=t("./Uint8ArrayReader");function i(o){n.call(this,o)}t("../utils").inherits(i,n),i.prototype.readData=function(o){this.checkOffset(o);var u=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,u},s.exports=i},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(t,s,r){var n=t("./DataReader");function i(o){n.call(this,o)}t("../utils").inherits(i,n),i.prototype.byteAt=function(o){return this.data.charCodeAt(this.zero+o)},i.prototype.lastIndexOfSignature=function(o){return this.data.lastIndexOf(o)-this.zero},i.prototype.readAndCheckSignature=function(o){return o===this.readData(4)},i.prototype.readData=function(o){this.checkOffset(o);var u=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,u},s.exports=i},{"../utils":32,"./DataReader":18}],21:[function(t,s,r){var n=t("./ArrayReader");function i(o){n.call(this,o)}t("../utils").inherits(i,n),i.prototype.readData=function(o){if(this.checkOffset(o),o===0)return new Uint8Array(0);var u=this.data.subarray(this.zero+this.index,this.zero+this.index+o);return this.index+=o,u},s.exports=i},{"../utils":32,"./ArrayReader":17}],22:[function(t,s,r){var n=t("../utils"),i=t("../support"),o=t("./ArrayReader"),u=t("./StringReader"),_=t("./NodeBufferReader"),b=t("./Uint8ArrayReader");s.exports=function(v){var E=n.getTypeOf(v);return n.checkSupport(E),E!=="string"||i.uint8array?E==="nodebuffer"?new _(v):i.uint8array?new b(n.transformTo("uint8array",v)):new o(n.transformTo("array",v)):new u(v)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(t,s,r){r.LOCAL_FILE_HEADER="PK",r.CENTRAL_FILE_HEADER="PK",r.CENTRAL_DIRECTORY_END="PK",r.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",r.ZIP64_CENTRAL_DIRECTORY_END="PK",r.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(t,s,r){var n=t("./GenericWorker"),i=t("../utils");function o(u){n.call(this,"ConvertWorker to "+u),this.destType=u}i.inherits(o,n),o.prototype.processChunk=function(u){this.push({data:i.transformTo(this.destType,u.data),meta:u.meta})},s.exports=o},{"../utils":32,"./GenericWorker":28}],25:[function(t,s,r){var n=t("./GenericWorker"),i=t("../crc32");function o(){n.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}t("../utils").inherits(o,n),o.prototype.processChunk=function(u){this.streamInfo.crc32=i(u.data,this.streamInfo.crc32||0),this.push(u)},s.exports=o},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(t,s,r){var n=t("../utils"),i=t("./GenericWorker");function o(u){i.call(this,"DataLengthProbe for "+u),this.propName=u,this.withStreamInfo(u,0)}n.inherits(o,i),o.prototype.processChunk=function(u){if(u){var _=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=_+u.data.length}i.prototype.processChunk.call(this,u)},s.exports=o},{"../utils":32,"./GenericWorker":28}],27:[function(t,s,r){var n=t("../utils"),i=t("./GenericWorker");function o(u){i.call(this,"DataWorker");var _=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,u.then(function(b){_.dataIsReady=!0,_.data=b,_.max=b&&b.length||0,_.type=n.getTypeOf(b),_.isPaused||_._tickAndRepeat()},function(b){_.error(b)})}n.inherits(o,i),o.prototype.cleanUp=function(){i.prototype.cleanUp.call(this),this.data=null},o.prototype.resume=function(){return!!i.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,n.delay(this._tickAndRepeat,[],this)),!0)},o.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(n.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},o.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var u=null,_=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":u=this.data.substring(this.index,_);break;case"uint8array":u=this.data.subarray(this.index,_);break;case"array":case"nodebuffer":u=this.data.slice(this.index,_)}return this.index=_,this.push({data:u,meta:{percent:this.max?this.index/this.max*100:0}})},s.exports=o},{"../utils":32,"./GenericWorker":28}],28:[function(t,s,r){function n(i){this.name=i||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}n.prototype={push:function(i){this.emit("data",i)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(i){this.emit("error",i)}return!0},error:function(i){return!this.isFinished&&(this.isPaused?this.generatedError=i:(this.isFinished=!0,this.emit("error",i),this.previous&&this.previous.error(i),this.cleanUp()),!0)},on:function(i,o){return this._listeners[i].push(o),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(i,o){if(this._listeners[i])for(var u=0;u<this._listeners[i].length;u++)this._listeners[i][u].call(this,o)},pipe:function(i){return i.registerPrevious(this)},registerPrevious:function(i){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=i.streamInfo,this.mergeStreamInfo(),this.previous=i;var o=this;return i.on("data",function(u){o.processChunk(u)}),i.on("end",function(){o.end()}),i.on("error",function(u){o.error(u)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var i=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),i=!0),this.previous&&this.previous.resume(),!i},flush:function(){},processChunk:function(i){this.push(i)},withStreamInfo:function(i,o){return this.extraStreamInfo[i]=o,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var i in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,i)&&(this.streamInfo[i]=this.extraStreamInfo[i])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var i="Worker "+this.name;return this.previous?this.previous+" -> "+i:i}},s.exports=n},{}],29:[function(t,s,r){var n=t("../utils"),i=t("./ConvertWorker"),o=t("./GenericWorker"),u=t("../base64"),_=t("../support"),b=t("../external"),v=null;if(_.nodestream)try{v=t("../nodejs/NodejsStreamOutputAdapter")}catch{}function E(k,d){return new b.Promise(function(T,l){var y=[],I=k._internalType,C=k._outputType,S=k._mimeType;k.on("data",function(L,D){y.push(L),d&&d(D)}).on("error",function(L){y=[],l(L)}).on("end",function(){try{var L=(function(D,N,m){switch(D){case"blob":return n.newBlob(n.transformTo("arraybuffer",N),m);case"base64":return u.encode(N);default:return n.transformTo(D,N)}})(C,(function(D,N){var m,P=0,Z=null,A=0;for(m=0;m<N.length;m++)A+=N[m].length;switch(D){case"string":return N.join("");case"array":return Array.prototype.concat.apply([],N);case"uint8array":for(Z=new Uint8Array(A),m=0;m<N.length;m++)Z.set(N[m],P),P+=N[m].length;return Z;case"nodebuffer":return Buffer.concat(N);default:throw new Error("concat : unsupported type '"+D+"'")}})(I,y),S);T(L)}catch(D){l(D)}y=[]}).resume()})}function p(k,d,T){var l=d;switch(d){case"blob":case"arraybuffer":l="uint8array";break;case"base64":l="string"}try{this._internalType=l,this._outputType=d,this._mimeType=T,n.checkSupport(l),this._worker=k.pipe(new i(l)),k.lock()}catch(y){this._worker=new o("error"),this._worker.error(y)}}p.prototype={accumulate:function(k){return E(this,k)},on:function(k,d){var T=this;return k==="data"?this._worker.on(k,function(l){d.call(T,l.data,l.meta)}):this._worker.on(k,function(){n.delay(d,arguments,T)}),this},resume:function(){return n.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(k){if(n.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new v(this,{objectMode:this._outputType!=="nodebuffer"},k)}},s.exports=p},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(t,s,r){if(r.base64=!0,r.array=!0,r.string=!0,r.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",r.nodebuffer=typeof Buffer<"u",r.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")r.blob=!1;else{var n=new ArrayBuffer(0);try{r.blob=new Blob([n],{type:"application/zip"}).size===0}catch{try{var i=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);i.append(n),r.blob=i.getBlob("application/zip").size===0}catch{r.blob=!1}}}try{r.nodestream=!!t("readable-stream").Readable}catch{r.nodestream=!1}},{"readable-stream":16}],31:[function(t,s,r){for(var n=t("./utils"),i=t("./support"),o=t("./nodejsUtils"),u=t("./stream/GenericWorker"),_=new Array(256),b=0;b<256;b++)_[b]=252<=b?6:248<=b?5:240<=b?4:224<=b?3:192<=b?2:1;_[254]=_[254]=1;function v(){u.call(this,"utf-8 decode"),this.leftOver=null}function E(){u.call(this,"utf-8 encode")}r.utf8encode=function(p){return i.nodebuffer?o.newBufferFrom(p,"utf-8"):(function(k){var d,T,l,y,I,C=k.length,S=0;for(y=0;y<C;y++)(64512&(T=k.charCodeAt(y)))==55296&&y+1<C&&(64512&(l=k.charCodeAt(y+1)))==56320&&(T=65536+(T-55296<<10)+(l-56320),y++),S+=T<128?1:T<2048?2:T<65536?3:4;for(d=i.uint8array?new Uint8Array(S):new Array(S),y=I=0;I<S;y++)(64512&(T=k.charCodeAt(y)))==55296&&y+1<C&&(64512&(l=k.charCodeAt(y+1)))==56320&&(T=65536+(T-55296<<10)+(l-56320),y++),T<128?d[I++]=T:(T<2048?d[I++]=192|T>>>6:(T<65536?d[I++]=224|T>>>12:(d[I++]=240|T>>>18,d[I++]=128|T>>>12&63),d[I++]=128|T>>>6&63),d[I++]=128|63&T);return d})(p)},r.utf8decode=function(p){return i.nodebuffer?n.transformTo("nodebuffer",p).toString("utf-8"):(function(k){var d,T,l,y,I=k.length,C=new Array(2*I);for(d=T=0;d<I;)if((l=k[d++])<128)C[T++]=l;else if(4<(y=_[l]))C[T++]=65533,d+=y-1;else{for(l&=y===2?31:y===3?15:7;1<y&&d<I;)l=l<<6|63&k[d++],y--;1<y?C[T++]=65533:l<65536?C[T++]=l:(l-=65536,C[T++]=55296|l>>10&1023,C[T++]=56320|1023&l)}return C.length!==T&&(C.subarray?C=C.subarray(0,T):C.length=T),n.applyFromCharCode(C)})(p=n.transformTo(i.uint8array?"uint8array":"array",p))},n.inherits(v,u),v.prototype.processChunk=function(p){var k=n.transformTo(i.uint8array?"uint8array":"array",p.data);if(this.leftOver&&this.leftOver.length){if(i.uint8array){var d=k;(k=new Uint8Array(d.length+this.leftOver.length)).set(this.leftOver,0),k.set(d,this.leftOver.length)}else k=this.leftOver.concat(k);this.leftOver=null}var T=(function(y,I){var C;for((I=I||y.length)>y.length&&(I=y.length),C=I-1;0<=C&&(192&y[C])==128;)C--;return C<0||C===0?I:C+_[y[C]]>I?C:I})(k),l=k;T!==k.length&&(i.uint8array?(l=k.subarray(0,T),this.leftOver=k.subarray(T,k.length)):(l=k.slice(0,T),this.leftOver=k.slice(T,k.length))),this.push({data:r.utf8decode(l),meta:p.meta})},v.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:r.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},r.Utf8DecodeWorker=v,n.inherits(E,u),E.prototype.processChunk=function(p){this.push({data:r.utf8encode(p.data),meta:p.meta})},r.Utf8EncodeWorker=E},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(t,s,r){var n=t("./support"),i=t("./base64"),o=t("./nodejsUtils"),u=t("./external");function _(d){return d}function b(d,T){for(var l=0;l<d.length;++l)T[l]=255&d.charCodeAt(l);return T}t("setimmediate"),r.newBlob=function(d,T){r.checkSupport("blob");try{return new Blob([d],{type:T})}catch{try{var l=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return l.append(d),l.getBlob(T)}catch{throw new Error("Bug : can't construct the Blob.")}}};var v={stringifyByChunk:function(d,T,l){var y=[],I=0,C=d.length;if(C<=l)return String.fromCharCode.apply(null,d);for(;I<C;)T==="array"||T==="nodebuffer"?y.push(String.fromCharCode.apply(null,d.slice(I,Math.min(I+l,C)))):y.push(String.fromCharCode.apply(null,d.subarray(I,Math.min(I+l,C)))),I+=l;return y.join("")},stringifyByChar:function(d){for(var T="",l=0;l<d.length;l++)T+=String.fromCharCode(d[l]);return T},applyCanBeUsed:{uint8array:(function(){try{return n.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}})(),nodebuffer:(function(){try{return n.nodebuffer&&String.fromCharCode.apply(null,o.allocBuffer(1)).length===1}catch{return!1}})()}};function E(d){var T=65536,l=r.getTypeOf(d),y=!0;if(l==="uint8array"?y=v.applyCanBeUsed.uint8array:l==="nodebuffer"&&(y=v.applyCanBeUsed.nodebuffer),y)for(;1<T;)try{return v.stringifyByChunk(d,l,T)}catch{T=Math.floor(T/2)}return v.stringifyByChar(d)}function p(d,T){for(var l=0;l<d.length;l++)T[l]=d[l];return T}r.applyFromCharCode=E;var k={};k.string={string:_,array:function(d){return b(d,new Array(d.length))},arraybuffer:function(d){return k.string.uint8array(d).buffer},uint8array:function(d){return b(d,new Uint8Array(d.length))},nodebuffer:function(d){return b(d,o.allocBuffer(d.length))}},k.array={string:E,array:_,arraybuffer:function(d){return new Uint8Array(d).buffer},uint8array:function(d){return new Uint8Array(d)},nodebuffer:function(d){return o.newBufferFrom(d)}},k.arraybuffer={string:function(d){return E(new Uint8Array(d))},array:function(d){return p(new Uint8Array(d),new Array(d.byteLength))},arraybuffer:_,uint8array:function(d){return new Uint8Array(d)},nodebuffer:function(d){return o.newBufferFrom(new Uint8Array(d))}},k.uint8array={string:E,array:function(d){return p(d,new Array(d.length))},arraybuffer:function(d){return d.buffer},uint8array:_,nodebuffer:function(d){return o.newBufferFrom(d)}},k.nodebuffer={string:E,array:function(d){return p(d,new Array(d.length))},arraybuffer:function(d){return k.nodebuffer.uint8array(d).buffer},uint8array:function(d){return p(d,new Uint8Array(d.length))},nodebuffer:_},r.transformTo=function(d,T){if(T=T||"",!d)return T;r.checkSupport(d);var l=r.getTypeOf(T);return k[l][d](T)},r.resolve=function(d){for(var T=d.split("/"),l=[],y=0;y<T.length;y++){var I=T[y];I==="."||I===""&&y!==0&&y!==T.length-1||(I===".."?l.pop():l.push(I))}return l.join("/")},r.getTypeOf=function(d){return typeof d=="string"?"string":Object.prototype.toString.call(d)==="[object Array]"?"array":n.nodebuffer&&o.isBuffer(d)?"nodebuffer":n.uint8array&&d instanceof Uint8Array?"uint8array":n.arraybuffer&&d instanceof ArrayBuffer?"arraybuffer":void 0},r.checkSupport=function(d){if(!n[d.toLowerCase()])throw new Error(d+" is not supported by this platform")},r.MAX_VALUE_16BITS=65535,r.MAX_VALUE_32BITS=-1,r.pretty=function(d){var T,l,y="";for(l=0;l<(d||"").length;l++)y+="\\x"+((T=d.charCodeAt(l))<16?"0":"")+T.toString(16).toUpperCase();return y},r.delay=function(d,T,l){setImmediate(function(){d.apply(l||null,T||[])})},r.inherits=function(d,T){function l(){}l.prototype=T.prototype,d.prototype=new l},r.extend=function(){var d,T,l={};for(d=0;d<arguments.length;d++)for(T in arguments[d])Object.prototype.hasOwnProperty.call(arguments[d],T)&&l[T]===void 0&&(l[T]=arguments[d][T]);return l},r.prepareContent=function(d,T,l,y,I){return u.Promise.resolve(T).then(function(C){return n.blob&&(C instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(C))!==-1)&&typeof FileReader<"u"?new u.Promise(function(S,L){var D=new FileReader;D.onload=function(N){S(N.target.result)},D.onerror=function(N){L(N.target.error)},D.readAsArrayBuffer(C)}):C}).then(function(C){var S=r.getTypeOf(C);return S?(S==="arraybuffer"?C=r.transformTo("uint8array",C):S==="string"&&(I?C=i.decode(C):l&&y!==!0&&(C=(function(L){return b(L,n.uint8array?new Uint8Array(L.length):new Array(L.length))})(C))),C):u.Promise.reject(new Error("Can't read the data of '"+d+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(t,s,r){var n=t("./reader/readerFor"),i=t("./utils"),o=t("./signature"),u=t("./zipEntry"),_=t("./support");function b(v){this.files=[],this.loadOptions=v}b.prototype={checkSignature:function(v){if(!this.reader.readAndCheckSignature(v)){this.reader.index-=4;var E=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+i.pretty(E)+", expected "+i.pretty(v)+")")}},isSignature:function(v,E){var p=this.reader.index;this.reader.setIndex(v);var k=this.reader.readString(4)===E;return this.reader.setIndex(p),k},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var v=this.reader.readData(this.zipCommentLength),E=_.uint8array?"uint8array":"array",p=i.transformTo(E,v);this.zipComment=this.loadOptions.decodeFileName(p)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var v,E,p,k=this.zip64EndOfCentralSize-44;0<k;)v=this.reader.readInt(2),E=this.reader.readInt(4),p=this.reader.readData(E),this.zip64ExtensibleData[v]={id:v,length:E,value:p}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var v,E;for(v=0;v<this.files.length;v++)E=this.files[v],this.reader.setIndex(E.localHeaderOffset),this.checkSignature(o.LOCAL_FILE_HEADER),E.readLocalPart(this.reader),E.handleUTF8(),E.processAttributes()},readCentralDir:function(){var v;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(o.CENTRAL_FILE_HEADER);)(v=new u({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(v);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var v=this.reader.lastIndexOfSignature(o.CENTRAL_DIRECTORY_END);if(v<0)throw this.isSignature(0,o.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(v);var E=v;if(this.checkSignature(o.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===i.MAX_VALUE_16BITS||this.diskWithCentralDirStart===i.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===i.MAX_VALUE_16BITS||this.centralDirRecords===i.MAX_VALUE_16BITS||this.centralDirSize===i.MAX_VALUE_32BITS||this.centralDirOffset===i.MAX_VALUE_32BITS){if(this.zip64=!0,(v=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(v),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,o.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var p=this.centralDirOffset+this.centralDirSize;this.zip64&&(p+=20,p+=12+this.zip64EndOfCentralSize);var k=E-p;if(0<k)this.isSignature(E,o.CENTRAL_FILE_HEADER)||(this.reader.zero=k);else if(k<0)throw new Error("Corrupted zip: missing "+Math.abs(k)+" bytes.")},prepareReader:function(v){this.reader=n(v)},load:function(v){this.prepareReader(v),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},s.exports=b},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(t,s,r){var n=t("./reader/readerFor"),i=t("./utils"),o=t("./compressedObject"),u=t("./crc32"),_=t("./utf8"),b=t("./compressions"),v=t("./support");function E(p,k){this.options=p,this.loadOptions=k}E.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(p){var k,d;if(p.skip(22),this.fileNameLength=p.readInt(2),d=p.readInt(2),this.fileName=p.readData(this.fileNameLength),p.skip(d),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((k=(function(T){for(var l in b)if(Object.prototype.hasOwnProperty.call(b,l)&&b[l].magic===T)return b[l];return null})(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+i.pretty(this.compressionMethod)+" unknown (inner file : "+i.transformTo("string",this.fileName)+")");this.decompressed=new o(this.compressedSize,this.uncompressedSize,this.crc32,k,p.readData(this.compressedSize))},readCentralPart:function(p){this.versionMadeBy=p.readInt(2),p.skip(2),this.bitFlag=p.readInt(2),this.compressionMethod=p.readString(2),this.date=p.readDate(),this.crc32=p.readInt(4),this.compressedSize=p.readInt(4),this.uncompressedSize=p.readInt(4);var k=p.readInt(2);if(this.extraFieldsLength=p.readInt(2),this.fileCommentLength=p.readInt(2),this.diskNumberStart=p.readInt(2),this.internalFileAttributes=p.readInt(2),this.externalFileAttributes=p.readInt(4),this.localHeaderOffset=p.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");p.skip(k),this.readExtraFields(p),this.parseZIP64ExtraField(p),this.fileComment=p.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var p=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),p==0&&(this.dosPermissions=63&this.externalFileAttributes),p==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var p=n(this.extraFields[1].value);this.uncompressedSize===i.MAX_VALUE_32BITS&&(this.uncompressedSize=p.readInt(8)),this.compressedSize===i.MAX_VALUE_32BITS&&(this.compressedSize=p.readInt(8)),this.localHeaderOffset===i.MAX_VALUE_32BITS&&(this.localHeaderOffset=p.readInt(8)),this.diskNumberStart===i.MAX_VALUE_32BITS&&(this.diskNumberStart=p.readInt(4))}},readExtraFields:function(p){var k,d,T,l=p.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});p.index+4<l;)k=p.readInt(2),d=p.readInt(2),T=p.readData(d),this.extraFields[k]={id:k,length:d,value:T};p.setIndex(l)},handleUTF8:function(){var p=v.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=_.utf8decode(this.fileName),this.fileCommentStr=_.utf8decode(this.fileComment);else{var k=this.findExtraFieldUnicodePath();if(k!==null)this.fileNameStr=k;else{var d=i.transformTo(p,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(d)}var T=this.findExtraFieldUnicodeComment();if(T!==null)this.fileCommentStr=T;else{var l=i.transformTo(p,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(l)}}},findExtraFieldUnicodePath:function(){var p=this.extraFields[28789];if(p){var k=n(p.value);return k.readInt(1)!==1||u(this.fileName)!==k.readInt(4)?null:_.utf8decode(k.readData(p.length-5))}return null},findExtraFieldUnicodeComment:function(){var p=this.extraFields[25461];if(p){var k=n(p.value);return k.readInt(1)!==1||u(this.fileComment)!==k.readInt(4)?null:_.utf8decode(k.readData(p.length-5))}return null}},s.exports=E},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(t,s,r){function n(k,d,T){this.name=k,this.dir=T.dir,this.date=T.date,this.comment=T.comment,this.unixPermissions=T.unixPermissions,this.dosPermissions=T.dosPermissions,this._data=d,this._dataBinary=T.binary,this.options={compression:T.compression,compressionOptions:T.compressionOptions}}var i=t("./stream/StreamHelper"),o=t("./stream/DataWorker"),u=t("./utf8"),_=t("./compressedObject"),b=t("./stream/GenericWorker");n.prototype={internalStream:function(k){var d=null,T="string";try{if(!k)throw new Error("No output type specified.");var l=(T=k.toLowerCase())==="string"||T==="text";T!=="binarystring"&&T!=="text"||(T="string"),d=this._decompressWorker();var y=!this._dataBinary;y&&!l&&(d=d.pipe(new u.Utf8EncodeWorker)),!y&&l&&(d=d.pipe(new u.Utf8DecodeWorker))}catch(I){(d=new b("error")).error(I)}return new i(d,T,"")},async:function(k,d){return this.internalStream(k).accumulate(d)},nodeStream:function(k,d){return this.internalStream(k||"nodebuffer").toNodejsStream(d)},_compressWorker:function(k,d){if(this._data instanceof _&&this._data.compression.magic===k.magic)return this._data.getCompressedWorker();var T=this._decompressWorker();return this._dataBinary||(T=T.pipe(new u.Utf8EncodeWorker)),_.createWorkerFrom(T,k,d)},_decompressWorker:function(){return this._data instanceof _?this._data.getContentWorker():this._data instanceof b?this._data:new o(this._data)}};for(var v=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],E=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},p=0;p<v.length;p++)n.prototype[v[p]]=E;s.exports=n},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(t,s,r){(function(n){var i,o,u=n.MutationObserver||n.WebKitMutationObserver;if(u){var _=0,b=new u(k),v=n.document.createTextNode("");b.observe(v,{characterData:!0}),i=function(){v.data=_=++_%2}}else if(n.setImmediate||n.MessageChannel===void 0)i="document"in n&&"onreadystatechange"in n.document.createElement("script")?function(){var d=n.document.createElement("script");d.onreadystatechange=function(){k(),d.onreadystatechange=null,d.parentNode.removeChild(d),d=null},n.document.documentElement.appendChild(d)}:function(){setTimeout(k,0)};else{var E=new n.MessageChannel;E.port1.onmessage=k,i=function(){E.port2.postMessage(0)}}var p=[];function k(){var d,T;o=!0;for(var l=p.length;l;){for(T=p,p=[],d=-1;++d<l;)T[d]();l=p.length}o=!1}s.exports=function(d){p.push(d)!==1||o||i()}}).call(this,typeof qt<"u"?qt:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(t,s,r){var n=t("immediate");function i(){}var o={},u=["REJECTED"],_=["FULFILLED"],b=["PENDING"];function v(l){if(typeof l!="function")throw new TypeError("resolver must be a function");this.state=b,this.queue=[],this.outcome=void 0,l!==i&&d(this,l)}function E(l,y,I){this.promise=l,typeof y=="function"&&(this.onFulfilled=y,this.callFulfilled=this.otherCallFulfilled),typeof I=="function"&&(this.onRejected=I,this.callRejected=this.otherCallRejected)}function p(l,y,I){n(function(){var C;try{C=y(I)}catch(S){return o.reject(l,S)}C===l?o.reject(l,new TypeError("Cannot resolve promise with itself")):o.resolve(l,C)})}function k(l){var y=l&&l.then;if(l&&(typeof l=="object"||typeof l=="function")&&typeof y=="function")return function(){y.apply(l,arguments)}}function d(l,y){var I=!1;function C(D){I||(I=!0,o.reject(l,D))}function S(D){I||(I=!0,o.resolve(l,D))}var L=T(function(){y(S,C)});L.status==="error"&&C(L.value)}function T(l,y){var I={};try{I.value=l(y),I.status="success"}catch(C){I.status="error",I.value=C}return I}(s.exports=v).prototype.finally=function(l){if(typeof l!="function")return this;var y=this.constructor;return this.then(function(I){return y.resolve(l()).then(function(){return I})},function(I){return y.resolve(l()).then(function(){throw I})})},v.prototype.catch=function(l){return this.then(null,l)},v.prototype.then=function(l,y){if(typeof l!="function"&&this.state===_||typeof y!="function"&&this.state===u)return this;var I=new this.constructor(i);return this.state!==b?p(I,this.state===_?l:y,this.outcome):this.queue.push(new E(I,l,y)),I},E.prototype.callFulfilled=function(l){o.resolve(this.promise,l)},E.prototype.otherCallFulfilled=function(l){p(this.promise,this.onFulfilled,l)},E.prototype.callRejected=function(l){o.reject(this.promise,l)},E.prototype.otherCallRejected=function(l){p(this.promise,this.onRejected,l)},o.resolve=function(l,y){var I=T(k,y);if(I.status==="error")return o.reject(l,I.value);var C=I.value;if(C)d(l,C);else{l.state=_,l.outcome=y;for(var S=-1,L=l.queue.length;++S<L;)l.queue[S].callFulfilled(y)}return l},o.reject=function(l,y){l.state=u,l.outcome=y;for(var I=-1,C=l.queue.length;++I<C;)l.queue[I].callRejected(y);return l},v.resolve=function(l){return l instanceof this?l:o.resolve(new this(i),l)},v.reject=function(l){var y=new this(i);return o.reject(y,l)},v.all=function(l){var y=this;if(Object.prototype.toString.call(l)!=="[object Array]")return this.reject(new TypeError("must be an array"));var I=l.length,C=!1;if(!I)return this.resolve([]);for(var S=new Array(I),L=0,D=-1,N=new this(i);++D<I;)m(l[D],D);return N;function m(P,Z){y.resolve(P).then(function(A){S[Z]=A,++L!==I||C||(C=!0,o.resolve(N,S))},function(A){C||(C=!0,o.reject(N,A))})}},v.race=function(l){var y=this;if(Object.prototype.toString.call(l)!=="[object Array]")return this.reject(new TypeError("must be an array"));var I=l.length,C=!1;if(!I)return this.resolve([]);for(var S=-1,L=new this(i);++S<I;)D=l[S],y.resolve(D).then(function(N){C||(C=!0,o.resolve(L,N))},function(N){C||(C=!0,o.reject(L,N))});var D;return L}},{immediate:36}],38:[function(t,s,r){var n={};(0,t("./lib/utils/common").assign)(n,t("./lib/deflate"),t("./lib/inflate"),t("./lib/zlib/constants")),s.exports=n},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(t,s,r){var n=t("./zlib/deflate"),i=t("./utils/common"),o=t("./utils/strings"),u=t("./zlib/messages"),_=t("./zlib/zstream"),b=Object.prototype.toString,v=0,E=-1,p=0,k=8;function d(l){if(!(this instanceof d))return new d(l);this.options=i.assign({level:E,method:k,chunkSize:16384,windowBits:15,memLevel:8,strategy:p,to:""},l||{});var y=this.options;y.raw&&0<y.windowBits?y.windowBits=-y.windowBits:y.gzip&&0<y.windowBits&&y.windowBits<16&&(y.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new _,this.strm.avail_out=0;var I=n.deflateInit2(this.strm,y.level,y.method,y.windowBits,y.memLevel,y.strategy);if(I!==v)throw new Error(u[I]);if(y.header&&n.deflateSetHeader(this.strm,y.header),y.dictionary){var C;if(C=typeof y.dictionary=="string"?o.string2buf(y.dictionary):b.call(y.dictionary)==="[object ArrayBuffer]"?new Uint8Array(y.dictionary):y.dictionary,(I=n.deflateSetDictionary(this.strm,C))!==v)throw new Error(u[I]);this._dict_set=!0}}function T(l,y){var I=new d(y);if(I.push(l,!0),I.err)throw I.msg||u[I.err];return I.result}d.prototype.push=function(l,y){var I,C,S=this.strm,L=this.options.chunkSize;if(this.ended)return!1;C=y===~~y?y:y===!0?4:0,typeof l=="string"?S.input=o.string2buf(l):b.call(l)==="[object ArrayBuffer]"?S.input=new Uint8Array(l):S.input=l,S.next_in=0,S.avail_in=S.input.length;do{if(S.avail_out===0&&(S.output=new i.Buf8(L),S.next_out=0,S.avail_out=L),(I=n.deflate(S,C))!==1&&I!==v)return this.onEnd(I),!(this.ended=!0);S.avail_out!==0&&(S.avail_in!==0||C!==4&&C!==2)||(this.options.to==="string"?this.onData(o.buf2binstring(i.shrinkBuf(S.output,S.next_out))):this.onData(i.shrinkBuf(S.output,S.next_out)))}while((0<S.avail_in||S.avail_out===0)&&I!==1);return C===4?(I=n.deflateEnd(this.strm),this.onEnd(I),this.ended=!0,I===v):C!==2||(this.onEnd(v),!(S.avail_out=0))},d.prototype.onData=function(l){this.chunks.push(l)},d.prototype.onEnd=function(l){l===v&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=l,this.msg=this.strm.msg},r.Deflate=d,r.deflate=T,r.deflateRaw=function(l,y){return(y=y||{}).raw=!0,T(l,y)},r.gzip=function(l,y){return(y=y||{}).gzip=!0,T(l,y)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(t,s,r){var n=t("./zlib/inflate"),i=t("./utils/common"),o=t("./utils/strings"),u=t("./zlib/constants"),_=t("./zlib/messages"),b=t("./zlib/zstream"),v=t("./zlib/gzheader"),E=Object.prototype.toString;function p(d){if(!(this instanceof p))return new p(d);this.options=i.assign({chunkSize:16384,windowBits:0,to:""},d||{});var T=this.options;T.raw&&0<=T.windowBits&&T.windowBits<16&&(T.windowBits=-T.windowBits,T.windowBits===0&&(T.windowBits=-15)),!(0<=T.windowBits&&T.windowBits<16)||d&&d.windowBits||(T.windowBits+=32),15<T.windowBits&&T.windowBits<48&&(15&T.windowBits)==0&&(T.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new b,this.strm.avail_out=0;var l=n.inflateInit2(this.strm,T.windowBits);if(l!==u.Z_OK)throw new Error(_[l]);this.header=new v,n.inflateGetHeader(this.strm,this.header)}function k(d,T){var l=new p(T);if(l.push(d,!0),l.err)throw l.msg||_[l.err];return l.result}p.prototype.push=function(d,T){var l,y,I,C,S,L,D=this.strm,N=this.options.chunkSize,m=this.options.dictionary,P=!1;if(this.ended)return!1;y=T===~~T?T:T===!0?u.Z_FINISH:u.Z_NO_FLUSH,typeof d=="string"?D.input=o.binstring2buf(d):E.call(d)==="[object ArrayBuffer]"?D.input=new Uint8Array(d):D.input=d,D.next_in=0,D.avail_in=D.input.length;do{if(D.avail_out===0&&(D.output=new i.Buf8(N),D.next_out=0,D.avail_out=N),(l=n.inflate(D,u.Z_NO_FLUSH))===u.Z_NEED_DICT&&m&&(L=typeof m=="string"?o.string2buf(m):E.call(m)==="[object ArrayBuffer]"?new Uint8Array(m):m,l=n.inflateSetDictionary(this.strm,L)),l===u.Z_BUF_ERROR&&P===!0&&(l=u.Z_OK,P=!1),l!==u.Z_STREAM_END&&l!==u.Z_OK)return this.onEnd(l),!(this.ended=!0);D.next_out&&(D.avail_out!==0&&l!==u.Z_STREAM_END&&(D.avail_in!==0||y!==u.Z_FINISH&&y!==u.Z_SYNC_FLUSH)||(this.options.to==="string"?(I=o.utf8border(D.output,D.next_out),C=D.next_out-I,S=o.buf2string(D.output,I),D.next_out=C,D.avail_out=N-C,C&&i.arraySet(D.output,D.output,I,C,0),this.onData(S)):this.onData(i.shrinkBuf(D.output,D.next_out)))),D.avail_in===0&&D.avail_out===0&&(P=!0)}while((0<D.avail_in||D.avail_out===0)&&l!==u.Z_STREAM_END);return l===u.Z_STREAM_END&&(y=u.Z_FINISH),y===u.Z_FINISH?(l=n.inflateEnd(this.strm),this.onEnd(l),this.ended=!0,l===u.Z_OK):y!==u.Z_SYNC_FLUSH||(this.onEnd(u.Z_OK),!(D.avail_out=0))},p.prototype.onData=function(d){this.chunks.push(d)},p.prototype.onEnd=function(d){d===u.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=d,this.msg=this.strm.msg},r.Inflate=p,r.inflate=k,r.inflateRaw=function(d,T){return(T=T||{}).raw=!0,k(d,T)},r.ungzip=k},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(t,s,r){var n=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";r.assign=function(u){for(var _=Array.prototype.slice.call(arguments,1);_.length;){var b=_.shift();if(b){if(typeof b!="object")throw new TypeError(b+"must be non-object");for(var v in b)b.hasOwnProperty(v)&&(u[v]=b[v])}}return u},r.shrinkBuf=function(u,_){return u.length===_?u:u.subarray?u.subarray(0,_):(u.length=_,u)};var i={arraySet:function(u,_,b,v,E){if(_.subarray&&u.subarray)u.set(_.subarray(b,b+v),E);else for(var p=0;p<v;p++)u[E+p]=_[b+p]},flattenChunks:function(u){var _,b,v,E,p,k;for(_=v=0,b=u.length;_<b;_++)v+=u[_].length;for(k=new Uint8Array(v),_=E=0,b=u.length;_<b;_++)p=u[_],k.set(p,E),E+=p.length;return k}},o={arraySet:function(u,_,b,v,E){for(var p=0;p<v;p++)u[E+p]=_[b+p]},flattenChunks:function(u){return[].concat.apply([],u)}};r.setTyped=function(u){u?(r.Buf8=Uint8Array,r.Buf16=Uint16Array,r.Buf32=Int32Array,r.assign(r,i)):(r.Buf8=Array,r.Buf16=Array,r.Buf32=Array,r.assign(r,o))},r.setTyped(n)},{}],42:[function(t,s,r){var n=t("./common"),i=!0,o=!0;try{String.fromCharCode.apply(null,[0])}catch{i=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{o=!1}for(var u=new n.Buf8(256),_=0;_<256;_++)u[_]=252<=_?6:248<=_?5:240<=_?4:224<=_?3:192<=_?2:1;function b(v,E){if(E<65537&&(v.subarray&&o||!v.subarray&&i))return String.fromCharCode.apply(null,n.shrinkBuf(v,E));for(var p="",k=0;k<E;k++)p+=String.fromCharCode(v[k]);return p}u[254]=u[254]=1,r.string2buf=function(v){var E,p,k,d,T,l=v.length,y=0;for(d=0;d<l;d++)(64512&(p=v.charCodeAt(d)))==55296&&d+1<l&&(64512&(k=v.charCodeAt(d+1)))==56320&&(p=65536+(p-55296<<10)+(k-56320),d++),y+=p<128?1:p<2048?2:p<65536?3:4;for(E=new n.Buf8(y),d=T=0;T<y;d++)(64512&(p=v.charCodeAt(d)))==55296&&d+1<l&&(64512&(k=v.charCodeAt(d+1)))==56320&&(p=65536+(p-55296<<10)+(k-56320),d++),p<128?E[T++]=p:(p<2048?E[T++]=192|p>>>6:(p<65536?E[T++]=224|p>>>12:(E[T++]=240|p>>>18,E[T++]=128|p>>>12&63),E[T++]=128|p>>>6&63),E[T++]=128|63&p);return E},r.buf2binstring=function(v){return b(v,v.length)},r.binstring2buf=function(v){for(var E=new n.Buf8(v.length),p=0,k=E.length;p<k;p++)E[p]=v.charCodeAt(p);return E},r.buf2string=function(v,E){var p,k,d,T,l=E||v.length,y=new Array(2*l);for(p=k=0;p<l;)if((d=v[p++])<128)y[k++]=d;else if(4<(T=u[d]))y[k++]=65533,p+=T-1;else{for(d&=T===2?31:T===3?15:7;1<T&&p<l;)d=d<<6|63&v[p++],T--;1<T?y[k++]=65533:d<65536?y[k++]=d:(d-=65536,y[k++]=55296|d>>10&1023,y[k++]=56320|1023&d)}return b(y,k)},r.utf8border=function(v,E){var p;for((E=E||v.length)>v.length&&(E=v.length),p=E-1;0<=p&&(192&v[p])==128;)p--;return p<0||p===0?E:p+u[v[p]]>E?p:E}},{"./common":41}],43:[function(t,s,r){s.exports=function(n,i,o,u){for(var _=65535&n|0,b=n>>>16&65535|0,v=0;o!==0;){for(o-=v=2e3<o?2e3:o;b=b+(_=_+i[u++]|0)|0,--v;);_%=65521,b%=65521}return _|b<<16|0}},{}],44:[function(t,s,r){s.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(t,s,r){var n=(function(){for(var i,o=[],u=0;u<256;u++){i=u;for(var _=0;_<8;_++)i=1&i?3988292384^i>>>1:i>>>1;o[u]=i}return o})();s.exports=function(i,o,u,_){var b=n,v=_+u;i^=-1;for(var E=_;E<v;E++)i=i>>>8^b[255&(i^o[E])];return-1^i}},{}],46:[function(t,s,r){var n,i=t("../utils/common"),o=t("./trees"),u=t("./adler32"),_=t("./crc32"),b=t("./messages"),v=0,E=4,p=0,k=-2,d=-1,T=4,l=2,y=8,I=9,C=286,S=30,L=19,D=2*C+1,N=15,m=3,P=258,Z=P+m+1,A=42,z=113,h=1,q=2,it=3,W=4;function st(a,H){return a.msg=b[H],H}function X(a){return(a<<1)-(4<a?9:0)}function rt(a){for(var H=a.length;0<=--H;)a[H]=0}function U(a){var H=a.state,j=H.pending;j>a.avail_out&&(j=a.avail_out),j!==0&&(i.arraySet(a.output,H.pending_buf,H.pending_out,j,a.next_out),a.next_out+=j,H.pending_out+=j,a.total_out+=j,a.avail_out-=j,H.pending-=j,H.pending===0&&(H.pending_out=0))}function R(a,H){o._tr_flush_block(a,0<=a.block_start?a.block_start:-1,a.strstart-a.block_start,H),a.block_start=a.strstart,U(a.strm)}function tt(a,H){a.pending_buf[a.pending++]=H}function Q(a,H){a.pending_buf[a.pending++]=H>>>8&255,a.pending_buf[a.pending++]=255&H}function K(a,H){var j,x,w=a.max_chain_length,F=a.strstart,V=a.prev_length,G=a.nice_match,B=a.strstart>a.w_size-Z?a.strstart-(a.w_size-Z):0,Y=a.window,J=a.w_mask,$=a.prev,et=a.strstart+P,ht=Y[F+V-1],at=Y[F+V];a.prev_length>=a.good_match&&(w>>=2),G>a.lookahead&&(G=a.lookahead);do if(Y[(j=H)+V]===at&&Y[j+V-1]===ht&&Y[j]===Y[F]&&Y[++j]===Y[F+1]){F+=2,j++;do;while(Y[++F]===Y[++j]&&Y[++F]===Y[++j]&&Y[++F]===Y[++j]&&Y[++F]===Y[++j]&&Y[++F]===Y[++j]&&Y[++F]===Y[++j]&&Y[++F]===Y[++j]&&Y[++F]===Y[++j]&&F<et);if(x=P-(et-F),F=et-P,V<x){if(a.match_start=H,G<=(V=x))break;ht=Y[F+V-1],at=Y[F+V]}}while((H=$[H&J])>B&&--w!=0);return V<=a.lookahead?V:a.lookahead}function dt(a){var H,j,x,w,F,V,G,B,Y,J,$=a.w_size;do{if(w=a.window_size-a.lookahead-a.strstart,a.strstart>=$+($-Z)){for(i.arraySet(a.window,a.window,$,$,0),a.match_start-=$,a.strstart-=$,a.block_start-=$,H=j=a.hash_size;x=a.head[--H],a.head[H]=$<=x?x-$:0,--j;);for(H=j=$;x=a.prev[--H],a.prev[H]=$<=x?x-$:0,--j;);w+=$}if(a.strm.avail_in===0)break;if(V=a.strm,G=a.window,B=a.strstart+a.lookahead,Y=w,J=void 0,J=V.avail_in,Y<J&&(J=Y),j=J===0?0:(V.avail_in-=J,i.arraySet(G,V.input,V.next_in,J,B),V.state.wrap===1?V.adler=u(V.adler,G,J,B):V.state.wrap===2&&(V.adler=_(V.adler,G,J,B)),V.next_in+=J,V.total_in+=J,J),a.lookahead+=j,a.lookahead+a.insert>=m)for(F=a.strstart-a.insert,a.ins_h=a.window[F],a.ins_h=(a.ins_h<<a.hash_shift^a.window[F+1])&a.hash_mask;a.insert&&(a.ins_h=(a.ins_h<<a.hash_shift^a.window[F+m-1])&a.hash_mask,a.prev[F&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=F,F++,a.insert--,!(a.lookahead+a.insert<m)););}while(a.lookahead<Z&&a.strm.avail_in!==0)}function g(a,H){for(var j,x;;){if(a.lookahead<Z){if(dt(a),a.lookahead<Z&&H===v)return h;if(a.lookahead===0)break}if(j=0,a.lookahead>=m&&(a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+m-1])&a.hash_mask,j=a.prev[a.strstart&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=a.strstart),j!==0&&a.strstart-j<=a.w_size-Z&&(a.match_length=K(a,j)),a.match_length>=m)if(x=o._tr_tally(a,a.strstart-a.match_start,a.match_length-m),a.lookahead-=a.match_length,a.match_length<=a.max_lazy_match&&a.lookahead>=m){for(a.match_length--;a.strstart++,a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+m-1])&a.hash_mask,j=a.prev[a.strstart&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=a.strstart,--a.match_length!=0;);a.strstart++}else a.strstart+=a.match_length,a.match_length=0,a.ins_h=a.window[a.strstart],a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+1])&a.hash_mask;else x=o._tr_tally(a,0,a.window[a.strstart]),a.lookahead--,a.strstart++;if(x&&(R(a,!1),a.strm.avail_out===0))return h}return a.insert=a.strstart<m-1?a.strstart:m-1,H===E?(R(a,!0),a.strm.avail_out===0?it:W):a.last_lit&&(R(a,!1),a.strm.avail_out===0)?h:q}function c(a,H){for(var j,x,w;;){if(a.lookahead<Z){if(dt(a),a.lookahead<Z&&H===v)return h;if(a.lookahead===0)break}if(j=0,a.lookahead>=m&&(a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+m-1])&a.hash_mask,j=a.prev[a.strstart&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=a.strstart),a.prev_length=a.match_length,a.prev_match=a.match_start,a.match_length=m-1,j!==0&&a.prev_length<a.max_lazy_match&&a.strstart-j<=a.w_size-Z&&(a.match_length=K(a,j),a.match_length<=5&&(a.strategy===1||a.match_length===m&&4096<a.strstart-a.match_start)&&(a.match_length=m-1)),a.prev_length>=m&&a.match_length<=a.prev_length){for(w=a.strstart+a.lookahead-m,x=o._tr_tally(a,a.strstart-1-a.prev_match,a.prev_length-m),a.lookahead-=a.prev_length-1,a.prev_length-=2;++a.strstart<=w&&(a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+m-1])&a.hash_mask,j=a.prev[a.strstart&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=a.strstart),--a.prev_length!=0;);if(a.match_available=0,a.match_length=m-1,a.strstart++,x&&(R(a,!1),a.strm.avail_out===0))return h}else if(a.match_available){if((x=o._tr_tally(a,0,a.window[a.strstart-1]))&&R(a,!1),a.strstart++,a.lookahead--,a.strm.avail_out===0)return h}else a.match_available=1,a.strstart++,a.lookahead--}return a.match_available&&(x=o._tr_tally(a,0,a.window[a.strstart-1]),a.match_available=0),a.insert=a.strstart<m-1?a.strstart:m-1,H===E?(R(a,!0),a.strm.avail_out===0?it:W):a.last_lit&&(R(a,!1),a.strm.avail_out===0)?h:q}function M(a,H,j,x,w){this.good_length=a,this.max_lazy=H,this.nice_length=j,this.max_chain=x,this.func=w}function O(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=y,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new i.Buf16(2*D),this.dyn_dtree=new i.Buf16(2*(2*S+1)),this.bl_tree=new i.Buf16(2*(2*L+1)),rt(this.dyn_ltree),rt(this.dyn_dtree),rt(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new i.Buf16(N+1),this.heap=new i.Buf16(2*C+1),rt(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new i.Buf16(2*C+1),rt(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function nt(a){var H;return a&&a.state?(a.total_in=a.total_out=0,a.data_type=l,(H=a.state).pending=0,H.pending_out=0,H.wrap<0&&(H.wrap=-H.wrap),H.status=H.wrap?A:z,a.adler=H.wrap===2?0:1,H.last_flush=v,o._tr_init(H),p):st(a,k)}function lt(a){var H=nt(a);return H===p&&(function(j){j.window_size=2*j.w_size,rt(j.head),j.max_lazy_match=n[j.level].max_lazy,j.good_match=n[j.level].good_length,j.nice_match=n[j.level].nice_length,j.max_chain_length=n[j.level].max_chain,j.strstart=0,j.block_start=0,j.lookahead=0,j.insert=0,j.match_length=j.prev_length=m-1,j.match_available=0,j.ins_h=0})(a.state),H}function ut(a,H,j,x,w,F){if(!a)return k;var V=1;if(H===d&&(H=6),x<0?(V=0,x=-x):15<x&&(V=2,x-=16),w<1||I<w||j!==y||x<8||15<x||H<0||9<H||F<0||T<F)return st(a,k);x===8&&(x=9);var G=new O;return(a.state=G).strm=a,G.wrap=V,G.gzhead=null,G.w_bits=x,G.w_size=1<<G.w_bits,G.w_mask=G.w_size-1,G.hash_bits=w+7,G.hash_size=1<<G.hash_bits,G.hash_mask=G.hash_size-1,G.hash_shift=~~((G.hash_bits+m-1)/m),G.window=new i.Buf8(2*G.w_size),G.head=new i.Buf16(G.hash_size),G.prev=new i.Buf16(G.w_size),G.lit_bufsize=1<<w+6,G.pending_buf_size=4*G.lit_bufsize,G.pending_buf=new i.Buf8(G.pending_buf_size),G.d_buf=1*G.lit_bufsize,G.l_buf=3*G.lit_bufsize,G.level=H,G.strategy=F,G.method=j,lt(a)}n=[new M(0,0,0,0,function(a,H){var j=65535;for(j>a.pending_buf_size-5&&(j=a.pending_buf_size-5);;){if(a.lookahead<=1){if(dt(a),a.lookahead===0&&H===v)return h;if(a.lookahead===0)break}a.strstart+=a.lookahead,a.lookahead=0;var x=a.block_start+j;if((a.strstart===0||a.strstart>=x)&&(a.lookahead=a.strstart-x,a.strstart=x,R(a,!1),a.strm.avail_out===0)||a.strstart-a.block_start>=a.w_size-Z&&(R(a,!1),a.strm.avail_out===0))return h}return a.insert=0,H===E?(R(a,!0),a.strm.avail_out===0?it:W):(a.strstart>a.block_start&&(R(a,!1),a.strm.avail_out),h)}),new M(4,4,8,4,g),new M(4,5,16,8,g),new M(4,6,32,32,g),new M(4,4,16,16,c),new M(8,16,32,32,c),new M(8,16,128,128,c),new M(8,32,128,256,c),new M(32,128,258,1024,c),new M(32,258,258,4096,c)],r.deflateInit=function(a,H){return ut(a,H,y,15,8,0)},r.deflateInit2=ut,r.deflateReset=lt,r.deflateResetKeep=nt,r.deflateSetHeader=function(a,H){return a&&a.state?a.state.wrap!==2?k:(a.state.gzhead=H,p):k},r.deflate=function(a,H){var j,x,w,F;if(!a||!a.state||5<H||H<0)return a?st(a,k):k;if(x=a.state,!a.output||!a.input&&a.avail_in!==0||x.status===666&&H!==E)return st(a,a.avail_out===0?-5:k);if(x.strm=a,j=x.last_flush,x.last_flush=H,x.status===A)if(x.wrap===2)a.adler=0,tt(x,31),tt(x,139),tt(x,8),x.gzhead?(tt(x,(x.gzhead.text?1:0)+(x.gzhead.hcrc?2:0)+(x.gzhead.extra?4:0)+(x.gzhead.name?8:0)+(x.gzhead.comment?16:0)),tt(x,255&x.gzhead.time),tt(x,x.gzhead.time>>8&255),tt(x,x.gzhead.time>>16&255),tt(x,x.gzhead.time>>24&255),tt(x,x.level===9?2:2<=x.strategy||x.level<2?4:0),tt(x,255&x.gzhead.os),x.gzhead.extra&&x.gzhead.extra.length&&(tt(x,255&x.gzhead.extra.length),tt(x,x.gzhead.extra.length>>8&255)),x.gzhead.hcrc&&(a.adler=_(a.adler,x.pending_buf,x.pending,0)),x.gzindex=0,x.status=69):(tt(x,0),tt(x,0),tt(x,0),tt(x,0),tt(x,0),tt(x,x.level===9?2:2<=x.strategy||x.level<2?4:0),tt(x,3),x.status=z);else{var V=y+(x.w_bits-8<<4)<<8;V|=(2<=x.strategy||x.level<2?0:x.level<6?1:x.level===6?2:3)<<6,x.strstart!==0&&(V|=32),V+=31-V%31,x.status=z,Q(x,V),x.strstart!==0&&(Q(x,a.adler>>>16),Q(x,65535&a.adler)),a.adler=1}if(x.status===69)if(x.gzhead.extra){for(w=x.pending;x.gzindex<(65535&x.gzhead.extra.length)&&(x.pending!==x.pending_buf_size||(x.gzhead.hcrc&&x.pending>w&&(a.adler=_(a.adler,x.pending_buf,x.pending-w,w)),U(a),w=x.pending,x.pending!==x.pending_buf_size));)tt(x,255&x.gzhead.extra[x.gzindex]),x.gzindex++;x.gzhead.hcrc&&x.pending>w&&(a.adler=_(a.adler,x.pending_buf,x.pending-w,w)),x.gzindex===x.gzhead.extra.length&&(x.gzindex=0,x.status=73)}else x.status=73;if(x.status===73)if(x.gzhead.name){w=x.pending;do{if(x.pending===x.pending_buf_size&&(x.gzhead.hcrc&&x.pending>w&&(a.adler=_(a.adler,x.pending_buf,x.pending-w,w)),U(a),w=x.pending,x.pending===x.pending_buf_size)){F=1;break}F=x.gzindex<x.gzhead.name.length?255&x.gzhead.name.charCodeAt(x.gzindex++):0,tt(x,F)}while(F!==0);x.gzhead.hcrc&&x.pending>w&&(a.adler=_(a.adler,x.pending_buf,x.pending-w,w)),F===0&&(x.gzindex=0,x.status=91)}else x.status=91;if(x.status===91)if(x.gzhead.comment){w=x.pending;do{if(x.pending===x.pending_buf_size&&(x.gzhead.hcrc&&x.pending>w&&(a.adler=_(a.adler,x.pending_buf,x.pending-w,w)),U(a),w=x.pending,x.pending===x.pending_buf_size)){F=1;break}F=x.gzindex<x.gzhead.comment.length?255&x.gzhead.comment.charCodeAt(x.gzindex++):0,tt(x,F)}while(F!==0);x.gzhead.hcrc&&x.pending>w&&(a.adler=_(a.adler,x.pending_buf,x.pending-w,w)),F===0&&(x.status=103)}else x.status=103;if(x.status===103&&(x.gzhead.hcrc?(x.pending+2>x.pending_buf_size&&U(a),x.pending+2<=x.pending_buf_size&&(tt(x,255&a.adler),tt(x,a.adler>>8&255),a.adler=0,x.status=z)):x.status=z),x.pending!==0){if(U(a),a.avail_out===0)return x.last_flush=-1,p}else if(a.avail_in===0&&X(H)<=X(j)&&H!==E)return st(a,-5);if(x.status===666&&a.avail_in!==0)return st(a,-5);if(a.avail_in!==0||x.lookahead!==0||H!==v&&x.status!==666){var G=x.strategy===2?(function(B,Y){for(var J;;){if(B.lookahead===0&&(dt(B),B.lookahead===0)){if(Y===v)return h;break}if(B.match_length=0,J=o._tr_tally(B,0,B.window[B.strstart]),B.lookahead--,B.strstart++,J&&(R(B,!1),B.strm.avail_out===0))return h}return B.insert=0,Y===E?(R(B,!0),B.strm.avail_out===0?it:W):B.last_lit&&(R(B,!1),B.strm.avail_out===0)?h:q})(x,H):x.strategy===3?(function(B,Y){for(var J,$,et,ht,at=B.window;;){if(B.lookahead<=P){if(dt(B),B.lookahead<=P&&Y===v)return h;if(B.lookahead===0)break}if(B.match_length=0,B.lookahead>=m&&0<B.strstart&&($=at[et=B.strstart-1])===at[++et]&&$===at[++et]&&$===at[++et]){ht=B.strstart+P;do;while($===at[++et]&&$===at[++et]&&$===at[++et]&&$===at[++et]&&$===at[++et]&&$===at[++et]&&$===at[++et]&&$===at[++et]&&et<ht);B.match_length=P-(ht-et),B.match_length>B.lookahead&&(B.match_length=B.lookahead)}if(B.match_length>=m?(J=o._tr_tally(B,1,B.match_length-m),B.lookahead-=B.match_length,B.strstart+=B.match_length,B.match_length=0):(J=o._tr_tally(B,0,B.window[B.strstart]),B.lookahead--,B.strstart++),J&&(R(B,!1),B.strm.avail_out===0))return h}return B.insert=0,Y===E?(R(B,!0),B.strm.avail_out===0?it:W):B.last_lit&&(R(B,!1),B.strm.avail_out===0)?h:q})(x,H):n[x.level].func(x,H);if(G!==it&&G!==W||(x.status=666),G===h||G===it)return a.avail_out===0&&(x.last_flush=-1),p;if(G===q&&(H===1?o._tr_align(x):H!==5&&(o._tr_stored_block(x,0,0,!1),H===3&&(rt(x.head),x.lookahead===0&&(x.strstart=0,x.block_start=0,x.insert=0))),U(a),a.avail_out===0))return x.last_flush=-1,p}return H!==E?p:x.wrap<=0?1:(x.wrap===2?(tt(x,255&a.adler),tt(x,a.adler>>8&255),tt(x,a.adler>>16&255),tt(x,a.adler>>24&255),tt(x,255&a.total_in),tt(x,a.total_in>>8&255),tt(x,a.total_in>>16&255),tt(x,a.total_in>>24&255)):(Q(x,a.adler>>>16),Q(x,65535&a.adler)),U(a),0<x.wrap&&(x.wrap=-x.wrap),x.pending!==0?p:1)},r.deflateEnd=function(a){var H;return a&&a.state?(H=a.state.status)!==A&&H!==69&&H!==73&&H!==91&&H!==103&&H!==z&&H!==666?st(a,k):(a.state=null,H===z?st(a,-3):p):k},r.deflateSetDictionary=function(a,H){var j,x,w,F,V,G,B,Y,J=H.length;if(!a||!a.state||(F=(j=a.state).wrap)===2||F===1&&j.status!==A||j.lookahead)return k;for(F===1&&(a.adler=u(a.adler,H,J,0)),j.wrap=0,J>=j.w_size&&(F===0&&(rt(j.head),j.strstart=0,j.block_start=0,j.insert=0),Y=new i.Buf8(j.w_size),i.arraySet(Y,H,J-j.w_size,j.w_size,0),H=Y,J=j.w_size),V=a.avail_in,G=a.next_in,B=a.input,a.avail_in=J,a.next_in=0,a.input=H,dt(j);j.lookahead>=m;){for(x=j.strstart,w=j.lookahead-(m-1);j.ins_h=(j.ins_h<<j.hash_shift^j.window[x+m-1])&j.hash_mask,j.prev[x&j.w_mask]=j.head[j.ins_h],j.head[j.ins_h]=x,x++,--w;);j.strstart=x,j.lookahead=m-1,dt(j)}return j.strstart+=j.lookahead,j.block_start=j.strstart,j.insert=j.lookahead,j.lookahead=0,j.match_length=j.prev_length=m-1,j.match_available=0,a.next_in=G,a.input=B,a.avail_in=V,j.wrap=F,p},r.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(t,s,r){s.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(t,s,r){s.exports=function(n,i){var o,u,_,b,v,E,p,k,d,T,l,y,I,C,S,L,D,N,m,P,Z,A,z,h,q;o=n.state,u=n.next_in,h=n.input,_=u+(n.avail_in-5),b=n.next_out,q=n.output,v=b-(i-n.avail_out),E=b+(n.avail_out-257),p=o.dmax,k=o.wsize,d=o.whave,T=o.wnext,l=o.window,y=o.hold,I=o.bits,C=o.lencode,S=o.distcode,L=(1<<o.lenbits)-1,D=(1<<o.distbits)-1;t:do{I<15&&(y+=h[u++]<<I,I+=8,y+=h[u++]<<I,I+=8),N=C[y&L];e:for(;;){if(y>>>=m=N>>>24,I-=m,(m=N>>>16&255)===0)q[b++]=65535&N;else{if(!(16&m)){if((64&m)==0){N=C[(65535&N)+(y&(1<<m)-1)];continue e}if(32&m){o.mode=12;break t}n.msg="invalid literal/length code",o.mode=30;break t}P=65535&N,(m&=15)&&(I<m&&(y+=h[u++]<<I,I+=8),P+=y&(1<<m)-1,y>>>=m,I-=m),I<15&&(y+=h[u++]<<I,I+=8,y+=h[u++]<<I,I+=8),N=S[y&D];n:for(;;){if(y>>>=m=N>>>24,I-=m,!(16&(m=N>>>16&255))){if((64&m)==0){N=S[(65535&N)+(y&(1<<m)-1)];continue n}n.msg="invalid distance code",o.mode=30;break t}if(Z=65535&N,I<(m&=15)&&(y+=h[u++]<<I,(I+=8)<m&&(y+=h[u++]<<I,I+=8)),p<(Z+=y&(1<<m)-1)){n.msg="invalid distance too far back",o.mode=30;break t}if(y>>>=m,I-=m,(m=b-v)<Z){if(d<(m=Z-m)&&o.sane){n.msg="invalid distance too far back",o.mode=30;break t}if(z=l,(A=0)===T){if(A+=k-m,m<P){for(P-=m;q[b++]=l[A++],--m;);A=b-Z,z=q}}else if(T<m){if(A+=k+T-m,(m-=T)<P){for(P-=m;q[b++]=l[A++],--m;);if(A=0,T<P){for(P-=m=T;q[b++]=l[A++],--m;);A=b-Z,z=q}}}else if(A+=T-m,m<P){for(P-=m;q[b++]=l[A++],--m;);A=b-Z,z=q}for(;2<P;)q[b++]=z[A++],q[b++]=z[A++],q[b++]=z[A++],P-=3;P&&(q[b++]=z[A++],1<P&&(q[b++]=z[A++]))}else{for(A=b-Z;q[b++]=q[A++],q[b++]=q[A++],q[b++]=q[A++],2<(P-=3););P&&(q[b++]=q[A++],1<P&&(q[b++]=q[A++]))}break}}break}}while(u<_&&b<E);u-=P=I>>3,y&=(1<<(I-=P<<3))-1,n.next_in=u,n.next_out=b,n.avail_in=u<_?_-u+5:5-(u-_),n.avail_out=b<E?E-b+257:257-(b-E),o.hold=y,o.bits=I}},{}],49:[function(t,s,r){var n=t("../utils/common"),i=t("./adler32"),o=t("./crc32"),u=t("./inffast"),_=t("./inftrees"),b=1,v=2,E=0,p=-2,k=1,d=852,T=592;function l(A){return(A>>>24&255)+(A>>>8&65280)+((65280&A)<<8)+((255&A)<<24)}function y(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new n.Buf16(320),this.work=new n.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function I(A){var z;return A&&A.state?(z=A.state,A.total_in=A.total_out=z.total=0,A.msg="",z.wrap&&(A.adler=1&z.wrap),z.mode=k,z.last=0,z.havedict=0,z.dmax=32768,z.head=null,z.hold=0,z.bits=0,z.lencode=z.lendyn=new n.Buf32(d),z.distcode=z.distdyn=new n.Buf32(T),z.sane=1,z.back=-1,E):p}function C(A){var z;return A&&A.state?((z=A.state).wsize=0,z.whave=0,z.wnext=0,I(A)):p}function S(A,z){var h,q;return A&&A.state?(q=A.state,z<0?(h=0,z=-z):(h=1+(z>>4),z<48&&(z&=15)),z&&(z<8||15<z)?p:(q.window!==null&&q.wbits!==z&&(q.window=null),q.wrap=h,q.wbits=z,C(A))):p}function L(A,z){var h,q;return A?(q=new y,(A.state=q).window=null,(h=S(A,z))!==E&&(A.state=null),h):p}var D,N,m=!0;function P(A){if(m){var z;for(D=new n.Buf32(512),N=new n.Buf32(32),z=0;z<144;)A.lens[z++]=8;for(;z<256;)A.lens[z++]=9;for(;z<280;)A.lens[z++]=7;for(;z<288;)A.lens[z++]=8;for(_(b,A.lens,0,288,D,0,A.work,{bits:9}),z=0;z<32;)A.lens[z++]=5;_(v,A.lens,0,32,N,0,A.work,{bits:5}),m=!1}A.lencode=D,A.lenbits=9,A.distcode=N,A.distbits=5}function Z(A,z,h,q){var it,W=A.state;return W.window===null&&(W.wsize=1<<W.wbits,W.wnext=0,W.whave=0,W.window=new n.Buf8(W.wsize)),q>=W.wsize?(n.arraySet(W.window,z,h-W.wsize,W.wsize,0),W.wnext=0,W.whave=W.wsize):(q<(it=W.wsize-W.wnext)&&(it=q),n.arraySet(W.window,z,h-q,it,W.wnext),(q-=it)?(n.arraySet(W.window,z,h-q,q,0),W.wnext=q,W.whave=W.wsize):(W.wnext+=it,W.wnext===W.wsize&&(W.wnext=0),W.whave<W.wsize&&(W.whave+=it))),0}r.inflateReset=C,r.inflateReset2=S,r.inflateResetKeep=I,r.inflateInit=function(A){return L(A,15)},r.inflateInit2=L,r.inflate=function(A,z){var h,q,it,W,st,X,rt,U,R,tt,Q,K,dt,g,c,M,O,nt,lt,ut,a,H,j,x,w=0,F=new n.Buf8(4),V=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!A||!A.state||!A.output||!A.input&&A.avail_in!==0)return p;(h=A.state).mode===12&&(h.mode=13),st=A.next_out,it=A.output,rt=A.avail_out,W=A.next_in,q=A.input,X=A.avail_in,U=h.hold,R=h.bits,tt=X,Q=rt,H=E;t:for(;;)switch(h.mode){case k:if(h.wrap===0){h.mode=13;break}for(;R<16;){if(X===0)break t;X--,U+=q[W++]<<R,R+=8}if(2&h.wrap&&U===35615){F[h.check=0]=255&U,F[1]=U>>>8&255,h.check=o(h.check,F,2,0),R=U=0,h.mode=2;break}if(h.flags=0,h.head&&(h.head.done=!1),!(1&h.wrap)||(((255&U)<<8)+(U>>8))%31){A.msg="incorrect header check",h.mode=30;break}if((15&U)!=8){A.msg="unknown compression method",h.mode=30;break}if(R-=4,a=8+(15&(U>>>=4)),h.wbits===0)h.wbits=a;else if(a>h.wbits){A.msg="invalid window size",h.mode=30;break}h.dmax=1<<a,A.adler=h.check=1,h.mode=512&U?10:12,R=U=0;break;case 2:for(;R<16;){if(X===0)break t;X--,U+=q[W++]<<R,R+=8}if(h.flags=U,(255&h.flags)!=8){A.msg="unknown compression method",h.mode=30;break}if(57344&h.flags){A.msg="unknown header flags set",h.mode=30;break}h.head&&(h.head.text=U>>8&1),512&h.flags&&(F[0]=255&U,F[1]=U>>>8&255,h.check=o(h.check,F,2,0)),R=U=0,h.mode=3;case 3:for(;R<32;){if(X===0)break t;X--,U+=q[W++]<<R,R+=8}h.head&&(h.head.time=U),512&h.flags&&(F[0]=255&U,F[1]=U>>>8&255,F[2]=U>>>16&255,F[3]=U>>>24&255,h.check=o(h.check,F,4,0)),R=U=0,h.mode=4;case 4:for(;R<16;){if(X===0)break t;X--,U+=q[W++]<<R,R+=8}h.head&&(h.head.xflags=255&U,h.head.os=U>>8),512&h.flags&&(F[0]=255&U,F[1]=U>>>8&255,h.check=o(h.check,F,2,0)),R=U=0,h.mode=5;case 5:if(1024&h.flags){for(;R<16;){if(X===0)break t;X--,U+=q[W++]<<R,R+=8}h.length=U,h.head&&(h.head.extra_len=U),512&h.flags&&(F[0]=255&U,F[1]=U>>>8&255,h.check=o(h.check,F,2,0)),R=U=0}else h.head&&(h.head.extra=null);h.mode=6;case 6:if(1024&h.flags&&(X<(K=h.length)&&(K=X),K&&(h.head&&(a=h.head.extra_len-h.length,h.head.extra||(h.head.extra=new Array(h.head.extra_len)),n.arraySet(h.head.extra,q,W,K,a)),512&h.flags&&(h.check=o(h.check,q,K,W)),X-=K,W+=K,h.length-=K),h.length))break t;h.length=0,h.mode=7;case 7:if(2048&h.flags){if(X===0)break t;for(K=0;a=q[W+K++],h.head&&a&&h.length<65536&&(h.head.name+=String.fromCharCode(a)),a&&K<X;);if(512&h.flags&&(h.check=o(h.check,q,K,W)),X-=K,W+=K,a)break t}else h.head&&(h.head.name=null);h.length=0,h.mode=8;case 8:if(4096&h.flags){if(X===0)break t;for(K=0;a=q[W+K++],h.head&&a&&h.length<65536&&(h.head.comment+=String.fromCharCode(a)),a&&K<X;);if(512&h.flags&&(h.check=o(h.check,q,K,W)),X-=K,W+=K,a)break t}else h.head&&(h.head.comment=null);h.mode=9;case 9:if(512&h.flags){for(;R<16;){if(X===0)break t;X--,U+=q[W++]<<R,R+=8}if(U!==(65535&h.check)){A.msg="header crc mismatch",h.mode=30;break}R=U=0}h.head&&(h.head.hcrc=h.flags>>9&1,h.head.done=!0),A.adler=h.check=0,h.mode=12;break;case 10:for(;R<32;){if(X===0)break t;X--,U+=q[W++]<<R,R+=8}A.adler=h.check=l(U),R=U=0,h.mode=11;case 11:if(h.havedict===0)return A.next_out=st,A.avail_out=rt,A.next_in=W,A.avail_in=X,h.hold=U,h.bits=R,2;A.adler=h.check=1,h.mode=12;case 12:if(z===5||z===6)break t;case 13:if(h.last){U>>>=7&R,R-=7&R,h.mode=27;break}for(;R<3;){if(X===0)break t;X--,U+=q[W++]<<R,R+=8}switch(h.last=1&U,R-=1,3&(U>>>=1)){case 0:h.mode=14;break;case 1:if(P(h),h.mode=20,z!==6)break;U>>>=2,R-=2;break t;case 2:h.mode=17;break;case 3:A.msg="invalid block type",h.mode=30}U>>>=2,R-=2;break;case 14:for(U>>>=7&R,R-=7&R;R<32;){if(X===0)break t;X--,U+=q[W++]<<R,R+=8}if((65535&U)!=(U>>>16^65535)){A.msg="invalid stored block lengths",h.mode=30;break}if(h.length=65535&U,R=U=0,h.mode=15,z===6)break t;case 15:h.mode=16;case 16:if(K=h.length){if(X<K&&(K=X),rt<K&&(K=rt),K===0)break t;n.arraySet(it,q,W,K,st),X-=K,W+=K,rt-=K,st+=K,h.length-=K;break}h.mode=12;break;case 17:for(;R<14;){if(X===0)break t;X--,U+=q[W++]<<R,R+=8}if(h.nlen=257+(31&U),U>>>=5,R-=5,h.ndist=1+(31&U),U>>>=5,R-=5,h.ncode=4+(15&U),U>>>=4,R-=4,286<h.nlen||30<h.ndist){A.msg="too many length or distance symbols",h.mode=30;break}h.have=0,h.mode=18;case 18:for(;h.have<h.ncode;){for(;R<3;){if(X===0)break t;X--,U+=q[W++]<<R,R+=8}h.lens[V[h.have++]]=7&U,U>>>=3,R-=3}for(;h.have<19;)h.lens[V[h.have++]]=0;if(h.lencode=h.lendyn,h.lenbits=7,j={bits:h.lenbits},H=_(0,h.lens,0,19,h.lencode,0,h.work,j),h.lenbits=j.bits,H){A.msg="invalid code lengths set",h.mode=30;break}h.have=0,h.mode=19;case 19:for(;h.have<h.nlen+h.ndist;){for(;M=(w=h.lencode[U&(1<<h.lenbits)-1])>>>16&255,O=65535&w,!((c=w>>>24)<=R);){if(X===0)break t;X--,U+=q[W++]<<R,R+=8}if(O<16)U>>>=c,R-=c,h.lens[h.have++]=O;else{if(O===16){for(x=c+2;R<x;){if(X===0)break t;X--,U+=q[W++]<<R,R+=8}if(U>>>=c,R-=c,h.have===0){A.msg="invalid bit length repeat",h.mode=30;break}a=h.lens[h.have-1],K=3+(3&U),U>>>=2,R-=2}else if(O===17){for(x=c+3;R<x;){if(X===0)break t;X--,U+=q[W++]<<R,R+=8}R-=c,a=0,K=3+(7&(U>>>=c)),U>>>=3,R-=3}else{for(x=c+7;R<x;){if(X===0)break t;X--,U+=q[W++]<<R,R+=8}R-=c,a=0,K=11+(127&(U>>>=c)),U>>>=7,R-=7}if(h.have+K>h.nlen+h.ndist){A.msg="invalid bit length repeat",h.mode=30;break}for(;K--;)h.lens[h.have++]=a}}if(h.mode===30)break;if(h.lens[256]===0){A.msg="invalid code -- missing end-of-block",h.mode=30;break}if(h.lenbits=9,j={bits:h.lenbits},H=_(b,h.lens,0,h.nlen,h.lencode,0,h.work,j),h.lenbits=j.bits,H){A.msg="invalid literal/lengths set",h.mode=30;break}if(h.distbits=6,h.distcode=h.distdyn,j={bits:h.distbits},H=_(v,h.lens,h.nlen,h.ndist,h.distcode,0,h.work,j),h.distbits=j.bits,H){A.msg="invalid distances set",h.mode=30;break}if(h.mode=20,z===6)break t;case 20:h.mode=21;case 21:if(6<=X&&258<=rt){A.next_out=st,A.avail_out=rt,A.next_in=W,A.avail_in=X,h.hold=U,h.bits=R,u(A,Q),st=A.next_out,it=A.output,rt=A.avail_out,W=A.next_in,q=A.input,X=A.avail_in,U=h.hold,R=h.bits,h.mode===12&&(h.back=-1);break}for(h.back=0;M=(w=h.lencode[U&(1<<h.lenbits)-1])>>>16&255,O=65535&w,!((c=w>>>24)<=R);){if(X===0)break t;X--,U+=q[W++]<<R,R+=8}if(M&&(240&M)==0){for(nt=c,lt=M,ut=O;M=(w=h.lencode[ut+((U&(1<<nt+lt)-1)>>nt)])>>>16&255,O=65535&w,!(nt+(c=w>>>24)<=R);){if(X===0)break t;X--,U+=q[W++]<<R,R+=8}U>>>=nt,R-=nt,h.back+=nt}if(U>>>=c,R-=c,h.back+=c,h.length=O,M===0){h.mode=26;break}if(32&M){h.back=-1,h.mode=12;break}if(64&M){A.msg="invalid literal/length code",h.mode=30;break}h.extra=15&M,h.mode=22;case 22:if(h.extra){for(x=h.extra;R<x;){if(X===0)break t;X--,U+=q[W++]<<R,R+=8}h.length+=U&(1<<h.extra)-1,U>>>=h.extra,R-=h.extra,h.back+=h.extra}h.was=h.length,h.mode=23;case 23:for(;M=(w=h.distcode[U&(1<<h.distbits)-1])>>>16&255,O=65535&w,!((c=w>>>24)<=R);){if(X===0)break t;X--,U+=q[W++]<<R,R+=8}if((240&M)==0){for(nt=c,lt=M,ut=O;M=(w=h.distcode[ut+((U&(1<<nt+lt)-1)>>nt)])>>>16&255,O=65535&w,!(nt+(c=w>>>24)<=R);){if(X===0)break t;X--,U+=q[W++]<<R,R+=8}U>>>=nt,R-=nt,h.back+=nt}if(U>>>=c,R-=c,h.back+=c,64&M){A.msg="invalid distance code",h.mode=30;break}h.offset=O,h.extra=15&M,h.mode=24;case 24:if(h.extra){for(x=h.extra;R<x;){if(X===0)break t;X--,U+=q[W++]<<R,R+=8}h.offset+=U&(1<<h.extra)-1,U>>>=h.extra,R-=h.extra,h.back+=h.extra}if(h.offset>h.dmax){A.msg="invalid distance too far back",h.mode=30;break}h.mode=25;case 25:if(rt===0)break t;if(K=Q-rt,h.offset>K){if((K=h.offset-K)>h.whave&&h.sane){A.msg="invalid distance too far back",h.mode=30;break}dt=K>h.wnext?(K-=h.wnext,h.wsize-K):h.wnext-K,K>h.length&&(K=h.length),g=h.window}else g=it,dt=st-h.offset,K=h.length;for(rt<K&&(K=rt),rt-=K,h.length-=K;it[st++]=g[dt++],--K;);h.length===0&&(h.mode=21);break;case 26:if(rt===0)break t;it[st++]=h.length,rt--,h.mode=21;break;case 27:if(h.wrap){for(;R<32;){if(X===0)break t;X--,U|=q[W++]<<R,R+=8}if(Q-=rt,A.total_out+=Q,h.total+=Q,Q&&(A.adler=h.check=h.flags?o(h.check,it,Q,st-Q):i(h.check,it,Q,st-Q)),Q=rt,(h.flags?U:l(U))!==h.check){A.msg="incorrect data check",h.mode=30;break}R=U=0}h.mode=28;case 28:if(h.wrap&&h.flags){for(;R<32;){if(X===0)break t;X--,U+=q[W++]<<R,R+=8}if(U!==(4294967295&h.total)){A.msg="incorrect length check",h.mode=30;break}R=U=0}h.mode=29;case 29:H=1;break t;case 30:H=-3;break t;case 31:return-4;case 32:default:return p}return A.next_out=st,A.avail_out=rt,A.next_in=W,A.avail_in=X,h.hold=U,h.bits=R,(h.wsize||Q!==A.avail_out&&h.mode<30&&(h.mode<27||z!==4))&&Z(A,A.output,A.next_out,Q-A.avail_out)?(h.mode=31,-4):(tt-=A.avail_in,Q-=A.avail_out,A.total_in+=tt,A.total_out+=Q,h.total+=Q,h.wrap&&Q&&(A.adler=h.check=h.flags?o(h.check,it,Q,A.next_out-Q):i(h.check,it,Q,A.next_out-Q)),A.data_type=h.bits+(h.last?64:0)+(h.mode===12?128:0)+(h.mode===20||h.mode===15?256:0),(tt==0&&Q===0||z===4)&&H===E&&(H=-5),H)},r.inflateEnd=function(A){if(!A||!A.state)return p;var z=A.state;return z.window&&(z.window=null),A.state=null,E},r.inflateGetHeader=function(A,z){var h;return A&&A.state?(2&(h=A.state).wrap)==0?p:((h.head=z).done=!1,E):p},r.inflateSetDictionary=function(A,z){var h,q=z.length;return A&&A.state?(h=A.state).wrap!==0&&h.mode!==11?p:h.mode===11&&i(1,z,q,0)!==h.check?-3:Z(A,z,q,q)?(h.mode=31,-4):(h.havedict=1,E):p},r.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(t,s,r){var n=t("../utils/common"),i=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],o=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],u=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],_=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];s.exports=function(b,v,E,p,k,d,T,l){var y,I,C,S,L,D,N,m,P,Z=l.bits,A=0,z=0,h=0,q=0,it=0,W=0,st=0,X=0,rt=0,U=0,R=null,tt=0,Q=new n.Buf16(16),K=new n.Buf16(16),dt=null,g=0;for(A=0;A<=15;A++)Q[A]=0;for(z=0;z<p;z++)Q[v[E+z]]++;for(it=Z,q=15;1<=q&&Q[q]===0;q--);if(q<it&&(it=q),q===0)return k[d++]=20971520,k[d++]=20971520,l.bits=1,0;for(h=1;h<q&&Q[h]===0;h++);for(it<h&&(it=h),A=X=1;A<=15;A++)if(X<<=1,(X-=Q[A])<0)return-1;if(0<X&&(b===0||q!==1))return-1;for(K[1]=0,A=1;A<15;A++)K[A+1]=K[A]+Q[A];for(z=0;z<p;z++)v[E+z]!==0&&(T[K[v[E+z]]++]=z);if(D=b===0?(R=dt=T,19):b===1?(R=i,tt-=257,dt=o,g-=257,256):(R=u,dt=_,-1),A=h,L=d,st=z=U=0,C=-1,S=(rt=1<<(W=it))-1,b===1&&852<rt||b===2&&592<rt)return 1;for(;;){for(N=A-st,P=T[z]<D?(m=0,T[z]):T[z]>D?(m=dt[g+T[z]],R[tt+T[z]]):(m=96,0),y=1<<A-st,h=I=1<<W;k[L+(U>>st)+(I-=y)]=N<<24|m<<16|P|0,I!==0;);for(y=1<<A-1;U&y;)y>>=1;if(y!==0?(U&=y-1,U+=y):U=0,z++,--Q[A]==0){if(A===q)break;A=v[E+T[z]]}if(it<A&&(U&S)!==C){for(st===0&&(st=it),L+=h,X=1<<(W=A-st);W+st<q&&!((X-=Q[W+st])<=0);)W++,X<<=1;if(rt+=1<<W,b===1&&852<rt||b===2&&592<rt)return 1;k[C=U&S]=it<<24|W<<16|L-d|0}}return U!==0&&(k[L+U]=A-st<<24|64<<16|0),l.bits=it,0}},{"../utils/common":41}],51:[function(t,s,r){s.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(t,s,r){var n=t("../utils/common"),i=0,o=1;function u(w){for(var F=w.length;0<=--F;)w[F]=0}var _=0,b=29,v=256,E=v+1+b,p=30,k=19,d=2*E+1,T=15,l=16,y=7,I=256,C=16,S=17,L=18,D=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],N=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],m=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],P=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Z=new Array(2*(E+2));u(Z);var A=new Array(2*p);u(A);var z=new Array(512);u(z);var h=new Array(256);u(h);var q=new Array(b);u(q);var it,W,st,X=new Array(p);function rt(w,F,V,G,B){this.static_tree=w,this.extra_bits=F,this.extra_base=V,this.elems=G,this.max_length=B,this.has_stree=w&&w.length}function U(w,F){this.dyn_tree=w,this.max_code=0,this.stat_desc=F}function R(w){return w<256?z[w]:z[256+(w>>>7)]}function tt(w,F){w.pending_buf[w.pending++]=255&F,w.pending_buf[w.pending++]=F>>>8&255}function Q(w,F,V){w.bi_valid>l-V?(w.bi_buf|=F<<w.bi_valid&65535,tt(w,w.bi_buf),w.bi_buf=F>>l-w.bi_valid,w.bi_valid+=V-l):(w.bi_buf|=F<<w.bi_valid&65535,w.bi_valid+=V)}function K(w,F,V){Q(w,V[2*F],V[2*F+1])}function dt(w,F){for(var V=0;V|=1&w,w>>>=1,V<<=1,0<--F;);return V>>>1}function g(w,F,V){var G,B,Y=new Array(T+1),J=0;for(G=1;G<=T;G++)Y[G]=J=J+V[G-1]<<1;for(B=0;B<=F;B++){var $=w[2*B+1];$!==0&&(w[2*B]=dt(Y[$]++,$))}}function c(w){var F;for(F=0;F<E;F++)w.dyn_ltree[2*F]=0;for(F=0;F<p;F++)w.dyn_dtree[2*F]=0;for(F=0;F<k;F++)w.bl_tree[2*F]=0;w.dyn_ltree[2*I]=1,w.opt_len=w.static_len=0,w.last_lit=w.matches=0}function M(w){8<w.bi_valid?tt(w,w.bi_buf):0<w.bi_valid&&(w.pending_buf[w.pending++]=w.bi_buf),w.bi_buf=0,w.bi_valid=0}function O(w,F,V,G){var B=2*F,Y=2*V;return w[B]<w[Y]||w[B]===w[Y]&&G[F]<=G[V]}function nt(w,F,V){for(var G=w.heap[V],B=V<<1;B<=w.heap_len&&(B<w.heap_len&&O(F,w.heap[B+1],w.heap[B],w.depth)&&B++,!O(F,G,w.heap[B],w.depth));)w.heap[V]=w.heap[B],V=B,B<<=1;w.heap[V]=G}function lt(w,F,V){var G,B,Y,J,$=0;if(w.last_lit!==0)for(;G=w.pending_buf[w.d_buf+2*$]<<8|w.pending_buf[w.d_buf+2*$+1],B=w.pending_buf[w.l_buf+$],$++,G===0?K(w,B,F):(K(w,(Y=h[B])+v+1,F),(J=D[Y])!==0&&Q(w,B-=q[Y],J),K(w,Y=R(--G),V),(J=N[Y])!==0&&Q(w,G-=X[Y],J)),$<w.last_lit;);K(w,I,F)}function ut(w,F){var V,G,B,Y=F.dyn_tree,J=F.stat_desc.static_tree,$=F.stat_desc.has_stree,et=F.stat_desc.elems,ht=-1;for(w.heap_len=0,w.heap_max=d,V=0;V<et;V++)Y[2*V]!==0?(w.heap[++w.heap_len]=ht=V,w.depth[V]=0):Y[2*V+1]=0;for(;w.heap_len<2;)Y[2*(B=w.heap[++w.heap_len]=ht<2?++ht:0)]=1,w.depth[B]=0,w.opt_len--,$&&(w.static_len-=J[2*B+1]);for(F.max_code=ht,V=w.heap_len>>1;1<=V;V--)nt(w,Y,V);for(B=et;V=w.heap[1],w.heap[1]=w.heap[w.heap_len--],nt(w,Y,1),G=w.heap[1],w.heap[--w.heap_max]=V,w.heap[--w.heap_max]=G,Y[2*B]=Y[2*V]+Y[2*G],w.depth[B]=(w.depth[V]>=w.depth[G]?w.depth[V]:w.depth[G])+1,Y[2*V+1]=Y[2*G+1]=B,w.heap[1]=B++,nt(w,Y,1),2<=w.heap_len;);w.heap[--w.heap_max]=w.heap[1],(function(at,vt){var Dt,wt,Lt,pt,Ut,Jt,Et=vt.dyn_tree,ge=vt.max_code,en=vt.stat_desc.static_tree,nn=vt.stat_desc.has_stree,rn=vt.stat_desc.extra_bits,ve=vt.stat_desc.extra_base,Pt=vt.stat_desc.max_length,Mt=0;for(pt=0;pt<=T;pt++)at.bl_count[pt]=0;for(Et[2*at.heap[at.heap_max]+1]=0,Dt=at.heap_max+1;Dt<d;Dt++)Pt<(pt=Et[2*Et[2*(wt=at.heap[Dt])+1]+1]+1)&&(pt=Pt,Mt++),Et[2*wt+1]=pt,ge<wt||(at.bl_count[pt]++,Ut=0,ve<=wt&&(Ut=rn[wt-ve]),Jt=Et[2*wt],at.opt_len+=Jt*(pt+Ut),nn&&(at.static_len+=Jt*(en[2*wt+1]+Ut)));if(Mt!==0){do{for(pt=Pt-1;at.bl_count[pt]===0;)pt--;at.bl_count[pt]--,at.bl_count[pt+1]+=2,at.bl_count[Pt]--,Mt-=2}while(0<Mt);for(pt=Pt;pt!==0;pt--)for(wt=at.bl_count[pt];wt!==0;)ge<(Lt=at.heap[--Dt])||(Et[2*Lt+1]!==pt&&(at.opt_len+=(pt-Et[2*Lt+1])*Et[2*Lt],Et[2*Lt+1]=pt),wt--)}})(w,F),g(Y,ht,w.bl_count)}function a(w,F,V){var G,B,Y=-1,J=F[1],$=0,et=7,ht=4;for(J===0&&(et=138,ht=3),F[2*(V+1)+1]=65535,G=0;G<=V;G++)B=J,J=F[2*(G+1)+1],++$<et&&B===J||($<ht?w.bl_tree[2*B]+=$:B!==0?(B!==Y&&w.bl_tree[2*B]++,w.bl_tree[2*C]++):$<=10?w.bl_tree[2*S]++:w.bl_tree[2*L]++,Y=B,ht=($=0)===J?(et=138,3):B===J?(et=6,3):(et=7,4))}function H(w,F,V){var G,B,Y=-1,J=F[1],$=0,et=7,ht=4;for(J===0&&(et=138,ht=3),G=0;G<=V;G++)if(B=J,J=F[2*(G+1)+1],!(++$<et&&B===J)){if($<ht)for(;K(w,B,w.bl_tree),--$!=0;);else B!==0?(B!==Y&&(K(w,B,w.bl_tree),$--),K(w,C,w.bl_tree),Q(w,$-3,2)):$<=10?(K(w,S,w.bl_tree),Q(w,$-3,3)):(K(w,L,w.bl_tree),Q(w,$-11,7));Y=B,ht=($=0)===J?(et=138,3):B===J?(et=6,3):(et=7,4)}}u(X);var j=!1;function x(w,F,V,G){Q(w,(_<<1)+(G?1:0),3),(function(B,Y,J,$){M(B),tt(B,J),tt(B,~J),n.arraySet(B.pending_buf,B.window,Y,J,B.pending),B.pending+=J})(w,F,V)}r._tr_init=function(w){j||((function(){var F,V,G,B,Y,J=new Array(T+1);for(B=G=0;B<b-1;B++)for(q[B]=G,F=0;F<1<<D[B];F++)h[G++]=B;for(h[G-1]=B,B=Y=0;B<16;B++)for(X[B]=Y,F=0;F<1<<N[B];F++)z[Y++]=B;for(Y>>=7;B<p;B++)for(X[B]=Y<<7,F=0;F<1<<N[B]-7;F++)z[256+Y++]=B;for(V=0;V<=T;V++)J[V]=0;for(F=0;F<=143;)Z[2*F+1]=8,F++,J[8]++;for(;F<=255;)Z[2*F+1]=9,F++,J[9]++;for(;F<=279;)Z[2*F+1]=7,F++,J[7]++;for(;F<=287;)Z[2*F+1]=8,F++,J[8]++;for(g(Z,E+1,J),F=0;F<p;F++)A[2*F+1]=5,A[2*F]=dt(F,5);it=new rt(Z,D,v+1,E,T),W=new rt(A,N,0,p,T),st=new rt(new Array(0),m,0,k,y)})(),j=!0),w.l_desc=new U(w.dyn_ltree,it),w.d_desc=new U(w.dyn_dtree,W),w.bl_desc=new U(w.bl_tree,st),w.bi_buf=0,w.bi_valid=0,c(w)},r._tr_stored_block=x,r._tr_flush_block=function(w,F,V,G){var B,Y,J=0;0<w.level?(w.strm.data_type===2&&(w.strm.data_type=(function($){var et,ht=4093624447;for(et=0;et<=31;et++,ht>>>=1)if(1&ht&&$.dyn_ltree[2*et]!==0)return i;if($.dyn_ltree[18]!==0||$.dyn_ltree[20]!==0||$.dyn_ltree[26]!==0)return o;for(et=32;et<v;et++)if($.dyn_ltree[2*et]!==0)return o;return i})(w)),ut(w,w.l_desc),ut(w,w.d_desc),J=(function($){var et;for(a($,$.dyn_ltree,$.l_desc.max_code),a($,$.dyn_dtree,$.d_desc.max_code),ut($,$.bl_desc),et=k-1;3<=et&&$.bl_tree[2*P[et]+1]===0;et--);return $.opt_len+=3*(et+1)+5+5+4,et})(w),B=w.opt_len+3+7>>>3,(Y=w.static_len+3+7>>>3)<=B&&(B=Y)):B=Y=V+5,V+4<=B&&F!==-1?x(w,F,V,G):w.strategy===4||Y===B?(Q(w,2+(G?1:0),3),lt(w,Z,A)):(Q(w,4+(G?1:0),3),(function($,et,ht,at){var vt;for(Q($,et-257,5),Q($,ht-1,5),Q($,at-4,4),vt=0;vt<at;vt++)Q($,$.bl_tree[2*P[vt]+1],3);H($,$.dyn_ltree,et-1),H($,$.dyn_dtree,ht-1)})(w,w.l_desc.max_code+1,w.d_desc.max_code+1,J+1),lt(w,w.dyn_ltree,w.dyn_dtree)),c(w),G&&M(w)},r._tr_tally=function(w,F,V){return w.pending_buf[w.d_buf+2*w.last_lit]=F>>>8&255,w.pending_buf[w.d_buf+2*w.last_lit+1]=255&F,w.pending_buf[w.l_buf+w.last_lit]=255&V,w.last_lit++,F===0?w.dyn_ltree[2*V]++:(w.matches++,F--,w.dyn_ltree[2*(h[V]+v+1)]++,w.dyn_dtree[2*R(F)]++),w.last_lit===w.lit_bufsize-1},r._tr_align=function(w){Q(w,2,3),K(w,I,Z),(function(F){F.bi_valid===16?(tt(F,F.bi_buf),F.bi_buf=0,F.bi_valid=0):8<=F.bi_valid&&(F.pending_buf[F.pending++]=255&F.bi_buf,F.bi_buf>>=8,F.bi_valid-=8)})(w)}},{"../utils/common":41}],53:[function(t,s,r){s.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(t,s,r){(function(n){(function(i,o){if(!i.setImmediate){var u,_,b,v,E=1,p={},k=!1,d=i.document,T=Object.getPrototypeOf&&Object.getPrototypeOf(i);T=T&&T.setTimeout?T:i,u={}.toString.call(i.process)==="[object process]"?function(C){process.nextTick(function(){y(C)})}:(function(){if(i.postMessage&&!i.importScripts){var C=!0,S=i.onmessage;return i.onmessage=function(){C=!1},i.postMessage("","*"),i.onmessage=S,C}})()?(v="setImmediate$"+Math.random()+"$",i.addEventListener?i.addEventListener("message",I,!1):i.attachEvent("onmessage",I),function(C){i.postMessage(v+C,"*")}):i.MessageChannel?((b=new MessageChannel).port1.onmessage=function(C){y(C.data)},function(C){b.port2.postMessage(C)}):d&&"onreadystatechange"in d.createElement("script")?(_=d.documentElement,function(C){var S=d.createElement("script");S.onreadystatechange=function(){y(C),S.onreadystatechange=null,_.removeChild(S),S=null},_.appendChild(S)}):function(C){setTimeout(y,0,C)},T.setImmediate=function(C){typeof C!="function"&&(C=new Function(""+C));for(var S=new Array(arguments.length-1),L=0;L<S.length;L++)S[L]=arguments[L+1];var D={callback:C,args:S};return p[E]=D,u(E),E++},T.clearImmediate=l}function l(C){delete p[C]}function y(C){if(k)setTimeout(y,0,C);else{var S=p[C];if(S){k=!0;try{(function(L){var D=L.callback,N=L.args;switch(N.length){case 0:D();break;case 1:D(N[0]);break;case 2:D(N[0],N[1]);break;case 3:D(N[0],N[1],N[2]);break;default:D.apply(o,N)}})(S)}finally{l(C),k=!1}}}}function I(C){C.source===i&&typeof C.data=="string"&&C.data.indexOf(v)===0&&y(+C.data.slice(v.length))}})(typeof self>"u"?n===void 0?this:n:self)}).call(this,typeof qt<"u"?qt:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(ee)),ee.exports}var Mn=Un();const Xe=pe(Mn);async function jn(f){let e;return f instanceof File||f instanceof Blob?e=await f.arrayBuffer():e=f,await Xe.loadAsync(e)}async function Hn(f){const e=f.file("META-INF/container.xml");if(!e)throw new Error("container.xml not found");const t=await e.async("text"),s=new DOMParser().parseFromString(t,"application/xml").querySelector("rootfile")?.getAttribute("full-path");if(!s)throw new Error("Rootfile path missing");return s}function Wn(f){const e=f.lastIndexOf("/");return e===-1?"":f.slice(0,e+1).replace(/\/+/g,"/")}async function qn(f,e){const t=f.file(e);if(!t)throw new Error(`OPF file not found: ${e}`);const s=await t.async("text"),r=new DOMParser().parseFromString(s,"application/xml"),n=r.querySelector("metadata"),i={};r.querySelectorAll("manifest > item").forEach(b=>{const v=b.getAttribute("id"),E=b.getAttribute("href"),p=b.getAttribute("media-type")||"";v&&E&&(i[v]={id:v,href:E,mediaType:p})});const o=e.substring(0,e.lastIndexOf("/")+1),u=n?.querySelector("meta[name='cover']")?.getAttribute("content");let _;return u&&i[u]&&(_=o+i[u].href),{title:n?.querySelector("title")?.textContent||void 0,author:n?.querySelector("creator")?.textContent||void 0,language:n?.querySelector("language")?.textContent||void 0,identifier:n?.querySelector("identifier")?.textContent||void 0,cover:_}}async function Vn(f,e){const t=f.file(e);if(!t)throw new Error(`OPF file not found: ${e}`);const s=await t.async("text"),r=new DOMParser().parseFromString(s,"application/xml"),n=await qn(f,e),i={};r.querySelectorAll("manifest > item").forEach(_=>{const b=_.getAttribute("id"),v=_.getAttribute("href"),E=_.getAttribute("media-type")||"";b&&v&&(i[b]={id:b,href:v,mediaType:E})});const o=Array.from(r.querySelectorAll("spine > itemref")).map(_=>_.getAttribute("idref")).filter(Boolean).map(_=>({idref:_})),u=Wn(e);return{metadata:n,manifest:i,spine:o,opfFolder:u}}function Ee(f){return(f.localName||f.tagName||"").toLowerCase()==="navpoint"}async function Gn(f,e){const{manifest:t,spine:s,opfFolder:r}=e,n=Object.values(t).find(o=>o.mediaType==="application/x-dtbncx+xml");if(n){let o=function(v){const E=Array.from(v),p=[];for(const k of E){if(!Ee(k))continue;const d=k.querySelector("navLabel > text"),T=k.querySelector("content"),l=(d?.textContent||"").trim(),y=T?.getAttribute("src")||"",I=Array.from(k.children).filter(Ee);p.push({title:l,href:y,children:I.length>0?o(I):void 0})}return p};const u=f.file(r+n.href);if(!u)return[];const _=await u.async("text"),b=new DOMParser().parseFromString(_,"application/xml").querySelectorAll("navMap > navPoint");return o(b)}const i=Object.values(t).find(o=>{if(!o.mediaType?.includes("xhtml"))return!1;const u=(o.properties||"").split(/\s+/).filter(Boolean);return u.includes("nav")||u.includes("toc")||o.properties==="nav"});if(i){let o=function(p){const k=Array.isArray(p)?p:Array.from(p),d=[];for(const T of k){const l=T;if(!l)continue;const y=l.querySelector("a")||l.querySelector("a[href]")||l.querySelector("[href]");if(!y)continue;const I=(y.textContent||"").trim(),C=y.getAttribute("href")||"",S=Array.from(l.children).find(D=>{const N=(D.localName||D.tagName||"").toLowerCase();return N==="ol"||N==="ul"}),L=S?Array.from(S.children):[];d.push({title:I,href:C,children:L.length>0?o(L):void 0})}return d};const u=f.file(r+i.href);if(!u)return[];const _=await u.async("text"),b=new DOMParser().parseFromString(_,"application/xhtml+xml"),v=b.querySelector('nav[epub\\:type="toc"]')||b.querySelector('nav[role="doc-toc"]')||b.querySelector('nav[type="toc"]')||b.querySelector("nav");if(!v)return[];const E=v.querySelector("ol, ul");return E?o(Array.from(E.children)):[]}return s.map(o=>({title:t[o.idref]?.id||o.idref,href:t[o.idref]?.href||""}))}async function Zn(f,e){if(!e)return null;const t=f.file(e);if(!t)return null;const s=await t.async("base64"),r=e.split(".").pop()?.toLowerCase();return`data:${r==="png"?"image/png":r==="gif"?"image/gif":"image/jpeg"};base64,${s}`}function Xn(f){const e=f.indexOf("#");return e===-1?{path:f}:{path:f.slice(0,e),fragment:decodeURIComponent(f.slice(e+1))}}function ke(f,e){const{path:t,fragment:s}=Xn(e),r="http://epub.local/"+(f?f.replace(/^\/+/,"").replace(/\/+$/,"")+"/":"");let n=new URL(t,r).pathname.replace(/^\/+/,"");return n=n.replace(/\/+/g,"/"),{normalized:n,fragment:s}}class Yn{metadata;chapters;resources;toc;opfFolder;manifest;zip;normalizedChapterMap=new Map;constructor(e,t){Object.defineProperty(this,"zip",{value:e,enumerable:!1,writable:!1}),this.metadata=t.metadata,this.chapters=t.chapters,this.resources=t.resources,this.toc=t.toc,this.opfFolder=t.opfFolder,this.manifest=t.manifest;const s=this.opfFolder??"";for(let r=0;r<this.chapters.length;r++){const n=this.chapters[r],{normalized:i}=ke(s,n.href);this.normalizedChapterMap.has(i)||this.normalizedChapterMap.set(i,r)}}async getCoverImageData(){return this.metadata.cover?Zn(this.zip,this.metadata.cover):null}getChapter(e){return typeof e=="number"?this.chapters[e]:this.chapters.find(t=>t.id===e)}resolveHref(e){const t=this.opfFolder??"",{normalized:s,fragment:r}=ke(t,e);return{chapterIndex:this.normalizedChapterMap.get(s),fragment:r,normalizedPath:s}}getChapterByHref(e){const{chapterIndex:t,fragment:s}=this.resolveHref(e);return t===void 0?{chapter:void 0,fragment:s}:{chapter:this.chapters[t],fragment:s}}async getFile(e){const t=this.zip.file(e);return t?await t.async("arraybuffer"):null}}async function $n(f){const e=await jn(f),t=await Hn(e),s=await Vn(e,t),{metadata:r,manifest:n,spine:i,opfFolder:o}=s,u=[];for(const E of i){const p=n[E.idref];if(!p)continue;const k=e.file(o+p.href);if(!k)continue;const d=await k.async("text");u.push({id:E.idref,title:p.id,content:d,href:p.href})}const _={};for(const E in n){const p=n[E];if(!p.mediaType.startsWith("image")&&p.mediaType!=="text/css")continue;const k=e.file(o+p.href);if(!k)continue;const d=await k.async(p.mediaType.startsWith("image")?"base64":"text");_[p.id]={id:p.id,type:p.mediaType,content:d}}const b=await Gn(e,s),v={metadata:r,chapters:u,resources:_,toc:b,opfFolder:s.opfFolder,manifest:n};return new Yn(e,v)}function Ye(f){try{const s=new DOMParser().parseFromString(f,"text/html").querySelector("body");[...s.getElementsByTagName("script")].forEach(o=>o.remove());let n=s.innerHTML;const i=s.id;if(i&&(n=`<div id="${i}">${n}</div>`),n.trim()===""){const o=f.match(/<body([^>]*>.*?)<\/body>/ms);o&&o[1]&&(n=`<div${o[1]}</div>`)}return n}catch(e){return alert(`Error sanitizing book's HTML: ${e}`),console.error(e),null}}async function Te(f){try{const e=await $n(f);let t=[];for(let r of e.chapters){const n=Ye(r.content);if(n===null){console.error("Tried to load null HTML");continue}t.push(n)}const s=document.createElement("div");return s.innerHTML=t.join(""),Jn(s),Kn(s,e),{pageTemp:s,langMeta:e.metadata.language||"",title:e.metadata.title||"",author:e.metadata.author||"",toc:e.toc}}catch(e){return console.error("Error in parseEpub",e),null}}function Kn(f,e){const t=Qn(e);Ce(f,e,t,"img","src"),Ce(f,e,t,"image","xlink:href")}function Qn(f){const e=new Map;for(let t of Object.values(f.manifest)){if(!t.mediaType.startsWith("image"))continue;const s=t.id,r=f.resources[s].content;if(!r)continue;const n=`data:${t.mediaType};base64,${r}`,i=f.resolveHref(t.href).normalizedPath;e.set(i,n)}return e}function Ce(f,e,t,s,r){const n=document.createTreeWalker(f,NodeFilter.SHOW_ELEMENT,{acceptNode:function(i){return i.tagName.toLowerCase()===s.toLocaleLowerCase()?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)try{const i=n.currentNode,o=i.getAttribute(r);if(!o)continue;let u=e.resolveHref(o).normalizedPath;const _=t.get(u);if(_!==void 0)i.setAttribute(r,_);else{const b=xe(u);for(const[v,E]of t){const p=xe(v);b===p&&i.setAttribute(r,E)}}}catch(i){console.warn("Exception in changeLinksToDataUrls",i)}}function xe(f){const e=f.split("/");return e.length<1?null:e.at(-1)}function Jn(f){const e=document.createTreeWalker(f,NodeFilter.SHOW_ELEMENT,{acceptNode:function(t){return t.tagName==="A"?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;e.nextNode();)try{const t=e.currentNode,s=t.getAttribute("href");if(!s||!s.includes("#"))continue;const r=$e(s);t.setAttribute("href",r)}catch(t){console.warn("Exception in fixIntraBookHrefs",t)}}function $e(f){return"#"+(f.split("#").at(-1)||"")}class tr{div=document.querySelector("#spinner-wrapper");show(){this.div.classList.add("visible")}hide(){this.div.classList.remove("visible")}}const Gt=new tr;function ce(f){if(f.langOverride!==null){const e=f.langOverride.trim();return zt(e)?e:Ae(f)}return Ae(f)}function Ae(f){return zt(f.langMeta)?f.langMeta:Ot()}var ne,Ie;function er(){if(Ie)return ne;Ie=1;function f(r){if(typeof r!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(r))}function e(r,n){for(var i="",o=0,u=-1,_=0,b,v=0;v<=r.length;++v){if(v<r.length)b=r.charCodeAt(v);else{if(b===47)break;b=47}if(b===47){if(!(u===v-1||_===1))if(u!==v-1&&_===2){if(i.length<2||o!==2||i.charCodeAt(i.length-1)!==46||i.charCodeAt(i.length-2)!==46){if(i.length>2){var E=i.lastIndexOf("/");if(E!==i.length-1){E===-1?(i="",o=0):(i=i.slice(0,E),o=i.length-1-i.lastIndexOf("/")),u=v,_=0;continue}}else if(i.length===2||i.length===1){i="",o=0,u=v,_=0;continue}}n&&(i.length>0?i+="/..":i="..",o=2)}else i.length>0?i+="/"+r.slice(u+1,v):i=r.slice(u+1,v),o=v-u-1;u=v,_=0}else b===46&&_!==-1?++_:_=-1}return i}function t(r,n){var i=n.dir||n.root,o=n.base||(n.name||"")+(n.ext||"");return i?i===n.root?i+o:i+r+o:o}var s={resolve:function(){for(var n="",i=!1,o,u=arguments.length-1;u>=-1&&!i;u--){var _;u>=0?_=arguments[u]:(o===void 0&&(o=process.cwd()),_=o),f(_),_.length!==0&&(n=_+"/"+n,i=_.charCodeAt(0)===47)}return n=e(n,!i),i?n.length>0?"/"+n:"/":n.length>0?n:"."},normalize:function(n){if(f(n),n.length===0)return".";var i=n.charCodeAt(0)===47,o=n.charCodeAt(n.length-1)===47;return n=e(n,!i),n.length===0&&!i&&(n="."),n.length>0&&o&&(n+="/"),i?"/"+n:n},isAbsolute:function(n){return f(n),n.length>0&&n.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var n,i=0;i<arguments.length;++i){var o=arguments[i];f(o),o.length>0&&(n===void 0?n=o:n+="/"+o)}return n===void 0?".":s.normalize(n)},relative:function(n,i){if(f(n),f(i),n===i||(n=s.resolve(n),i=s.resolve(i),n===i))return"";for(var o=1;o<n.length&&n.charCodeAt(o)===47;++o);for(var u=n.length,_=u-o,b=1;b<i.length&&i.charCodeAt(b)===47;++b);for(var v=i.length,E=v-b,p=_<E?_:E,k=-1,d=0;d<=p;++d){if(d===p){if(E>p){if(i.charCodeAt(b+d)===47)return i.slice(b+d+1);if(d===0)return i.slice(b+d)}else _>p&&(n.charCodeAt(o+d)===47?k=d:d===0&&(k=0));break}var T=n.charCodeAt(o+d),l=i.charCodeAt(b+d);if(T!==l)break;T===47&&(k=d)}var y="";for(d=o+k+1;d<=u;++d)(d===u||n.charCodeAt(d)===47)&&(y.length===0?y+="..":y+="/..");return y.length>0?y+i.slice(b+k):(b+=k,i.charCodeAt(b)===47&&++b,i.slice(b))},_makeLong:function(n){return n},dirname:function(n){if(f(n),n.length===0)return".";for(var i=n.charCodeAt(0),o=i===47,u=-1,_=!0,b=n.length-1;b>=1;--b)if(i=n.charCodeAt(b),i===47){if(!_){u=b;break}}else _=!1;return u===-1?o?"/":".":o&&u===1?"//":n.slice(0,u)},basename:function(n,i){if(i!==void 0&&typeof i!="string")throw new TypeError('"ext" argument must be a string');f(n);var o=0,u=-1,_=!0,b;if(i!==void 0&&i.length>0&&i.length<=n.length){if(i.length===n.length&&i===n)return"";var v=i.length-1,E=-1;for(b=n.length-1;b>=0;--b){var p=n.charCodeAt(b);if(p===47){if(!_){o=b+1;break}}else E===-1&&(_=!1,E=b+1),v>=0&&(p===i.charCodeAt(v)?--v===-1&&(u=b):(v=-1,u=E))}return o===u?u=E:u===-1&&(u=n.length),n.slice(o,u)}else{for(b=n.length-1;b>=0;--b)if(n.charCodeAt(b)===47){if(!_){o=b+1;break}}else u===-1&&(_=!1,u=b+1);return u===-1?"":n.slice(o,u)}},extname:function(n){f(n);for(var i=-1,o=0,u=-1,_=!0,b=0,v=n.length-1;v>=0;--v){var E=n.charCodeAt(v);if(E===47){if(!_){o=v+1;break}continue}u===-1&&(_=!1,u=v+1),E===46?i===-1?i=v:b!==1&&(b=1):i!==-1&&(b=-1)}return i===-1||u===-1||b===0||b===1&&i===u-1&&i===o+1?"":n.slice(i,u)},format:function(n){if(n===null||typeof n!="object")throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof n);return t("/",n)},parse:function(n){f(n);var i={root:"",dir:"",base:"",ext:"",name:""};if(n.length===0)return i;var o=n.charCodeAt(0),u=o===47,_;u?(i.root="/",_=1):_=0;for(var b=-1,v=0,E=-1,p=!0,k=n.length-1,d=0;k>=_;--k){if(o=n.charCodeAt(k),o===47){if(!p){v=k+1;break}continue}E===-1&&(p=!1,E=k+1),o===46?b===-1?b=k:d!==1&&(d=1):b!==-1&&(d=-1)}return b===-1||E===-1||d===0||d===1&&b===E-1&&b===v+1?E!==-1&&(v===0&&u?i.base=i.name=n.slice(1,E):i.base=i.name=n.slice(v,E)):(v===0&&u?(i.name=n.slice(1,b),i.base=n.slice(1,E)):(i.name=n.slice(v,b),i.base=n.slice(v,E)),i.ext=n.slice(b,E)),v>0?i.dir=n.slice(0,v-1):u&&(i.dir="/"),i},sep:"/",delimiter:":",win32:null,posix:null};return s.posix=s,ne=s,ne}er();var Zt={exports:{}},Ne;function nr(){if(Ne)return Zt.exports;Ne=1;var f=typeof Reflect=="object"?Reflect:null,e=f&&typeof f.apply=="function"?f.apply:function(S,L,D){return Function.prototype.apply.call(S,L,D)},t;f&&typeof f.ownKeys=="function"?t=f.ownKeys:Object.getOwnPropertySymbols?t=function(S){return Object.getOwnPropertyNames(S).concat(Object.getOwnPropertySymbols(S))}:t=function(S){return Object.getOwnPropertyNames(S)};function s(C){console&&console.warn&&console.warn(C)}var r=Number.isNaN||function(S){return S!==S};function n(){n.init.call(this)}Zt.exports=n,Zt.exports.once=l,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._eventsCount=0,n.prototype._maxListeners=void 0;var i=10;function o(C){if(typeof C!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof C)}Object.defineProperty(n,"defaultMaxListeners",{enumerable:!0,get:function(){return i},set:function(C){if(typeof C!="number"||C<0||r(C))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+C+".");i=C}}),n.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},n.prototype.setMaxListeners=function(S){if(typeof S!="number"||S<0||r(S))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+S+".");return this._maxListeners=S,this};function u(C){return C._maxListeners===void 0?n.defaultMaxListeners:C._maxListeners}n.prototype.getMaxListeners=function(){return u(this)},n.prototype.emit=function(S){for(var L=[],D=1;D<arguments.length;D++)L.push(arguments[D]);var N=S==="error",m=this._events;if(m!==void 0)N=N&&m.error===void 0;else if(!N)return!1;if(N){var P;if(L.length>0&&(P=L[0]),P instanceof Error)throw P;var Z=new Error("Unhandled error."+(P?" ("+P.message+")":""));throw Z.context=P,Z}var A=m[S];if(A===void 0)return!1;if(typeof A=="function")e(A,this,L);else for(var z=A.length,h=k(A,z),D=0;D<z;++D)e(h[D],this,L);return!0};function _(C,S,L,D){var N,m,P;if(o(L),m=C._events,m===void 0?(m=C._events=Object.create(null),C._eventsCount=0):(m.newListener!==void 0&&(C.emit("newListener",S,L.listener?L.listener:L),m=C._events),P=m[S]),P===void 0)P=m[S]=L,++C._eventsCount;else if(typeof P=="function"?P=m[S]=D?[L,P]:[P,L]:D?P.unshift(L):P.push(L),N=u(C),N>0&&P.length>N&&!P.warned){P.warned=!0;var Z=new Error("Possible EventEmitter memory leak detected. "+P.length+" "+String(S)+" listeners added. Use emitter.setMaxListeners() to increase limit");Z.name="MaxListenersExceededWarning",Z.emitter=C,Z.type=S,Z.count=P.length,s(Z)}return C}n.prototype.addListener=function(S,L){return _(this,S,L,!1)},n.prototype.on=n.prototype.addListener,n.prototype.prependListener=function(S,L){return _(this,S,L,!0)};function b(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function v(C,S,L){var D={fired:!1,wrapFn:void 0,target:C,type:S,listener:L},N=b.bind(D);return N.listener=L,D.wrapFn=N,N}n.prototype.once=function(S,L){return o(L),this.on(S,v(this,S,L)),this},n.prototype.prependOnceListener=function(S,L){return o(L),this.prependListener(S,v(this,S,L)),this},n.prototype.removeListener=function(S,L){var D,N,m,P,Z;if(o(L),N=this._events,N===void 0)return this;if(D=N[S],D===void 0)return this;if(D===L||D.listener===L)--this._eventsCount===0?this._events=Object.create(null):(delete N[S],N.removeListener&&this.emit("removeListener",S,D.listener||L));else if(typeof D!="function"){for(m=-1,P=D.length-1;P>=0;P--)if(D[P]===L||D[P].listener===L){Z=D[P].listener,m=P;break}if(m<0)return this;m===0?D.shift():d(D,m),D.length===1&&(N[S]=D[0]),N.removeListener!==void 0&&this.emit("removeListener",S,Z||L)}return this},n.prototype.off=n.prototype.removeListener,n.prototype.removeAllListeners=function(S){var L,D,N;if(D=this._events,D===void 0)return this;if(D.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):D[S]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete D[S]),this;if(arguments.length===0){var m=Object.keys(D),P;for(N=0;N<m.length;++N)P=m[N],P!=="removeListener"&&this.removeAllListeners(P);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(L=D[S],typeof L=="function")this.removeListener(S,L);else if(L!==void 0)for(N=L.length-1;N>=0;N--)this.removeListener(S,L[N]);return this};function E(C,S,L){var D=C._events;if(D===void 0)return[];var N=D[S];return N===void 0?[]:typeof N=="function"?L?[N.listener||N]:[N]:L?T(N):k(N,N.length)}n.prototype.listeners=function(S){return E(this,S,!0)},n.prototype.rawListeners=function(S){return E(this,S,!1)},n.listenerCount=function(C,S){return typeof C.listenerCount=="function"?C.listenerCount(S):p.call(C,S)},n.prototype.listenerCount=p;function p(C){var S=this._events;if(S!==void 0){var L=S[C];if(typeof L=="function")return 1;if(L!==void 0)return L.length}return 0}n.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]};function k(C,S){for(var L=new Array(S),D=0;D<S;++D)L[D]=C[D];return L}function d(C,S){for(;S+1<C.length;S++)C[S]=C[S+1];C.pop()}function T(C){for(var S=new Array(C.length),L=0;L<S.length;++L)S[L]=C[L].listener||C[L];return S}function l(C,S){return new Promise(function(L,D){function N(P){C.removeListener(S,m),D(P)}function m(){typeof C.removeListener=="function"&&C.removeListener("error",N),L([].slice.call(arguments))}I(C,S,m,{once:!0}),S!=="error"&&y(C,N,{once:!0})})}function y(C,S,L){typeof C.on=="function"&&I(C,"error",S,L)}function I(C,S,L,D){if(typeof C.on=="function")D.once?C.once(S,L):C.on(S,L);else if(typeof C.addEventListener=="function")C.addEventListener(S,function N(m){D.once&&C.removeEventListener(S,N),L(m)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof C)}return Zt.exports}var rr=nr(),re={};const ir={},sr=Object.freeze(Object.defineProperty({__proto__:null,default:ir},Symbol.toStringTag,{value:"Module"})),Ke=On(sr);var ie={},Xt={exports:{}},Oe;function or(){return Oe||(Oe=1,(function(f,e){var t=Ke,s=t.Buffer;function r(i,o){for(var u in i)o[u]=i[u]}s.from&&s.alloc&&s.allocUnsafe&&s.allocUnsafeSlow?f.exports=t:(r(t,e),e.Buffer=n);function n(i,o,u){return s(i,o,u)}r(s,n),n.from=function(i,o,u){if(typeof i=="number")throw new TypeError("Argument must not be a number");return s(i,o,u)},n.alloc=function(i,o,u){if(typeof i!="number")throw new TypeError("Argument must be a number");var _=s(i);return o!==void 0?typeof u=="string"?_.fill(o,u):_.fill(o):_.fill(0),_},n.allocUnsafe=function(i){if(typeof i!="number")throw new TypeError("Argument must be a number");return s(i)},n.allocUnsafeSlow=function(i){if(typeof i!="number")throw new TypeError("Argument must be a number");return t.SlowBuffer(i)}})(Xt,Xt.exports)),Xt.exports}var De;function ar(){if(De)return ie;De=1;var f=or().Buffer,e=f.isEncoding||function(l){switch(l=""+l,l&&l.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function t(l){if(!l)return"utf8";for(var y;;)switch(l){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return l;default:if(y)return;l=(""+l).toLowerCase(),y=!0}}function s(l){var y=t(l);if(typeof y!="string"&&(f.isEncoding===e||!e(l)))throw new Error("Unknown encoding: "+l);return y||l}ie.StringDecoder=r;function r(l){this.encoding=s(l);var y;switch(this.encoding){case"utf16le":this.text=v,this.end=E,y=4;break;case"utf8":this.fillLast=u,y=4;break;case"base64":this.text=p,this.end=k,y=3;break;default:this.write=d,this.end=T;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=f.allocUnsafe(y)}r.prototype.write=function(l){if(l.length===0)return"";var y,I;if(this.lastNeed){if(y=this.fillLast(l),y===void 0)return"";I=this.lastNeed,this.lastNeed=0}else I=0;return I<l.length?y?y+this.text(l,I):this.text(l,I):y||""},r.prototype.end=b,r.prototype.text=_,r.prototype.fillLast=function(l){if(this.lastNeed<=l.length)return l.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);l.copy(this.lastChar,this.lastTotal-this.lastNeed,0,l.length),this.lastNeed-=l.length};function n(l){return l<=127?0:l>>5===6?2:l>>4===14?3:l>>3===30?4:l>>6===2?-1:-2}function i(l,y,I){var C=y.length-1;if(C<I)return 0;var S=n(y[C]);return S>=0?(S>0&&(l.lastNeed=S-1),S):--C<I||S===-2?0:(S=n(y[C]),S>=0?(S>0&&(l.lastNeed=S-2),S):--C<I||S===-2?0:(S=n(y[C]),S>=0?(S>0&&(S===2?S=0:l.lastNeed=S-3),S):0))}function o(l,y,I){if((y[0]&192)!==128)return l.lastNeed=0,"�";if(l.lastNeed>1&&y.length>1){if((y[1]&192)!==128)return l.lastNeed=1,"�";if(l.lastNeed>2&&y.length>2&&(y[2]&192)!==128)return l.lastNeed=2,"�"}}function u(l){var y=this.lastTotal-this.lastNeed,I=o(this,l);if(I!==void 0)return I;if(this.lastNeed<=l.length)return l.copy(this.lastChar,y,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);l.copy(this.lastChar,y,0,l.length),this.lastNeed-=l.length}function _(l,y){var I=i(this,l,y);if(!this.lastNeed)return l.toString("utf8",y);this.lastTotal=I;var C=l.length-(I-this.lastNeed);return l.copy(this.lastChar,0,C),l.toString("utf8",y,C)}function b(l){var y=l&&l.length?this.write(l):"";return this.lastNeed?y+"�":y}function v(l,y){if((l.length-y)%2===0){var I=l.toString("utf16le",y);if(I){var C=I.charCodeAt(I.length-1);if(C>=55296&&C<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=l[l.length-2],this.lastChar[1]=l[l.length-1],I.slice(0,-1)}return I}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=l[l.length-1],l.toString("utf16le",y,l.length-1)}function E(l){var y=l&&l.length?this.write(l):"";if(this.lastNeed){var I=this.lastTotal-this.lastNeed;return y+this.lastChar.toString("utf16le",0,I)}return y}function p(l,y){var I=(l.length-y)%3;return I===0?l.toString("base64",y):(this.lastNeed=3-I,this.lastTotal=3,I===1?this.lastChar[0]=l[l.length-1]:(this.lastChar[0]=l[l.length-2],this.lastChar[1]=l[l.length-1]),l.toString("base64",y,l.length-I))}function k(l){var y=l&&l.length?this.write(l):"";return this.lastNeed?y+this.lastChar.toString("base64",0,3-this.lastNeed):y}function d(l){return l.toString(this.encoding)}function T(l){return l&&l.length?this.write(l):""}return ie}var Le;function cr(){return Le||(Le=1,(function(f){(function(e){e.parser=function(g,c){return new s(g,c)},e.SAXParser=s,e.SAXStream=b,e.createStream=_,e.MAX_BUFFER_LENGTH=64*1024;var t=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];e.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"];function s(g,c){if(!(this instanceof s))return new s(g,c);var M=this;n(M),M.q=M.c="",M.bufferCheckPosition=e.MAX_BUFFER_LENGTH,M.opt=c||{},M.opt.lowercase=M.opt.lowercase||M.opt.lowercasetags,M.looseCase=M.opt.lowercase?"toLowerCase":"toUpperCase",M.tags=[],M.closed=M.closedRoot=M.sawRoot=!1,M.tag=M.error=null,M.strict=!!g,M.noscript=!!(g||M.opt.noscript),M.state=m.BEGIN,M.strictEntities=M.opt.strictEntities,M.ENTITIES=M.strictEntities?Object.create(e.XML_ENTITIES):Object.create(e.ENTITIES),M.attribList=[],M.opt.xmlns&&(M.ns=Object.create(d)),M.opt.unquotedAttributeValues===void 0&&(M.opt.unquotedAttributeValues=!g),M.trackPosition=M.opt.position!==!1,M.trackPosition&&(M.position=M.line=M.column=0),Z(M,"onready")}Object.create||(Object.create=function(g){function c(){}c.prototype=g;var M=new c;return M}),Object.keys||(Object.keys=function(g){var c=[];for(var M in g)g.hasOwnProperty(M)&&c.push(M);return c});function r(g){for(var c=Math.max(e.MAX_BUFFER_LENGTH,10),M=0,O=0,nt=t.length;O<nt;O++){var lt=g[t[O]].length;if(lt>c)switch(t[O]){case"textNode":z(g);break;case"cdata":A(g,"oncdata",g.cdata),g.cdata="";break;case"script":A(g,"onscript",g.script),g.script="";break;default:q(g,"Max buffer length exceeded: "+t[O])}M=Math.max(M,lt)}var ut=e.MAX_BUFFER_LENGTH-M;g.bufferCheckPosition=ut+g.position}function n(g){for(var c=0,M=t.length;c<M;c++)g[t[c]]=""}function i(g){z(g),g.cdata!==""&&(A(g,"oncdata",g.cdata),g.cdata=""),g.script!==""&&(A(g,"onscript",g.script),g.script="")}s.prototype={end:function(){it(this)},write:dt,resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){i(this)}};var o;try{o=Ke.Stream}catch{o=function(){}}o||(o=function(){});var u=e.EVENTS.filter(function(g){return g!=="error"&&g!=="end"});function _(g,c){return new b(g,c)}function b(g,c){if(!(this instanceof b))return new b(g,c);o.apply(this),this._parser=new s(g,c),this.writable=!0,this.readable=!0;var M=this;this._parser.onend=function(){M.emit("end")},this._parser.onerror=function(O){M.emit("error",O),M._parser.error=null},this._decoder=null,u.forEach(function(O){Object.defineProperty(M,"on"+O,{get:function(){return M._parser["on"+O]},set:function(nt){if(!nt)return M.removeAllListeners(O),M._parser["on"+O]=nt,nt;M.on(O,nt)},enumerable:!0,configurable:!1})})}b.prototype=Object.create(o.prototype,{constructor:{value:b}}),b.prototype.write=function(g){if(typeof Buffer=="function"&&typeof Buffer.isBuffer=="function"&&Buffer.isBuffer(g)){if(!this._decoder){var c=ar().StringDecoder;this._decoder=new c("utf8")}g=this._decoder.write(g)}return this._parser.write(g.toString()),this.emit("data",g),!0},b.prototype.end=function(g){return g&&g.length&&this.write(g),this._parser.end(),!0},b.prototype.on=function(g,c){var M=this;return!M._parser["on"+g]&&u.indexOf(g)!==-1&&(M._parser["on"+g]=function(){var O=arguments.length===1?[arguments[0]]:Array.apply(null,arguments);O.splice(0,0,g),M.emit.apply(M,O)}),o.prototype.on.call(M,g,c)};var v="[CDATA[",E="DOCTYPE",p="http://www.w3.org/XML/1998/namespace",k="http://www.w3.org/2000/xmlns/",d={xml:p,xmlns:k},T=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,l=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/,y=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,I=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/;function C(g){return g===" "||g===`
`||g==="\r"||g==="	"}function S(g){return g==='"'||g==="'"}function L(g){return g===">"||C(g)}function D(g,c){return g.test(c)}function N(g,c){return!D(g,c)}var m=0;e.STATE={BEGIN:m++,BEGIN_WHITESPACE:m++,TEXT:m++,TEXT_ENTITY:m++,OPEN_WAKA:m++,SGML_DECL:m++,SGML_DECL_QUOTED:m++,DOCTYPE:m++,DOCTYPE_QUOTED:m++,DOCTYPE_DTD:m++,DOCTYPE_DTD_QUOTED:m++,COMMENT_STARTING:m++,COMMENT:m++,COMMENT_ENDING:m++,COMMENT_ENDED:m++,CDATA:m++,CDATA_ENDING:m++,CDATA_ENDING_2:m++,PROC_INST:m++,PROC_INST_BODY:m++,PROC_INST_ENDING:m++,OPEN_TAG:m++,OPEN_TAG_SLASH:m++,ATTRIB:m++,ATTRIB_NAME:m++,ATTRIB_NAME_SAW_WHITE:m++,ATTRIB_VALUE:m++,ATTRIB_VALUE_QUOTED:m++,ATTRIB_VALUE_CLOSED:m++,ATTRIB_VALUE_UNQUOTED:m++,ATTRIB_VALUE_ENTITY_Q:m++,ATTRIB_VALUE_ENTITY_U:m++,CLOSE_TAG:m++,CLOSE_TAG_SAW_WHITE:m++,SCRIPT:m++,SCRIPT_ENDING:m++},e.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},e.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(e.ENTITIES).forEach(function(g){var c=e.ENTITIES[g],M=typeof c=="number"?String.fromCharCode(c):c;e.ENTITIES[g]=M});for(var P in e.STATE)e.STATE[e.STATE[P]]=P;m=e.STATE;function Z(g,c,M){g[c]&&g[c](M)}function A(g,c,M){g.textNode&&z(g),Z(g,c,M)}function z(g){g.textNode=h(g.opt,g.textNode),g.textNode&&Z(g,"ontext",g.textNode),g.textNode=""}function h(g,c){return g.trim&&(c=c.trim()),g.normalize&&(c=c.replace(/\s+/g," ")),c}function q(g,c){return z(g),g.trackPosition&&(c+=`
Line: `+g.line+`
Column: `+g.column+`
Char: `+g.c),c=new Error(c),g.error=c,Z(g,"onerror",c),g}function it(g){return g.sawRoot&&!g.closedRoot&&W(g,"Unclosed root tag"),g.state!==m.BEGIN&&g.state!==m.BEGIN_WHITESPACE&&g.state!==m.TEXT&&q(g,"Unexpected end"),z(g),g.c="",g.closed=!0,Z(g,"onend"),s.call(g,g.strict,g.opt),g}function W(g,c){if(typeof g!="object"||!(g instanceof s))throw new Error("bad call to strictFail");g.strict&&q(g,c)}function st(g){g.strict||(g.tagName=g.tagName[g.looseCase]());var c=g.tags[g.tags.length-1]||g,M=g.tag={name:g.tagName,attributes:{}};g.opt.xmlns&&(M.ns=c.ns),g.attribList.length=0,A(g,"onopentagstart",M)}function X(g,c){var M=g.indexOf(":"),O=M<0?["",g]:g.split(":"),nt=O[0],lt=O[1];return c&&g==="xmlns"&&(nt="xmlns",lt=""),{prefix:nt,local:lt}}function rt(g){if(g.strict||(g.attribName=g.attribName[g.looseCase]()),g.attribList.indexOf(g.attribName)!==-1||g.tag.attributes.hasOwnProperty(g.attribName)){g.attribName=g.attribValue="";return}if(g.opt.xmlns){var c=X(g.attribName,!0),M=c.prefix,O=c.local;if(M==="xmlns")if(O==="xml"&&g.attribValue!==p)W(g,"xml: prefix must be bound to "+p+`
Actual: `+g.attribValue);else if(O==="xmlns"&&g.attribValue!==k)W(g,"xmlns: prefix must be bound to "+k+`
Actual: `+g.attribValue);else{var nt=g.tag,lt=g.tags[g.tags.length-1]||g;nt.ns===lt.ns&&(nt.ns=Object.create(lt.ns)),nt.ns[O]=g.attribValue}g.attribList.push([g.attribName,g.attribValue])}else g.tag.attributes[g.attribName]=g.attribValue,A(g,"onattribute",{name:g.attribName,value:g.attribValue});g.attribName=g.attribValue=""}function U(g,c){if(g.opt.xmlns){var M=g.tag,O=X(g.tagName);M.prefix=O.prefix,M.local=O.local,M.uri=M.ns[O.prefix]||"",M.prefix&&!M.uri&&(W(g,"Unbound namespace prefix: "+JSON.stringify(g.tagName)),M.uri=O.prefix);var nt=g.tags[g.tags.length-1]||g;M.ns&&nt.ns!==M.ns&&Object.keys(M.ns).forEach(function(B){A(g,"onopennamespace",{prefix:B,uri:M.ns[B]})});for(var lt=0,ut=g.attribList.length;lt<ut;lt++){var a=g.attribList[lt],H=a[0],j=a[1],x=X(H,!0),w=x.prefix,F=x.local,V=w===""?"":M.ns[w]||"",G={name:H,value:j,prefix:w,local:F,uri:V};w&&w!=="xmlns"&&!V&&(W(g,"Unbound namespace prefix: "+JSON.stringify(w)),G.uri=w),g.tag.attributes[H]=G,A(g,"onattribute",G)}g.attribList.length=0}g.tag.isSelfClosing=!!c,g.sawRoot=!0,g.tags.push(g.tag),A(g,"onopentag",g.tag),c||(!g.noscript&&g.tagName.toLowerCase()==="script"?g.state=m.SCRIPT:g.state=m.TEXT,g.tag=null,g.tagName=""),g.attribName=g.attribValue="",g.attribList.length=0}function R(g){if(!g.tagName){W(g,"Weird empty close tag."),g.textNode+="</>",g.state=m.TEXT;return}if(g.script){if(g.tagName!=="script"){g.script+="</"+g.tagName+">",g.tagName="",g.state=m.SCRIPT;return}A(g,"onscript",g.script),g.script=""}var c=g.tags.length,M=g.tagName;g.strict||(M=M[g.looseCase]());for(var O=M;c--;){var nt=g.tags[c];if(nt.name!==O)W(g,"Unexpected close tag");else break}if(c<0){W(g,"Unmatched closing tag: "+g.tagName),g.textNode+="</"+g.tagName+">",g.state=m.TEXT;return}g.tagName=M;for(var lt=g.tags.length;lt-- >c;){var ut=g.tag=g.tags.pop();g.tagName=g.tag.name,A(g,"onclosetag",g.tagName);var a={};for(var H in ut.ns)a[H]=ut.ns[H];var j=g.tags[g.tags.length-1]||g;g.opt.xmlns&&ut.ns!==j.ns&&Object.keys(ut.ns).forEach(function(x){var w=ut.ns[x];A(g,"onclosenamespace",{prefix:x,uri:w})})}c===0&&(g.closedRoot=!0),g.tagName=g.attribValue=g.attribName="",g.attribList.length=0,g.state=m.TEXT}function tt(g){var c=g.entity,M=c.toLowerCase(),O,nt="";return g.ENTITIES[c]?g.ENTITIES[c]:g.ENTITIES[M]?g.ENTITIES[M]:(c=M,c.charAt(0)==="#"&&(c.charAt(1)==="x"?(c=c.slice(2),O=parseInt(c,16),nt=O.toString(16)):(c=c.slice(1),O=parseInt(c,10),nt=O.toString(10))),c=c.replace(/^0+/,""),isNaN(O)||nt.toLowerCase()!==c||O<0||O>1114111?(W(g,"Invalid character entity"),"&"+g.entity+";"):String.fromCodePoint(O))}function Q(g,c){c==="<"?(g.state=m.OPEN_WAKA,g.startTagPosition=g.position):C(c)||(W(g,"Non-whitespace before first tag."),g.textNode=c,g.state=m.TEXT)}function K(g,c){var M="";return c<g.length&&(M=g.charAt(c)),M}function dt(g){var c=this;if(this.error)throw this.error;if(c.closed)return q(c,"Cannot write after close. Assign an onready handler.");if(g===null)return it(c);typeof g=="object"&&(g=g.toString());for(var M=0,O="";O=K(g,M++),c.c=O,!!O;)switch(c.trackPosition&&(c.position++,O===`
`?(c.line++,c.column=0):c.column++),c.state){case m.BEGIN:if(c.state=m.BEGIN_WHITESPACE,O==="\uFEFF")continue;Q(c,O);continue;case m.BEGIN_WHITESPACE:Q(c,O);continue;case m.TEXT:if(c.sawRoot&&!c.closedRoot){for(var lt=M-1;O&&O!=="<"&&O!=="&";)O=K(g,M++),O&&c.trackPosition&&(c.position++,O===`
`?(c.line++,c.column=0):c.column++);c.textNode+=g.substring(lt,M-1)}O==="<"&&!(c.sawRoot&&c.closedRoot&&!c.strict)?(c.state=m.OPEN_WAKA,c.startTagPosition=c.position):(!C(O)&&(!c.sawRoot||c.closedRoot)&&W(c,"Text data outside of root node."),O==="&"?c.state=m.TEXT_ENTITY:c.textNode+=O);continue;case m.SCRIPT:O==="<"?c.state=m.SCRIPT_ENDING:c.script+=O;continue;case m.SCRIPT_ENDING:O==="/"?c.state=m.CLOSE_TAG:(c.script+="<"+O,c.state=m.SCRIPT);continue;case m.OPEN_WAKA:if(O==="!")c.state=m.SGML_DECL,c.sgmlDecl="";else if(!C(O))if(D(T,O))c.state=m.OPEN_TAG,c.tagName=O;else if(O==="/")c.state=m.CLOSE_TAG,c.tagName="";else if(O==="?")c.state=m.PROC_INST,c.procInstName=c.procInstBody="";else{if(W(c,"Unencoded <"),c.startTagPosition+1<c.position){var nt=c.position-c.startTagPosition;O=new Array(nt).join(" ")+O}c.textNode+="<"+O,c.state=m.TEXT}continue;case m.SGML_DECL:if(c.sgmlDecl+O==="--"){c.state=m.COMMENT,c.comment="",c.sgmlDecl="";continue}c.doctype&&c.doctype!==!0&&c.sgmlDecl?(c.state=m.DOCTYPE_DTD,c.doctype+="<!"+c.sgmlDecl+O,c.sgmlDecl=""):(c.sgmlDecl+O).toUpperCase()===v?(A(c,"onopencdata"),c.state=m.CDATA,c.sgmlDecl="",c.cdata=""):(c.sgmlDecl+O).toUpperCase()===E?(c.state=m.DOCTYPE,(c.doctype||c.sawRoot)&&W(c,"Inappropriately located doctype declaration"),c.doctype="",c.sgmlDecl=""):O===">"?(A(c,"onsgmldeclaration",c.sgmlDecl),c.sgmlDecl="",c.state=m.TEXT):(S(O)&&(c.state=m.SGML_DECL_QUOTED),c.sgmlDecl+=O);continue;case m.SGML_DECL_QUOTED:O===c.q&&(c.state=m.SGML_DECL,c.q=""),c.sgmlDecl+=O;continue;case m.DOCTYPE:O===">"?(c.state=m.TEXT,A(c,"ondoctype",c.doctype),c.doctype=!0):(c.doctype+=O,O==="["?c.state=m.DOCTYPE_DTD:S(O)&&(c.state=m.DOCTYPE_QUOTED,c.q=O));continue;case m.DOCTYPE_QUOTED:c.doctype+=O,O===c.q&&(c.q="",c.state=m.DOCTYPE);continue;case m.DOCTYPE_DTD:O==="]"?(c.doctype+=O,c.state=m.DOCTYPE):O==="<"?(c.state=m.OPEN_WAKA,c.startTagPosition=c.position):S(O)?(c.doctype+=O,c.state=m.DOCTYPE_DTD_QUOTED,c.q=O):c.doctype+=O;continue;case m.DOCTYPE_DTD_QUOTED:c.doctype+=O,O===c.q&&(c.state=m.DOCTYPE_DTD,c.q="");continue;case m.COMMENT:O==="-"?c.state=m.COMMENT_ENDING:c.comment+=O;continue;case m.COMMENT_ENDING:O==="-"?(c.state=m.COMMENT_ENDED,c.comment=h(c.opt,c.comment),c.comment&&A(c,"oncomment",c.comment),c.comment=""):(c.comment+="-"+O,c.state=m.COMMENT);continue;case m.COMMENT_ENDED:O!==">"?(W(c,"Malformed comment"),c.comment+="--"+O,c.state=m.COMMENT):c.doctype&&c.doctype!==!0?c.state=m.DOCTYPE_DTD:c.state=m.TEXT;continue;case m.CDATA:for(var lt=M-1;O&&O!=="]";)O=K(g,M++),O&&c.trackPosition&&(c.position++,O===`
`?(c.line++,c.column=0):c.column++);c.cdata+=g.substring(lt,M-1),O==="]"&&(c.state=m.CDATA_ENDING);continue;case m.CDATA_ENDING:O==="]"?c.state=m.CDATA_ENDING_2:(c.cdata+="]"+O,c.state=m.CDATA);continue;case m.CDATA_ENDING_2:O===">"?(c.cdata&&A(c,"oncdata",c.cdata),A(c,"onclosecdata"),c.cdata="",c.state=m.TEXT):O==="]"?c.cdata+="]":(c.cdata+="]]"+O,c.state=m.CDATA);continue;case m.PROC_INST:O==="?"?c.state=m.PROC_INST_ENDING:C(O)?c.state=m.PROC_INST_BODY:c.procInstName+=O;continue;case m.PROC_INST_BODY:if(!c.procInstBody&&C(O))continue;O==="?"?c.state=m.PROC_INST_ENDING:c.procInstBody+=O;continue;case m.PROC_INST_ENDING:O===">"?(A(c,"onprocessinginstruction",{name:c.procInstName,body:c.procInstBody}),c.procInstName=c.procInstBody="",c.state=m.TEXT):(c.procInstBody+="?"+O,c.state=m.PROC_INST_BODY);continue;case m.OPEN_TAG:D(l,O)?c.tagName+=O:(st(c),O===">"?U(c):O==="/"?c.state=m.OPEN_TAG_SLASH:(C(O)||W(c,"Invalid character in tag name"),c.state=m.ATTRIB));continue;case m.OPEN_TAG_SLASH:O===">"?(U(c,!0),R(c)):(W(c,"Forward-slash in opening tag not followed by >"),c.state=m.ATTRIB);continue;case m.ATTRIB:if(C(O))continue;O===">"?U(c):O==="/"?c.state=m.OPEN_TAG_SLASH:D(T,O)?(c.attribName=O,c.attribValue="",c.state=m.ATTRIB_NAME):W(c,"Invalid attribute name");continue;case m.ATTRIB_NAME:O==="="?c.state=m.ATTRIB_VALUE:O===">"?(W(c,"Attribute without value"),c.attribValue=c.attribName,rt(c),U(c)):C(O)?c.state=m.ATTRIB_NAME_SAW_WHITE:D(l,O)?c.attribName+=O:W(c,"Invalid attribute name");continue;case m.ATTRIB_NAME_SAW_WHITE:if(O==="=")c.state=m.ATTRIB_VALUE;else{if(C(O))continue;W(c,"Attribute without value"),c.tag.attributes[c.attribName]="",c.attribValue="",A(c,"onattribute",{name:c.attribName,value:""}),c.attribName="",O===">"?U(c):D(T,O)?(c.attribName=O,c.state=m.ATTRIB_NAME):(W(c,"Invalid attribute name"),c.state=m.ATTRIB)}continue;case m.ATTRIB_VALUE:if(C(O))continue;S(O)?(c.q=O,c.state=m.ATTRIB_VALUE_QUOTED):(c.opt.unquotedAttributeValues||q(c,"Unquoted attribute value"),c.state=m.ATTRIB_VALUE_UNQUOTED,c.attribValue=O);continue;case m.ATTRIB_VALUE_QUOTED:if(O!==c.q){O==="&"?c.state=m.ATTRIB_VALUE_ENTITY_Q:c.attribValue+=O;continue}rt(c),c.q="",c.state=m.ATTRIB_VALUE_CLOSED;continue;case m.ATTRIB_VALUE_CLOSED:C(O)?c.state=m.ATTRIB:O===">"?U(c):O==="/"?c.state=m.OPEN_TAG_SLASH:D(T,O)?(W(c,"No whitespace between attributes"),c.attribName=O,c.attribValue="",c.state=m.ATTRIB_NAME):W(c,"Invalid attribute name");continue;case m.ATTRIB_VALUE_UNQUOTED:if(!L(O)){O==="&"?c.state=m.ATTRIB_VALUE_ENTITY_U:c.attribValue+=O;continue}rt(c),O===">"?U(c):c.state=m.ATTRIB;continue;case m.CLOSE_TAG:if(c.tagName)O===">"?R(c):D(l,O)?c.tagName+=O:c.script?(c.script+="</"+c.tagName,c.tagName="",c.state=m.SCRIPT):(C(O)||W(c,"Invalid tagname in closing tag"),c.state=m.CLOSE_TAG_SAW_WHITE);else{if(C(O))continue;N(T,O)?c.script?(c.script+="</"+O,c.state=m.SCRIPT):W(c,"Invalid tagname in closing tag."):c.tagName=O}continue;case m.CLOSE_TAG_SAW_WHITE:if(C(O))continue;O===">"?R(c):W(c,"Invalid characters in closing tag");continue;case m.TEXT_ENTITY:case m.ATTRIB_VALUE_ENTITY_Q:case m.ATTRIB_VALUE_ENTITY_U:var ut,a;switch(c.state){case m.TEXT_ENTITY:ut=m.TEXT,a="textNode";break;case m.ATTRIB_VALUE_ENTITY_Q:ut=m.ATTRIB_VALUE_QUOTED,a="attribValue";break;case m.ATTRIB_VALUE_ENTITY_U:ut=m.ATTRIB_VALUE_UNQUOTED,a="attribValue";break}if(O===";"){var H=tt(c);c.opt.unparsedEntities&&!Object.values(e.XML_ENTITIES).includes(H)?(c.entity="",c.state=ut,c.write(H)):(c[a]+=H,c.entity="",c.state=ut)}else D(c.entity.length?I:y,O)?c.entity+=O:(W(c,"Invalid character in entity name"),c[a]+="&"+c.entity+O,c.entity="",c.state=ut);continue;default:throw new Error(c,"Unknown state: "+c.state)}return c.position>=c.bufferCheckPosition&&r(c),c}String.fromCodePoint||(function(){var g=String.fromCharCode,c=Math.floor,M=function(){var O=16384,nt=[],lt,ut,a=-1,H=arguments.length;if(!H)return"";for(var j="";++a<H;){var x=Number(arguments[a]);if(!isFinite(x)||x<0||x>1114111||c(x)!==x)throw RangeError("Invalid code point: "+x);x<=65535?nt.push(x):(x-=65536,lt=(x>>10)+55296,ut=x%1024+56320,nt.push(lt,ut)),(a+1===H||nt.length>O)&&(j+=g.apply(null,nt),nt.length=0)}return j};Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:M,configurable:!0,writable:!0}):String.fromCodePoint=M})()})(f)})(re)),re}var lr=cr();const ur=pe(lr);var hr=Object.defineProperty,fr=(f,e,t)=>e in f?hr(f,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):f[e]=t,yt=(f,e,t)=>fr(f,typeof e!="symbol"?e+"":e,t);function dr(f){return f.charCodeAt(0)===65279?f.slice(1):f}const Pe={.2:{explicitCharkey:!1,trim:!1,normalize:!1,normalizeTags:!1,attrkey:"$",charkey:"_",explicitArray:!0,ignoreAttrs:!1,mergeAttrs:!1,explicitRoot:!0,validator:null,xmlns:!1,explicitChildren:!1,preserveChildrenOrder:!1,childkey:"$$",charsAsChildren:!1,includeWhiteChars:!1,async:!1,strict:!0,attrNameProcessors:null,attrValueProcessors:null,tagNameProcessors:null,valueProcessors:null,rootName:"root",xmldec:{version:"1.0",encoding:"UTF-8",standalone:!0},doctype:null,renderOpts:{pretty:!0,indent:"  ",newline:`
`},headless:!1,chunkSize:1e4,emptyTag:"",cdata:!1}};function pr(f){return f.toLowerCase()}function mr(f){return typeof f=="object"&&f!==null&&Object.keys(f).length===0}function Yt(f,e,t){for(const s of f)e=s(e,t);return e}function Nt(f,e,t){const s=Object.create(null);s.value=t,s.writable=!0,s.enumerable=!0,s.configurable=!0,Object.defineProperty(f,e,s)}class gr extends rr.EventEmitter{constructor(e){super(),yt(this,"options"),yt(this,"remaining",""),yt(this,"saxParser"),yt(this,"resultObject",null),yt(this,"EXPLICIT_CHARKEY"),yt(this,"errThrown",!1),yt(this,"ended",!1),yt(this,"processAsync",()=>{try{if(this.remaining.length<=this.options.chunkSize){const t=this.remaining;this.remaining="",this.saxParser=this.saxParser.write(t),this.saxParser.close()}else{const t=this.remaining.slice(0,this.options.chunkSize);this.remaining=this.remaining.slice(this.options.chunkSize),this.saxParser=this.saxParser.write(t),setTimeout(this.processAsync,0)}}catch(t){this.errThrown||(this.errThrown=!0,this.emit("error",t))}}),yt(this,"assignOrPush",(t,s,r)=>{s in t?(Array.isArray(t[s])||Nt(t,s,[t[s]]),t[s].push(r)):this.options.explicitArray?Nt(t,s,[r]):Nt(t,s,r)}),yt(this,"reset",()=>{this.removeAllListeners(),this.saxParser=ur.parser(this.options.strict,{trim:!1,normalize:!1,xmlns:this.options.xmlns}),this.errThrown=!1,this.saxParser.onerror=i=>{this.saxParser.resume(),this.errThrown||(this.errThrown=!0,this.emit("error",i))},this.saxParser.onend=()=>{this.ended||(this.ended=!0,this.emit("end",this.resultObject))},this.ended=!1,this.EXPLICIT_CHARKEY=this.options.explicitCharkey,this.resultObject=null;const t=[],s=this.options.attrkey,r=this.options.charkey;this.saxParser.onopentag=i=>{const o={};o[r]="",this.options.ignoreAttrs||Object.keys(i.attributes).forEach(u=>{!(s in o)&&!this.options.mergeAttrs&&(o[s]={});const _=this.options.attrValueProcessors?Yt(this.options.attrValueProcessors,i.attributes[u],u):i.attributes[u],b=this.options.attrNameProcessors?Yt(this.options.attrNameProcessors,u):u;this.options.mergeAttrs?this.assignOrPush(o,b,_):Nt(o[s],b,_)}),o["#name"]=this.options.tagNameProcessors?Yt(this.options.tagNameProcessors,i.name):i.name,this.options.xmlns&&(o[this.options.xmlnskey]={uri:i.uri,local:i.local}),t.push(o)},this.saxParser.onclosetag=()=>{let i=t.pop();const o=i["#name"];(!this.options.explicitChildren||!this.options.preserveChildrenOrder)&&delete i["#name"];let u;i.cdata===!0&&(u=i.cdata,delete i.cdata);const _=t[t.length-1];let b="";if(i[r].match(/^\s*$/)&&!u?(b=i[r],delete i[r]):(this.options.trim&&(i[r]=i[r].trim()),this.options.normalize&&(i[r]=i[r].replace(/\s{2,}/g," ").trim()),i[r]=this.options.valueProcessors?Yt(this.options.valueProcessors,i[r],o):i[r],Object.keys(i).length===1&&r in i&&!this.EXPLICIT_CHARKEY&&(i=i[r])),mr(i)&&(typeof this.options.emptyTag=="function"?i=this.options.emptyTag():i=this.options.emptyTag!==""?this.options.emptyTag:b),this.options.validator){const v=`/${t.map(E=>E["#name"]).concat(o).join("/")}`;(()=>{try{i=this.options.validator(v,_&&_[o],i)}catch(E){this.emit("error",E)}})()}if(this.options.explicitChildren&&!this.options.mergeAttrs&&typeof i=="object")if(this.options.preserveChildrenOrder){if(_){_[this.options.childkey]=_[this.options.childkey]||[];const v={};Object.keys(i).forEach(E=>{Nt(v,E,i[E])}),_[this.options.childkey].push(v),delete i["#name"],Object.keys(i).length===1&&r in i&&!this.EXPLICIT_CHARKEY&&(i=i[r])}}else{const v={};this.options.attrkey in i&&(v[this.options.attrkey]=i[this.options.attrkey],delete i[this.options.attrkey]),!this.options.charsAsChildren&&this.options.charkey in i&&(v[this.options.charkey]=i[this.options.charkey],delete i[this.options.charkey]),Object.getOwnPropertyNames(i).length>0&&(v[this.options.childkey]=i),i=v}if(t.length>0)this.assignOrPush(_,o,i);else{if(this.options.explicitRoot){const v=i,E={};Nt(E,o,v),i=E}this.resultObject=i,this.ended=!0,this.emit("end",this.resultObject)}};const n=i=>{const o=t[t.length-1];if(o&&(o[r]+=i,this.options.explicitChildren&&this.options.preserveChildrenOrder&&this.options.charsAsChildren&&(this.options.includeWhiteChars||i.replace(/\\n/g,"").trim()!==""))){o[this.options.childkey]=o[this.options.childkey]||[];const u={"#name":"__text__"};u[r]=i,this.options.normalize&&(u[r]=u[r].replace(/\s{2,}/g," ").trim()),o[this.options.childkey].push(u)}return o};this.saxParser.ontext=n,this.saxParser.oncdata=i=>{const o=n(i);o&&(o.cdata=!0)}}),yt(this,"parseString",(t,s)=>{s&&typeof s=="function"&&(this.on("end",r=>{this.reset(),s(null,r)}),this.on("error",r=>{this.reset(),s(r)}));try{return t=t.toString(),t.trim()===""?(this.emit("end",null),!0):(t=dr(t),this.options.async?(this.remaining=t,setTimeout(this.processAsync,0),this.saxParser):this.saxParser.write(t).close())}catch(r){if(!this.errThrown&&!this.ended)this.emit("error",r),this.errThrown=!0;else if(this.ended)throw r}}),yt(this,"parseStringPromise",t=>new Promise((s,r)=>{this.parseString(t,(n,i)=>{n?r(n):s(i)})})),this.options={},Object.keys(Pe["0.2"]).forEach(t=>{this.options[t]=Pe["0.2"][t]}),e&&Object.keys(e).forEach(t=>{this.options[t]=e[t]}),this.options.xmlns&&(this.options.xmlnskey=`${this.options.attrkey}ns`),this.options.normalizeTags&&(this.options.tagNameProcessors||(this.options.tagNameProcessors=[]),this.options.tagNameProcessors.unshift(pr)),this.reset()}}function vr(f,e){let t={};return typeof e=="object"&&(t=e),new gr(t).parseStringPromise(f)}async function yr(f,e={}){return await vr(f,e)}function Qe(f){return f.replace(/-([a-z])/gi,e=>e[1].toUpperCase())}const le="fb2:",ue="lingo_fb2_",_r=`${ue}style`;async function br(f){if(f instanceof Uint8Array)return console.log("AAAA"),{data:f,fileName:""};{if(typeof f=="string")throw new TypeError("The `fb2` param cannot be a `string` in browser env.");let e=await f.text();return e.includes('encoding="windows-1251"')&&(e=await Cr(f)),{data:e,fileName:f.name}}}function kt(f){return f?.[0]._??""}function $t(f,e,t=[]){for(const s in e)Object.prototype.hasOwnProperty.call(e,s)&&!(s in f)&&(t.includes(s)||(f[s]=e[s]));return f}function wr(f){const e=atob(f.trim()),t=e.length,s=new Uint8Array(t);for(let r=0;r<t;r++)s[r]=e.charCodeAt(r);return s}function Fe(f,e){const{id:t,base64Data:s,contentType:r}=f;{const n=wr(s),i=new Blob([n],{type:r});return URL.createObjectURL(i)}}function Sr(f,e){return URL.createObjectURL(new Blob([f],{type:"text/css"}))}function Be(f,e){return le+f+(e?`#${e}`:"")}function Je(f,e,t){for(const s of e.children){if(s["#name"]==="__text__")continue;const r=s.$;r&&r.id&&t.set(r.id,f),s.children&&Je(f,s,t)}}const Er={section:"div",title:"h2",subtitle:"h3",poem:"blockquote",stanza:"p",v:"p","text-author":"cite",epigraph:"blockquote","empty-line":"br",image:"img",emphasis:"em"},kr=new Set(["br","img"]);function Tr(f){const e=Er[f]??f;return{tag:e,isSelfClosing:kr.has(e)}}function Cr(f){return new Promise((e,t)=>{const s=new FileReader;s.onload=function(r){if(r.target&&r.target.result instanceof ArrayBuffer){const n=r.target.result,o=new TextDecoder("windows-1251").decode(n);e(o)}else t(new Error("FileReader did not return an ArrayBuffer."))},s.onerror=function(r){t(r.target.error)},s.readAsArrayBuffer(f)})}function xr(f){const e=new Map;for(const t of f??[]){const s=t.$,r=s.id,n=s["content-type"];if(!r||!n)throw new Error("The <binary> element must have `id` and `content-type` attributes.");e.set(r,{id:r,contentType:s["content-type"],base64Data:t._})}return e}function tn(f){const e=kt(f["first-name"]),t=kt(f["middle-name"]),s=kt(f["last-name"]),r=[e,t,s].filter(Boolean).join(" ");return{firstName:e,middleName:t,lastName:s,name:r,nickname:kt(f["first-name"]),homePage:kt(f["home-page"]),email:kt(f.email)}}function Ar(f){const e=f.image[0].$;return e["l:href"]??e["xlink:href"]}function Ir(f){const e={},t={genre:"type",lang:"language",annotation:"description","book-title":"title","src-lang":"srcLang"};for(const s in f){const r=f[s]?.[0];if(s in t&&r&&"_"in r){e[t[s]]=r._;continue}switch(s){case"author":{e.author=tn(r);break}case"coverpage":{e.coverImageId=Ar(r).slice(1);break}}}return e}function Nr(f){const e={};for(const t in f)t!=="children"&&(t==="author"?e.author=tn(f.author[0]):t==="history"?e.history=f.history[0]:e[Qe(t)]=kt(f[t]));return e}function Or(f){const e={};for(const t in f){if(t==="children")continue;const s=f[t];e[Qe(t)]=kt(s)}return e}function Dr(f){const e={};for(const t of f){const s=t.$["info-type"];e[s]=t._}return e}function Lr(f){const e={};let t="",s;if(f["title-info"]){const r=Ir(f["title-info"][0]);t=r.coverImageId??"",$t(e,r,["coverImageId"])}if(f["document-info"]){const r=Nr(f["document-info"][0]);$t(e,r,["history"]),s=r.history}if(f["publish-info"]){const r=Or(f["publish-info"][0]);$t(e,r)}if(f["custom-info"]){const r=Dr(f["custom-info"]);$t(e,r)}return{metadata:e,coverImageId:t,history:s}}var Pr=Object.defineProperty,Fr=(f,e,t)=>e in f?Pr(f,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):f[e]=t,_t=(f,e,t)=>Fr(f,typeof e!="symbol"?e+"":e,t);async function Br(f,e="./images"){const t=new Rr(f,e);return await t.loadFb2(),t}class Rr{constructor(e,t="./images"){this.fb2=e,_t(this,"resourceSaveDir"),_t(this,"resourceStore"),_t(this,"resourceCache",new Map),_t(this,"chapterCache",new Map),_t(this,"stylesheetUrl",""),_t(this,"chapterStore",new Map),_t(this,"idToChapterIdMap",new Map),_t(this,"tableOfContent",[]),_t(this,"spine",[]),_t(this,"metadata"),_t(this,"fileName"),_t(this,"coverImageId"),this.resourceSaveDir=t}getToc(){return this.tableOfContent}getSpine(){return this.spine}getMetadata(){return this.metadata}getFileInfo(){return{fileName:this.fileName}}getCoverImage(){if(this.resourceCache.has(this.coverImageId))return this.resourceCache.get(this.coverImageId);if(this.coverImageId.length>0&&this.resourceStore.has(this.coverImageId)){const e=Fe(this.resourceStore.get(this.coverImageId),this.resourceSaveDir);return this.resourceCache.set(this.coverImageId,e),e}return""}async loadFb2(){const{data:e,fileName:t}=await br(this.fb2);this.fileName=t;const r=(await yr(e,{charsAsChildren:!0,preserveChildrenOrder:!0,explicitChildren:!0,childkey:"children",trim:!0})).FictionBook;this.resourceStore=xr(r.binary);const{metadata:n,coverImageId:i,history:o}=Lr(r.description[0]);this.metadata=n,this.coverImageId=i,o&&(this.metadata.history=this.serializeNode(o)),r.stylesheet&&(this.stylesheetUrl=Sr(r.stylesheet[0]._,this.resourceSaveDir),this.resourceCache.set(_r,this.stylesheetUrl));let u=0;for(const _ of r.body){const b=!_.$?.name;for(const v of _.section){const E=ue+u,p=b?kt(v.title):_.$.name;this.chapterStore.set(E,{id:E,sectionNode:v,...b?{}:{name:p}}),this.spine.push({id:E}),this.tableOfContent.push({label:p,href:Be(E)}),Je(E,v,this.idToChapterIdMap),u++}}}serializeAttr(e,t){if(!e)return"";const s=[];for(const r in e){const n=e[r];if(r==="l:href"||r==="xlink:href"){const i=n.slice(1);if(t==="a"&&this.idToChapterIdMap.has(i))s.push(`href="${Be(this.idToChapterIdMap.get(i),i)}"`);else if(t==="a"&&n.startsWith("http"))s.push(`href="${n}"`);else if(t==="img"&&this.resourceStore.has(i)){const o=Fe(this.resourceStore.get(i),this.resourceSaveDir);this.resourceCache.set(i,o),s.push(`src="${o}"`)}else s.push("")}else s.push(`${r}="${n}"`)}return s.filter(Boolean).join(" ")}serializeChildren(e){const t=[];for(const s of e.children)if(s["#name"]==="__text__")t.push(s._);else{const{tag:r,isSelfClosing:n}=Tr(s["#name"]),i=this.serializeAttr(s.$,r),o=i.length>0?` ${i}`:"";let u="";s.children&&(u=this.serializeChildren(s)),t.push(n?`<${r}${o}/>`:`<${r}${o}>${u}</${r}>`)}return t.join("")}serializeNode(e){const t=this.serializeAttr(e.$,"div"),s=this.serializeChildren(e);return`<div${t}>${s}</div>`}loadChapter(e){if(!this.chapterStore.has(e))return;if(this.chapterCache.has(e))return this.chapterCache.get(e);const t=this.chapterStore.get(e),s={html:this.serializeNode(t.sectionNode),css:this.stylesheetUrl.length>0?[{id:`${ue}css`,href:this.stylesheetUrl}]:[]};return this.chapterCache.set(e,s),s}resolveHref(e){if(!e.startsWith(le))return;e=e.slice(le.length).trim();const[t,s]=e.split("#"),r=this.chapterStore.get(t)?.id;if(!r)return;let n="";return s&&(n=`[id="${s}"]`),{id:r,selector:n}}destroy(){this.resourceCache.forEach(e=>{URL.revokeObjectURL(e)}),this.resourceCache.clear(),this.chapterCache.clear(),this.resourceStore?.clear(),this.chapterStore.clear()}}async function Re(f){try{const e=await Br(f),t=e.getSpine();let s=[];const r=e.getCoverImage();r&&s.push(`<img src=${r} alt="Cover Image"}>`);const n=[];for(let v=0;v<t.length;v++){const E=t[v],p=e.loadChapter(E.id)?.html;if(p===void 0)continue;try{const d=zr(p,v);n.push({title:d,href:v.toString()})}catch(d){console.error("Error constructing TOC label",d)}const k=`<div id="${v}">${p}</div>`;s.push(k)}const i=s.join(" "),o=document.createElement("div");o.innerHTML=i,await Mr(o);const u=e.getMetadata(),_=u.author?.firstName||"",b=u.author?.lastName||"";return{pageTemp:o,langMeta:u.language||"",title:u.title||"",author:`${_} ${b}`,toc:n}}catch(e){return console.error("Error in parseFb2",e),null}}function zr(f,e){const r=[...Ur(f).trim()].slice(0,dn).join("");return r||e.toString()}function Ur(f){const e=document.createElement("div");return e.innerHTML=f.replace(/></gm,"> <"),e.textContent}async function Mr(f){const e=f.getElementsByTagName("img"),t=new Set;for(let s=0;s<e.length;s++){const r=e[s];if(r.src&&r.src.startsWith("blob:"))try{const n=r.src;t.add(n);const o=await(await fetch(r.src)).blob(),u=new FileReader,_=await new Promise((b,v)=>{u.onload=()=>b(u.result),u.onerror=v,u.readAsDataURL(o)});r.src=_}catch(n){console.error("Failed to convert blob URL to data URL:",n)}}try{t.forEach(URL.revokeObjectURL)}catch(s){console.warn("Error cleaning up blob URLs:",s)}}class jr{#t=document.querySelector("#toc-dialog");#e;#r=1;#n;constructor(e,t){this.#e=e,this.#n=t;const s=this.#t.querySelector(".close-dialog-button");s.onclick=this.hide.bind(this);const r=document.querySelector("#toc-portrait-button"),n=document.querySelector("#toc-landscape-button");[r,n].forEach(o=>o.onclick=this.show.bind(this)),this.#s();const i=[r,n];this.#e.length?i.forEach(o=>{o.classList.remove("hidden")}):i.forEach(o=>{o.classList.add("hidden")})}show(){this.#t.showModal()}hide(){this.#t.close()}#s(){const e=document.querySelector("#toc-list-wrapper");if(!e)throw new Error("TOC list tag not found");this.#r=1,e.replaceChildren();try{const t=this.#i(this.#e);e.append(t)}catch(t){console.error("Error setting TOC",t)}}#i(e){const t=document.createElement("ul");for(let s of e){const r=document.createElement("ul"),n=document.createElement("a");if(s.title.trim()?(n.innerText=s.title,n.setAttribute("lang",this.#n)):(n.innerText=this.#r.toString(),this.#r++),n.href=$e(s.href),r.append(n),Array.isArray(s.children)){const i=this.#i(s.children);r.append(i)}t.append(r)}return t}}class gt{card;tableOfContents;constructor(e,t,s){Rn(t);let r=bt.getCard(t);r?(r.langMeta=s.langMeta,r.title=s.title,r.author=s.author,r.toc=s.toc,bt.updateCard(r)):r=bt.newCard(t,e,s.langMeta,s.title,s.author,s.toc),this.card=r,this.#e(s.pageTemp),this.tableOfContents=new jr(s.toc,this.lang())}lang(){return ce(this.card)}static async create(e){Gt.show();try{const t=await Fn(e);let s;const r=e.name.toLocaleLowerCase();return r.endsWith(".epub")?s=await Te(e):r.endsWith(".fb2")?s=await Re(e):r.endsWith(".fb2.zip")||r.endsWith(".fbz")?s=await gt.parseZippedFb2(e):(console.error("Unkown book file extension, trying EPUB parser"),s=await Te(e)),s?(In(new Ve({hash:t,filename:e.name,parsedHtml:s.pageTemp.innerHTML})),new gt(e.name,t,s)):(console.error("Error: null parseData"),null)}catch(t){return console.error("Exception in Book.create",t),null}finally{Gt.hide()}}static async parseZippedFb2(e){const t=await Xe.loadAsync(e),s=Object.keys(t.files);if(s.length===0)throw new Error("The zip archive is empty.");s.length>1&&console.warn("The zip archive contains more than one file. Using the first one.");const n=await t.files[s[0]].async("blob"),i=new File([n],e.name,{type:"text/fb2+xml"});return Re(i)}static async createWelcomeGuide(){const{htmlStr:e,lang:t}=await gt.#t(),s=Ye(e),r=document.createElement("div");r.innerHTML=s||"";const n={pageTemp:r,langMeta:t,title:ye,author:"",toc:[]},i=ye;return new gt(i,on,n)}static async#t(){var e="",t=Ot();try{const s=St.get(t);if(!s)throw new Error("Don't have welcome guide in user's language");e=await(await fetch(s)).text()}catch(s){console.error(s),console.log("Loading welome guide in english");try{t="en";const r=St.get(t);if(!r)throw new Error("Don't have welcome guide in user's English");e=await(await fetch(r)).text()}catch(r){console.error(r)}}return{htmlStr:e,lang:t}}static async loadFromDB(e){Gt.show();try{const t=await xn(e.fileHash);if(t===null)return null;let s=document.createElement("div");s.innerHTML=t.parsedHtml;const r={pageTemp:s,langMeta:e.langMeta,title:e.title,author:e.author,toc:e.toc};return new gt(t.filename,e.fileHash,r)}catch(t){return console.error("Exception in Book.loadFromDB",t),null}finally{Gt.hide()}}#e(e){Bt(ct),ct.append(...e.children);const t=bt?.getCard(this.card.fileHash);t&&ct.setAttribute("lang",ce(t))}}function ze(f){return f.preventDefault(),new Promise(e=>{const s=f.target.files?.[0];if(!s){console.error("No file selected"),e(null);return}return gt.create(s).then(r=>e(r))})}class Ue{#t=document.querySelector("#controls-open-book-button");#e=document.querySelector("#open-book-dialog");#r=document.querySelector("#open-book-dialog .close-dialog-button");openFileInput=document.querySelector("#open-file-input");openFileInputFb2=document.querySelector("#open-file-input-fb2");#n=document.querySelector("#recent-books-list");#s=[];constructor(){this.openFileInput.value="",this.openFileInputFb2.value="",this.#t.onclick=this.show.bind(this),this.#r.onclick=this.hide.bind(this)}async getNewBook(){await this.#i();const e=new Promise(r=>{this.#s.forEach(n=>{n.onclick=()=>{this.hide();const i=n.dataset.bookHash||"";if(i===""){r(null);return}const o=bt?.getCard(i);if(!o){r(null);return}gt.loadFromDB(o).then(u=>r(u))}})}),t=new Promise(r=>{this.openFileInput.onchange=n=>{this.hide(),ze(n).then(i=>r(i))}}),s=new Promise(r=>{this.openFileInputFb2.onchange=n=>{this.hide(),ze(n).then(i=>r(i))}});return Promise.race([e,t,s])}hide(){this.#e.close()}show(){this.#e.showModal(),this.#o()}async#i(){Bt(this.#n),this.#s=[];const e=bt.cardsArray();for(let t of e){if(!await ae(t.fileHash))continue;const r=this.#a(t);this.#s.push(r),this.#n.appendChild(r)}}async#o(){const e=[...this.#n.childNodes];for(let t of e){const s=t.dataset.bookHash||"";if(s==="")continue;await ae(s)||t.remove()}}#a(e){const t=document.createElement("button");let s=e.title;if(zt(s))try{let r=e.author;zt(r)&&(s+=" — "+e.author),t.innerText=s,t.setAttribute("lang",ce(e))}catch{t.innerText=e.filename}else t.innerText=e.filename;return t.dataset.bookHash=e.fileHash,t}}class Hr{#t=document.querySelector("#options-dialog");#e=document.querySelector("#options-button");#r=document.querySelector("#options-dialog .close-dialog-button");#n=document.querySelector("#language-select");#s=document.querySelector("#voice-option");#i=document.querySelector("#voice-select");#o=document.querySelector("#font-select");constructor(){this.#e.onclick=this.#a.bind(this),this.#r.onclick=this.#c.bind(this),this.#i.onchange=e=>{ot.setVoiceByName(e.target?.value)},this.#o.onchange=e=>{ot.currentFont=e.target?.value},this.setLangSelectOnChange(),this.populateFonts(),this.#h(),this.initLineHeightOption(),this.initMarginOption()}populateFonts(){Bt(this.#o);const e=ot.fonts;for(let t of e){const s=document.createElement("option");s.value=t,s.textContent=t,this.#o.appendChild(s)}this.#o.value=ot.currentFont}setLangSelectOnChange(){this.#n.onchange=e=>{const t=ot.currentBook?.card;if(!t)return;t.langOverride=e.target?.value;const s=ot.currentVoice();s?ot.setVoiceByName(s.name):ot.updateVoice(),bt?.updateCard(t),this.#l(),document.dispatchEvent(new CustomEvent("needrestartsentence"))}}#a(){try{this.#l(),this.#u()}catch{}this.#t.showModal()}#c(){this.#t.close()}#u(){Bt(this.#n);let e=null;try{e=new Intl.DisplayNames([Ot()],{type:"language"})}catch{}for(let s of ot.availableLangs()){const r=document.createElement("option");r.value=s;let n=s;if(e)try{n=e.of(s)||s}catch{}r.textContent=n,this.#n.appendChild(r)}if(ot.availableLangs().has(ot.currentLang()))this.#n.value=ot.currentLang();else{const s=ot.currentLang();for(var t of ot.availableLangs())if(s.startsWith(t)||t.startsWith(s)){this.#n.value=t;break}}}#l(){Bt(this.#i);const e=ot.currentLangVoices();if(e.length<2){this.#s.classList.add("hidden");return}this.#s.classList.remove("hidden");for(let t of e){const s=document.createElement("option");s.value=t.name,s.textContent=t.name,this.#i.appendChild(s)}this.#i.value=ot.currentVoice()?.name||""}#h(){const e=document.querySelector("#speed-option"),t=e.querySelector(".plus-button"),s=e.querySelector(".minus-button"),r=e.querySelector(".numeric-option-value");r.innerText=ot.speakingSpeed.toFixed(1),s.onclick=()=>{const n=ot.speedMinus();r.innerText=n.toFixed(1)},t.onclick=()=>{const n=ot.speedPlus();r.innerText=n.toFixed(1)}}initLineHeightOption(){const e=document.querySelector("#line-height-option"),t=e.querySelector(".plus-button"),s=e.querySelector(".minus-button"),r=e.querySelector(".numeric-option-value");r.innerText=ot.lineHeight.toFixed(1),s.onclick=()=>{const n=ot.lineHeightMinus();r.innerText=n.toFixed(1)},t.onclick=()=>{const n=ot.lineHeightPlus();r.innerText=n.toFixed(1)}}initMarginOption(){const e=document.querySelector("#margin-option"),t=e.querySelector(".plus-button"),s=e.querySelector(".minus-button"),r=e.querySelector(".numeric-option-value");r.innerText=ot.margin.toFixed(0),s.onclick=()=>{const n=ot.marginMinus();r.innerText=n.toFixed(0)},t.onclick=()=>{const n=ot.marginPlus();r.innerText=n.toFixed(0)}}}function Me(f,e){let t=0,s=f.length-1;for(;t<=s;){const r=Math.floor((t+s)/2);if(e(f[r])){if(r===0||!e(f[r-1]))return r;s=r-1}else t=r+1}return-1}const Wr="a,abbr,b,button,cite,code,dfn,em,i,img,input,kbd,label,map,object,output,q,samp,script,select,small,span,strong,sub,sup,textarea,time,var",qr=Wr.split(","),Vr=new Set(qr);class Gr{val;constructor(e){this.val=e}needToBreak(){const e=this.val,t=this.val.parentNode,s=t?.parentNode,r=je(e),n=je(t),i=He(t),o=He(s);return r&&i||n&&o}parentNodeIsLink(){const e=this.val.parentElement;return e?e.tagName==="A":!1}}function je(f){return!f||!f.parentNode?!1:f===f.parentNode.lastChild}function He(f){let e=f.tagName;return e?(e=e.toLowerCase(),!Vr.has(e)):!1}class Zr{text;fullText;start;end;node;parentSentence=null;constructor(e,t,s,r){this.text=e.replace(/\s+/gm," "),this.start=t,this.end=s,this.node=r,this.fullText=this.node.val.textContent||""}onScreen(){try{const e=this.range().getBoundingClientRect(),t=ct.getBoundingClientRect(),s=e.top>=t.top,r=e.bottom<=t.bottom;return s&&r||!s&&!r}catch{console.warn("Exception in SentencePart.withinScreen()")}}beforeScreen(){try{const e=this.range().getBoundingClientRect(),t=ct.getBoundingClientRect();return e.top<t.top}catch{console.warn("Exception in SentencePart.beforeScreen()")}}onOrAfterScreen(){try{const e=this.range().getBoundingClientRect(),t=ct.getBoundingClientRect();return e.top>=t.top}catch{console.warn("Exception in SentencePart.afterScreen()")}}afterScreen(){return this.#t(this.range())}#t(e){try{const t=e.getBoundingClientRect(),s=ct.getBoundingClientRect();return t.bottom>s.bottom}catch{console.warn("Exception in SentencePart.#rangeAfterScreen()")}}range(){try{const e=new Range;return e.setStart(this.node.val,this.start),e.setEnd(this.node.val,this.end),e}catch{return console.warn("Exception in Sentence.#range()"),new Range}}firstSymbolRangeAfterScreen(){const e=this.#e();for(let t of e)if(this.#t(t))return t;return null}#e(){const e=[];let t=this.node.val.textContent,s=0;for(let r of t){const n=new Range;n.setStart(this.node.val,s),n.setEnd(this.node.val,s+r.length),s+=r.length,e.push(n)}return e}}class Xr{text="";parts=[];constructor(e){if(!e||!e.length){console.warn("Sentence: invalid parts constructor parameter");return}this.text=e.map(t=>t.text).join(" "),this.parts=e,this.parts.forEach(t=>t.parentSentence=this)}highlight(){try{const e=new Highlight(...this.ranges());CSS.highlights.set("current-sentence",e)}catch{}}onScreen(){return this.parts.length===0?!1:this.parts.some(e=>e.onScreen())}beforeScreen(){return this.parts.every(e=>e.beforeScreen())}onOrAfterScreen(){return this.parts.every(e=>e.onOrAfterScreen())}afterScreen(){return this.parts.every(e=>e.afterScreen())}withinScreen(){try{const e=this.partRectangles(),t=ct.getBoundingClientRect(),s=r=>{const n=r.top>=t.top,i=r.bottom<=t.bottom;return n&&i};return e.every(s)}catch{console.warn("Exception in Sentence.withinScreen()")}}partRectangles(){return this.ranges().map(s=>s.getBoundingClientRect())}firstRectange(){return this.partRectangles()[0]}ranges(){return this.parts.map(e=>e.range())}}function Yr(f){if(f.length===0)return[];let e=[[]];for(let s of f)e.at(-1).push(s),(qe.test(s.text)||s.node.needToBreak())&&!s.node.parentNodeIsLink()&&e.push([]);return e=e.filter(s=>s.length!==0),e.forEach(s=>{const r=s[0];r.start+=$r(r.text)}),e.map(s=>new Xr(s))}function $r(f){let e=0;for(let t of f)if(/\s/.test(t))e+=t.length;else break;return e}function Kr(f){const e=document.createTreeWalker(f,NodeFilter.SHOW_TEXT),t=[];let s;for(;s=e.nextNode();)t.push(new Gr(s));return t}class Qr{#t=[];#e=0;#r=null;constructor(){const t=Kr(ct).map(s=>this.#s(s)).flat();this.#t=Yr(t)}done(){const e=this.#e>=this.#t.length;if(e)try{CSS.highlights.clear()}catch{}return e}current(){return this.done()?null:this.#t[this.#e]}jumpToPosition(e){isNaN(e)&&(e=0),e<0&&(e=0),e>100&&(e=100);const t=e/100,s=1e-4;this.#e=Math.floor((this.#t.length-1)*t+s)}currentPosPercents(){if(this.#t.length<2)return 0;let e=this.#e;const t=this.current();if(t&&!t.onScreen()){let s=this.#n();s!==-1&&(e=s)}return e/(this.#t.length-1)*100}setCurrentToFirstOnScreen(){const e=this.#n();e!==-1&&(this.#e=e)}forward(){this.done()||(this.#e++,this.done()||this.highlightCurrent())}backward(){this.#e<=0||(this.#e--,this.highlightCurrent())}highlightCurrent(){this.#t.length&&(this.#t[this.#e].highlight(),this.#r=this.#e)}highlightOnScreen(){return this.#r===null?!1:this.#t[this.#r].onScreen()}setCurrentToHighlight(){this.#r!==null&&(this.#e=this.#r)}firstPartAfterScreen(){let e=Me(this.#t,s=>s.afterScreen());if(e===-1)return null;const t=this.#t[e];for(let s of t.parts)if(s.afterScreen())return s;return null}#n(){return Me(this.#t,e=>e.onOrAfterScreen())}#s(e){let t=e.val.textContent;if(t.trim()==="")return[];const s=this.#i(t),r=[];let n=0;for(let i=0;i<s.length;i++){const o=s[i];let u=n+o.length;o.trim()!==""&&r.push(new Zr(o,n,u,e)),n=u}return r}#i(e){const t=e.split(qe);if(t.length===0)return[];if(t.length===1)return t;const s=[];for(let r=0;r<t.length;r+=2)r===t.length-1?s.push(t[r]):s.push(t[r]+t[r+1]);return s}}function he(f,e){let t=!1;return function(...s){t||(t=!0,f.apply(this,s),setTimeout(()=>{t=!1},e*1e3))}}class Qt{static instance=null;reader=null;#t=[];#e=-1;#r;#n;constructor(){if(Qt.instance)throw new Error("Violated PinchZoom singleton status");this.#r=he(this.#s.bind(this),jt.throttleSeconds),this.#n=he(this.#i.bind(this),jt.throttleSeconds),document.addEventListener("pointerdown",this.handlePointerDown.bind(this)),document.addEventListener("pointermove",this.handlePointerMove.bind(this));const e=this.handlePointerUp.bind(this);document.addEventListener("pointerup",e),document.addEventListener("pointercancel",e),document.addEventListener("pointerout",e),document.addEventListener("pointerleave",e),document.documentElement.style.fontSize=ot.fontSize+"%",Qt.instance=this}#s(){ot.fontSize=ot.fontSize+10,document.documentElement.style.fontSize=ot.fontSize+"%",this.reader?.scrollToCurrent(!1)}#i(){ot.fontSize=ot.fontSize-10,document.documentElement.style.fontSize=ot.fontSize+"%",this.reader?.scrollToCurrent(!1)}handlePointerDown(e){this.#t.push({clientX:e.clientX,clientY:e.clientY,pointerId:e.pointerId})}handlePointerMove(e){const t=this.#t.findIndex(i=>i.pointerId===e.pointerId);if(this.#t[t]={clientX:e.clientX,clientY:e.clientY,pointerId:e.pointerId},this.#t.length!==2)return;e.preventDefault();const s=this.#t[0].clientX-this.#t[1].clientX,r=this.#t[0].clientY-this.#t[1].clientY,n=Math.sqrt(s*s+r*r);this.#e>0&&(n-this.#e>jt.tolerancePx?this.#r():this.#e-n>jt.tolerancePx&&this.#n()),this.#e=n}handlePointerUp(e){this.#t=this.#t.filter(t=>t.pointerId!==e.pointerId),this.#t.length<2&&(this.#e=-1)}}const Jr=new Qt;class ti{reader=null;constructor(){document.addEventListener("needrestartsentence",()=>{!this.reader||!this.reader.playing||(this.reader.pause(),this.reader.play())})}}const ei=new ti;class ni{reader=null;tapStartTime=null;constructor(){ct.addEventListener("pointerdown",e=>{e.pointerType==="mouse"&&e.button!==0||(this.tapStartTime=new Date().getTime())}),ct.addEventListener("pointerup",e=>{if(e.pointerType==="mouse"&&e.button!==0||!this.reader)return;const t=this.tapStartTime;if(t===null||new Date().getTime()-t>fn*1e3)return;const r=ct.getBoundingClientRect(),n=(r.left+r.right)/2;e.clientX<n?this.reader.pageUp():this.reader.pageDown()})}}const ri=new ni;class ii{reader=null;preNavScrollPos=null;postNavScrollPos=null;constructor(){ct.addEventListener("scroll",()=>{this.preNavScrollPos=ct.scrollTop}),window.addEventListener("popstate",()=>{this.postNavScrollPos!==null&&(ct.scrollTo({top:this.postNavScrollPos,behavior:"instant"}),this.postNavScrollPos=null),this.preNavScrollPos!==null&&(this.postNavScrollPos=this.preNavScrollPos)})}}const si=new ii;class oi{reader=null;constructor(){document.addEventListener("needscrolltocurrent",()=>{this.reader&&this.reader.scrollToCurrent(!1)})}}const ai=new oi;let se=null,oe=null,fe=!0;function ci(f){li(f),ui(f),Jr.reader=f,ei.reader=f,ri.reader=f,si.reader=f,ai.reader=f}function li(f){se&&ct.removeEventListener("scroll",se);const e=he(()=>{if(fe){if(f.sents.highlightOnScreen()){f.sents.setCurrentToHighlight(),f.updatePosition();return}f.sents.current()?.onScreen()||(f.sents.setCurrentToFirstOnScreen(),f.updatePosition())}},ln);ct.addEventListener("scroll",e),se=e}function ui(f){oe&&window.removeEventListener("resize",oe);const e=Kt(()=>{f.scrollToCurrent(!1),fe=!0},cn);window.addEventListener("resize",()=>{fe=!1,e()}),oe=e}class We{#t;playing=!1;sents=new Qr;#e=document.querySelector("#play-pause");#r=document.querySelector("#previous-button");#n=document.querySelector("#next-button");#s;#i=document.querySelector("#position-percentage-number");constructor(e){this.#t=e,this.#e.onclick=this.#o.bind(this),this.#r.onclick=()=>this.#a(()=>this.sents.backward()),this.#n.onclick=()=>this.#a(()=>this.sents.forward()),this.#s=this.#u.bind(this),ci(this);const t=this.#t.card;this.sents.jumpToPosition(t.positionPercentage),this.scrollToCurrent(!1),this.sents.currentPosPercents()===0&&this.#c(),this.updatePosition()}#o(){if(this.playing)this.pause();else{const e=this.sents.current();if(!e)return;this.sents.highlightOnScreen()?this.sents.setCurrentToHighlight():e.onScreen()||this.sents.setCurrentToFirstOnScreen(),this.play()}}pause(){this.playing=!1,mt.stop(),this.#e.classList.remove("pause")}play(e=!0){if(this.updatePosition(),!!this.sents.current()){this.playing=!0,this.#e.classList.add("pause"),this.sents.highlightCurrent(),e&&this.scrollToCurrent(!0);try{mt.start(this.sents.current()?.text.trim()||"",this.#s)}catch(s){console.error(s)}}}updatePosition(){const e=this.sents.currentPosPercents();bt?.updatePosition(this.#t.card.fileHash,e);const t=Math.round(e);this.#i.innerText=t.toString()}pageUp(){ct.scrollBy({top:-ct.clientHeight,left:0,behavior:"smooth"})}pageDown(){const t=this.sents.firstPartAfterScreen()?.firstSymbolRangeAfterScreen();if(!t)return;const s=t?.getBoundingClientRect(),r=ct.getBoundingClientRect(),n=s.top-r.top+ct.scrollTop-_e;ct.scrollTo({top:n,behavior:"smooth"})}#a(e){const t=this.playing;t&&this.pause(),e(),t&&this.play(!1),this.scrollToCurrent(!0),this.updatePosition()}#c(){ct.scrollTo({top:0,behavior:"instant"})}scrollToCurrent(e){try{const t=this.sents.current();if(!t||t.withinScreen())return;const s=t.firstRectange();if(!s)return;const r=ct.getBoundingClientRect(),n=s.top-r.top+ct.scrollTop-_e,i=ct.scrollTop,o=Math.abs(n-i),u=ct.clientHeight;o>=1.5*u&&(e=!1);const b=e?"smooth":"instant";ct.scrollTo({top:n,behavior:b})}catch{console.warn("Exception in Reader.scrollToCurrent()")}}#u(){this.playing&&(this.pause(),this.sents.forward(),this.play())}}async function hi(){let f=await fi();if(f)return f;const e=zn();if(e!==null){console.log("Opening most recent book");const t=bt?.getCard(e);if(!t)return await gt.createWelcomeGuide();const s=await gt.loadFromDB(t);return s!==null?s:await gt.createWelcomeGuide()}else return await gt.createWelcomeGuide()}async function fi(){try{const f=VERandroid.getFileBase64();if(!f)return null;const e=VERandroid.getFilename()||UNKOWN_FILE_NAME,t=atob(f),s=t.length,r=new Uint8Array(s);for(let o=0;o<s;o++)r[o]=t.charCodeAt(o);const n=new Blob([r],{type:"application/octet-stream"}),i=new File([n],e,{type:n.type,lastModified:new Date().getTime()});return gt.create(i)}catch{console.error("Couldn't open book file from Android")}return null}class me{book;reader=null;openDialog=new Ue;optionsDialog=new Hr;lastErrorMessage=null;constructor(e){this.book=e,e&&(this.reader=new We(e),ot.currentBook=e)}static async create(){const e=await hi();return e||console.error("Failed to get initial book"),new me(e).#t()}async#t(){for(;;)try{await this.appLoopNoTry()}catch(e){const t=e?.message;if(t===this.lastErrorMessage)throw alert("App has crashed"),console.error("! App has crashed !"),e;console.error(e),alert(`Uncaught error: ${e}`),this.lastErrorMessage=t}}async appLoopNoTry(){for(;;){if(this.book=await this.openDialog.getNewBook(),this.openDialog.hide(),this.openDialog=new Ue,this.book===null){alert("Error opening book");continue}ot.currentBook=this.book,this.reader=new We(this.book)}}}function di(){Array.prototype.at||(Array.prototype.at=function(f){const e=this.length,t=f>=0?f:e+f;if(!(t<0||t>=e))return this[t]})}const xt={};xt.ru={"speaking-speed":"Скорость речи",language:"Язык",voice:"Голос","line-height":"Высота строк",font:"Шрифт",margin:"Поля","recent-books":"Недавние книги","open-book-file":"Открыть файл книги с вашего устройства",format:"(формат EPUB)","format-fb2":"(формат FB2)","table-of-contents":"Оглавление","skip-to-controls":"Перейти к кнопкам управления"};xt.de={"speaking-speed":"Sprechgeschwindigkeit",language:"Sprache",voice:"Stimme","line-height":"Zeilenhöhe",font:"Schriftart",margin:"Seitenränder","recent-books":"Zuletzt gelesen","open-book-file":"Buchdatei von Ihrem Gerät öffnen",format:"(EPUB-Format)","table-of-contents":"Inhaltsverzeichnis","skip-to-controls":"Zu den Bedienelementen springen"};xt.es={"speaking-speed":"Velocidad del habla",language:"Idioma",voice:"Voz","line-height":"Altura de línea",font:"Fuente",margin:"Márgenes","recent-books":"Libros recientes","open-book-file":"Abrir archivo de libro desde su dispositivo",format:"(formato EPUB)","table-of-contents":"Tabla de contenido","skip-to-controls":"Saltar a los controles"};xt.fr={"speaking-speed":"Vitesse de la parole",language:"Langue",voice:"Voix","line-height":"Hauteur de ligne",font:"Police",margin:"Marges","recent-books":"Livres récents","open-book-file":"Ouvrir un fichier livre depuis votre appareil",format:"(format EPUB)","table-of-contents":"Table des matières","skip-to-controls":"Accéder aux commandes"};xt.ja={"speaking-speed":"話速",language:"言語",voice:"音声","line-height":"行の高さ",font:"フォント",margin:"余白","recent-books":"最近の書籍","open-book-file":"デバイスから書籍ファイルを開く",format:"(EPUB形式)","table-of-contents":"目次","skip-to-controls":"コントロールにスキップ"};xt.ko={"speaking-speed":"말하기 속도",language:"언어",voice:"음성","line-height":"줄 높이",font:"글꼴",margin:"여백","recent-books":"최근 읽은 책","open-book-file":"기기에서 책 파일 열기",format:"(EPUB 형식)","table-of-contents":"목차","skip-to-controls":"컨트롤로 건너뛰기"};xt.zh={"speaking-speed":"语速",language:"语言",voice:"声音","line-height":"行高",font:"字体",margin:"边距","recent-books":"最近阅读","open-book-file":"从您的设备打开图书文件",format:"(EPUB 格式)","table-of-contents":"目录","skip-to-controls":"跳到控件"};async function pi(f){const e=xt[f];e&&(document.documentElement.setAttribute("lang",f),document.querySelectorAll("[data-i18n]").forEach(t=>{const s=t.getAttribute("data-i18n"),r=e[s];r!==void 0&&(t.innerText=r)}))}async function mi(){try{di(),gi(),pi(Ot()),window.addEventListener("beforeunload",mt.stop),await Tn(),await Cn(),await me.create()}catch(f){alert(f)}}function gi(){function f(){let e=window.innerHeight*.01,t=Math.min(window.innerHeight,window.innerWidth)*.01;document.documentElement.style.setProperty("--vh",`${e}px`),document.documentElement.style.setProperty("--vmin",`${t}px`)}f(),window.addEventListener("resize",f),window.addEventListener("orientationchange",f)}mi();
